model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.244366, 1);
tau[2,2] ~ dlnorm(-0.179621, 1);
tau[3,2] ~ dlnorm(-0.084192, 1);
tau[4,2] ~ dlnorm(-0.083781, 1);
tau[5,2] ~ dlnorm(-0.160426, 1);
tau[6,2] ~ dlnorm(-0.155391, 1);
tau[7,2] ~ dlnorm(-0.37681, 1);
tau[8,2] ~ dlnorm(-0.413696, 1);
tau[9,2] ~ dlnorm(-0.172052, 1);
tau[10,2] ~ dlnorm(-0.148755, 1);
tau[11,2] ~ dlnorm(-0.402561, 1);
tau[12,2] ~ dlnorm(-0.403196, 1);
tau[13,2] ~ dlnorm(-0.514825, 1);
tau[14,2] ~ dlnorm(-0.485277, 1);
tau[15,2] ~ dlnorm(-0.499965, 1);
tau[16,2] ~ dlnorm(-0.512736, 1);
tau[17,2] ~ dlnorm(-0.683369, 1);
tau[18,2] ~ dlnorm(-0.648315, 1);
tau[19,2] ~ dlnorm(-0.387485, 1);
tau[20,2] ~ dlnorm(-0.261321, 1);
tau[21,2] ~ dlnorm(-0.220461, 1);
tau[22,2] ~ dlnorm(-0.346415, 1);
tau[23,2] ~ dlnorm(-0.224416, 1);
tau[24,2] ~ dlnorm(-0.227312, 1);
tau[25,2] ~ dlnorm(-0.223295, 1);
tau[26,2] ~ dlnorm(-0.226882, 1);
tau[27,2] ~ dlnorm(-0.255541, 1);
tau[28,2] ~ dlnorm(-0.111702, 1);
tau[29,2] ~ dlnorm(-0.223821, 1);
tau[30,2] ~ dlnorm(-0.259147, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.0585287564048615, 
                    1.2508918753053961, 
                    1.558118281163823, 
                    1.5595054796553065, 
                    1.3103547787142433, 
                    1.3261423574027362, 
                    0.7017811421712716, 
                    0.610552704211783, 
                    1.2742022893181055, 
                    1.3470716315201434, 
                    0.6377384389168566, 
                    0.6361802392724492, 
                    0.3770252822557013, 
                    0.4428336188991093, 
                    0.40987779509074374, 
                    0.3816152462479724, 
                    0.036661121442504385, 
                    -0.10280531609325472, 
                    -0.6750313970906199, 
                    -1.0101813729456994, 
                    -1.128107979607326, 
                    -0.7795263680027924, 
                    -1.116479705886074, 
                    -1.10799640320072, 
                    -1.1197718391157991, 
                    -1.1092555146931111, 
                    -1.0265720547479464, 
                    -1.4665238720139409, 
                    -1.1182271045938879, 
                    -1.016332907165093 ),
tau=matrix(c( NA,1.2912794116257829, 
                    NA,1.3776504520121229, 
                    NA,1.5155951082425565, 
                    NA,1.5162179603652328, 
                    NA,1.4043492956426953, 
                    NA,1.4114379184738286, 
                    NA,1.131099732834901, 
                    NA,1.0901381641910906, 
                    NA,1.3881168279038296, 
                    NA,1.4208351625525446, 
                    NA,1.1023445590736687, 
                    NA,1.1016449274333298, 
                    NA,0.98528435173281, 
                    NA,1.0148322948857, 
                    NA,1.000035129995744, 
                    NA,0.9873452455653398, 
                    NA,0.8324608435276846, 
                    NA,0.8621595869258714, 
                    NA,1.1190890972936884, 
                    NA,1.2695714364526192, 
                    NA,1.3225204828436894, 
                    NA,1.166007339233254, 
                    NA,1.3172993879428474, 
                    NA,1.3134903850371233, 
                    NA,1.318777555762994, 
                    NA,1.314055726097207, 
                    NA,1.276930852581828, 
                    NA,1.4744692185342596, 
                    NA,1.3180839699626556, 
                    NA,1.272333475317127 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 -0.1751662405581239, 
                    0.016891273966649523, 
                    0.01490371884772268, 
                    -0.09413589563004388, 
                    0.10150485649959218, 
                    0.17222609220538854, 
                    -0.14721343910704227, 
                    0.18160134727363003, 
                    -0.10641429936222888, 
                    -0.041500444185323754, 
                    -0.09710892709602834, 
                    0.004063928751069146, 
                    0.33396364942507983, 
                    -0.01942912841867847, 
                    0.1586477530620966, 
                    0.015486154341846081, 
                    0.022855844733766617, 
                    -0.01015219931283573, 
                    -0.14454825570822954, 
                    0.33201962861974255, 
                    0.28722362344436847, 
                    -0.099408275742733, 
                    0.12180951720568561, 
                    0.3005387537292781, 
                    -0.096127494540865, 
                    0.1610335373104359, 
                    0.12744043258581894, 
                    0.2770636372008569, 
                    -0.10703221081972811, 
                    9.874675883486672e-4, 
                    -0.05084195557700896, 
                    -0.05008536590568008, 
                    -0.11207786778890591, 
                    -0.06172869575740014, 
                    0.03722127359785632, 
                    -0.16545505596654997, 
                    0.17095964548685394, 
                    0.03646686523436116, 
                    -0.14467892139638666, 
                    0.27669221793003584, 
                    -0.025128295290717778, 
                    -0.21151946438961225, 
                    -0.12363458777027023, 
                    -0.11929855374511511, 
                    -0.01462815144675128, 
                    -0.20858336642646413, 
                    -0.18212333640226622, 
                    -0.15923107733391093, 
                    0.002634621144597671, 
                    -0.03653709152021983, 
                    0.2968337315066688, 
                    -0.09736091295615876, 
                    -0.2246482611493632, 
                    -0.17739188820261212, 
                    0.19099461463771966, 
                    -0.1557145661236059, 
                    -0.009478948795013292, 
                    0.09511544339864836, 
                    -0.14079039585379416, 
                    0.3116893081226415, 
                    0.051306429047278, 
                    -0.13850054962199476, 
                    0.1010322267043216, 
                    0.1198329963626984, 
                    0.30845245440452507, 
                    0.34014117724883586, 
                    -0.19326849583300587, 
                    0.23768914018007264, 
                    -0.22723550893288808, 
                    0.10542078021722734, 
                    0.013697818969912678, 
                    -0.17721443542283985, 
                    -0.21137299928915051, 
                    -0.13408213696033755, 
                    0.092086537639517907, 
                    0.3501268154510139, 
                    -0.02287037754768259, 
                    -0.1957006780295509, 
                    -0.2246482611493632, 
                    -0.11962395384899202, 
                    -0.1284714634721187, 
                    -0.18329290126318198, 
                    -0.2272000953046061, 
                    0.13857801892992627, 
                    0.05224565183188401, 
                    0.02392564343255893, 
                    0.11030136057179163, 
                    0.29318697856321174, 
                    -0.10636539259141747, 
                    -0.22860363195476743, 
                    -0.15861067612711466, 
                    -0.2086565543388596, 
                    -0.15172374562105745, 
                    0.049035704117335044, 
                    -0.23009299714673057, 
                    -0.19577601944773296, 
                    -0.15194940128658185, 
                    -0.019231260171403225, 
                    -0.11761112702351079, 
                    -0.1617077536116458, 
                    -0.25075565038633973, 
                    0.041269117233806885, 
                    0.07521060984987898, 
                    -0.01185537836115938, 
                    -0.06837096177011767, 
                    0.31323592658159505, 
                    -0.11607951554420459, 
                    -0.1676167802031956, 
                    0.14283488411202427, 
                    -0.150773012606885, 
                    0.13749838220504418, 
                    0.29976565670238553, 
                    -0.06540377748024209, 
                    0.29002513947285125, 
                    -0.2293568130882669, 
                    -0.028525350985134368, 
                    -0.18661309417383554, 
                    -0.2034082204321469, 
                    -0.1742668457641464, 
                    0.12691600977232165, 
                    -0.22574457932155123, 
                    -0.14701886373396783, 
                    -0.18725599820195754, 
                    -0.0972549475248575, 
                    -0.09761183743742172, 
                    -0.15754100557526074, 
                    -0.14414732483890413, 
                    0.29216666922424495, 
                    0.3038244819097694, 
                    -0.2246482611493632, 
                    0.14454774554801025, 
                    -0.09971700718341342, 
                    0.2702186700513761, 
                    0.1948228789486109, 
                    0.09654327638404447, 
                    0.18143092293770796, 
                    0.11615619802822669, 
                    0.0762664390985876, 
                    0.11275972423672082, 
                    0.23736988066777404, 
                    0.25994581485940504, 
                    0.27061956949586863, 
                    0.1641839631173021, 
                    -0.0386434968818708, 
                    -0.17040308482536115, 
                    0.19205700250160462, 
                    -0.021518774364864574, 
                    -0.002980671516380179, 
                    0.3454547420064925, 
                    -0.1551037525654511, 
                    -0.1338375630146646, 
                    -0.2041052811016572, 
                    -0.0542593727880708, 
                    0.13796986854064036, 
                    0.29288887106006223, 
                    -0.1185009783921187, 
                    0.1333046970090423, 
                    -0.06536042197903627, 
                    -0.19021894021561828, 
                    0.2840556978943213, 
                    0.0300725769389647, 
                    0.049344896883128486, 
                    -0.17880443231516396, 
                    0.16146746499675074, 
                    0.2608665077059342, 
                    0.0023770473087286748, 
                    -0.21161963766794462, 
                    0.14198099563446415, 
                    -0.23462566737970147, 
                    -0.18052441140102693, 
                    -0.15625376577495892, 
                    -0.14467275038891017, 
                    0.3687481580416937, 
                    -0.16475356185847567, 
                    -0.11684175945175326, 
                    -0.11804577698379243, 
                    0.24817441146371255, 
                    0.14205346157982213, 
                    0.028716815567888576, 
                    -0.08016807896004235, 
                    -0.1354743747675387, 
                    0.3218867156451325, 
                    0.12417112054870233, 
                    -0.0794753081523838, 
                    -0.15346538535324566, 
                    0.06805317703754893, 
                    -0.18809215604655077, 
                    -0.1599036451667346, 
                    0.18198741394432782, 
                    0.23201251000865863, 
                    -0.12474997641923491, 
                    -0.20832864760227082, 
                    -0.060380216643339896, 
                    0.0536926768081919, 
                    -0.12988208503840426, 
                    0.031615001529623155, 
                    0.28666785197648603, 
                    -0.21554820641406067, 
                    -0.18090689954880138, 
                    0.2776829972670064, 
                    0.051785766941860156, 
                    0.1661489147060074, 
                    0.026731125214218387, 
                    -0.2307252235352206, 
                    -0.15277350936199752, 
                    0.13989449149109673, 
                    0.30354954800527034, 
                    0.01954678389768172, 
                    -0.2295978100398142, 
                    0.16713310903911044, 
                    0.3357521326525281, 
                    0.2355082522932585, 
                    -0.02088222957092764, 
                    0.2526105364633522, 
                    -0.16565366001835807, 
                    0.23498833740859243, 
                    0.08393939617463703, 
                    0.05956077951191607, 
                    0.022965349452533035, 
                    0.042656817532378266, 
                    0.01560927506218901, 
                    0.04103694186824991, 
                    -0.22403040354242976, 
                    -0.22984733934208654, 
                    0.08789993966758508, 
                    0.033675779161938924, 
                    -0.1265932643483626, 
                    -0.09843741518805077, 
                    0.3260663826066954, 
                    0.06701808079646931, 
                    0.18399638115509837, 
                    -0.15739555950803907, 
                    0.31234642440624827, 
                    -0.13925604286240018, 
                    -0.20413237351079286, 
                    -0.0947572867892463, 
                    0.29109703430641565, 
                    -0.09354692735999018, 
                    0.05292794499524389, 
                    -0.050396353203248506, 
                    0.09190307841342327, 
                    -0.13225288025538015, 
                    -0.13349680049627483, 
                    0.09673436488963616, 
                    0.21963351096412131, 
                    0.17249910963538506, 
                    -0.10535267311384156, 
                    -0.15158353121767584, 
                    0.2671461722599622, 
                    0.15705425502781545, 
                    -0.04032694376903426, 
                    -0.02656663635878745, 
                    -0.21102282665322816, 
                    0.2090863240013594, 
                    -0.10400812469496482, 
                    -0.14837823541942163, 
                    -0.06663868228558611, 
                    -0.19071444681108618, 
                    -0.1853917048611901, 
                    -0.1753871261226577, 
                    0.06446472618230176, 
                    -0.07007631073899928, 
                    0.13236755693130975, 
                    -0.04111560023147734, 
                    0.2700676170514569, 
                    -0.03402913896307255, 
                    0.3426540367126514, 
                    -0.2089494530632398, 
                    -0.147705457199296, 
                    0.27013202409296255, 
                    0.18276377793711268, 
                    -0.18395436529667017, 
                    -0.13029127562720394, 
                    0.026299997944196796, 
                    -0.1132595134618567, 
                    0.09847471553455633, 
                    -0.14539437940584587, 
                    0.05538739478147364, 
                    -0.02310037632720871, 
                    0.017087055549638408, 
                    0.09174606150173559, 
                    -0.19073829401268366, 
                    -0.03292261291129492, 
                    0.11179631840646381, 
                    0.11826733455899491, 
                    -0.14467383207053605, 
                    0.33291546163439956, 
                    0.12290644075939683, 
                    -0.25075565038633973, 
                    -0.16163077461083686, 
                    0.026388273505702664, 
                    0.19438994730446751, 
                    -0.2123571543921646, 
                    -0.14667055719747696, 
                    -0.2284600585428331, 
                    -0.17518713680151793, 
                    0.034449326561355575, 
                    -0.18496636804521427, 
                    -0.0490120472783086, 
                    0.18807397221183508, 
                    0.16789229175045817, 
                    0.023798717422126303, 
                    0.24527277371761103, 
                    -0.032462032935500845, 
                    0.26045550954063035, 
                    -0.02570204316524491, 
                    -0.1468320865236242, 
                    0.19471599646115606, 
                    0.14071439718520135, 
                    -0.03480527617482401, 
                    -0.1938355978685458, 
                    0.22502416544959064, 
                    -0.06696210402271055, 
                    -0.23713121988640243, 
                    0.11021292357775087, 
                    0.02339569615818632, 
                    -0.167299053734217, 
                    -0.20382406932270092, 
                    -0.2106736105246934, 
                    0.15782771171416593, 
                    -0.10572800191032072, 
                    0.21927029151617822, 
                    0.04818452008433538, 
                    0.09425264955232171, 
                    -0.015818385999747664, 
                    -0.09936549130904815, 
                    0.18426444517745066, 
                    -0.16509884910600967, 
                    -0.20550579890884005, 
                    -0.1874325669432096, 
                    -0.009133784999555666, 
                    -0.04469612106353682, 
                    -0.24086094342902314, 
                    -0.15294019974590733, 
                    0.210175266600526, 
                    -0.17805645822019553, 
                    0.22749997478210188, 
                    -0.18235009089170923, 
                    -0.07267385531228615, 
                    -0.05438580649863614, 
                    -0.12276557070132851, 
                    -0.05492098569549064, 
                    -0.1868159193694092, 
                    0.20510842371452825, 
                    -0.16639822049888647, 
                    0.30441993639076026, 
                    -0.018079017914200635, 
                    0.172704890964907, 
                    0.07191523372068614, 
                    0.11818212917881182, 
                    -0.25075565038633973, 
                    -0.04010293866418793, 
                    0.06138504629174357, 
                    -0.1479329956895329, 
                    0.02052807898107456, 
                    -0.16225472950938746, 
                    -0.14059247608731779, 
                    0.2241729217037436, 
                    -0.1202164710621273, 
                    -0.12149197667269426, 
                    0.1636544101259324, 
                    -0.028917776139499057, 
                    -0.0698466955251906, 
                    0.1604209083576631, 
                    -0.2272000953046061, 
                    0.2089766985380408, 
                    0.12455227090720161, 
                    -0.12390600621334164, 
                    0.19184616284613637, 
                    0.1916541441393826, 
                    -0.07928447028415919, 
                    -0.08969172342685192, 
                    -0.15473105999596076, 
                    0.09491116704520497, 
                    -0.08567568928231645, 
                    -0.0010666177979618552, 
                    0.29697413933368566, 
                    0.0899230865786787, 
                    0.12004670149134361, 
                    -0.131558219490177, 
                    0.059548628901950285, 
                    -0.1536165517951822, 
                    -0.013185174022936924, 
                    -0.12748766890969804, 
                    -0.062027854872074684, 
                    -0.13256218025109928, 
                    -0.1958931656196098, 
                    0.3604184618932016, 
                    -0.042467119213122045, 
                    0.1226289437759207, 
                    -0.19342038841179937, 
                    -0.14973590837014925, 
                    0.25412504873374775, 
                    -0.2272000953046061, 
                    -0.03320351204987618, 
                    -0.206936414922827, 
                    0.02922814744836616, 
                    0.31511991860412025, 
                    -0.09904357325160218, 
                    -0.1539218931894837, 
                    -0.19139024853817438, 
                    -0.19781846504110362, 
                    0.17458462433862088, 
                    -0.0513067651070887, 
                    -0.22137113936899047, 
                    -0.0263415754448125, 
                    -0.16225541942197136, 
                    0.04619646419894047, 
                    -0.22574457932155123, 
                    0.09729878538646225, 
                    -0.008788382866913497, 
                    -0.2265421617429458, 
                    -0.21040496904629472, 
                    -0.05644583884330276, 
                    -0.11475288285808061, 
                    0.2431966497456629, 
                    0.2533523533216143, 
                    -0.10919369196879897, 
                    -0.028161326392004915, 
                    0.28911380782856155, 
                    0.16987707724778184, 
                    0.18808412963946958, 
                    -0.14768085745682907, 
                    -0.13092097161112892, 
                    0.01688092031700983, 
                    -0.12291157370276817, 
                    0.058609012577730046, 
                    -0.1379697506486977, 
                    0.16432833164492228, 
                    -0.22781795291153956, 
                    -0.18532019988450407, 
                    -0.21102282665322816, 
                    0.2365827269302057, 
                    0.049829656458163896, 
                    0.0013029088676462242, 
                    0.07073734812965149, 
                    -0.09385173691754359, 
                    -0.2085203835004833, 
                    0.07938953392176773, 
                    0.09896763692650457, 
                    -0.17480870623531575, 
                    -0.15976096606251827, 
                    0.021086291811990787, 
                    -0.060987709177745764, 
                    0.30353400831266664, 
                    0.09716191230248039, 
                    -0.23009299714673057, 
                    -0.006830293324714298, 
                    -0.048435915215205155, 
                    -0.07437135432120406, 
                    -0.14645604932370304, 
                    -0.1480127817474633, 
                    -0.18804138445539148, 
                    0.31121126633833773, 
                    -0.005318459252208224, 
                    0.08319587174432458, 
                    -0.09237327355109598, 
                    -6.274469755489509e-4, 
                    -0.15550930196537383, 
                    -0.23462566737970147, 
                    0.28718659269999725, 
                    -0.098588142048834565, 
                    0.04553943204007599, 
                    -0.21554820641406067, 
                    0.3169634708128396, 
                    0.08619671490905745, 
                    -0.17342079810772673, 
                    -0.10687261933775882, 
                    -0.23208303436734576, 
                    0.0011320182789740785, 
                    -0.14895191868404895, 
                    -0.11534241906242282, 
                    -0.16734260539880097, 
                    0.25448364715786675, 
                    0.08926120886877464, 
                    -0.16776331652083426, 
                    0.3053268490345884, 
                    0.26375385000308027, 
                    0.01512310445046805, 
                    -0.061867211996484206, 
                    -0.007642760818655309, 
                    -0.06008600543816861, 
                    0.18568868545007494, 
                    -0.09986155762012561, 
                    0.11188307823236604, 
                    0.21002285641482904, 
                    -0.0031598292039083375, 
                    0.06792068919693994, 
                    -0.19497491711881346, 
                    -0.06244494858817917, 
                    0.03135074861509052, 
                    0.21831908772727743, 
                    0.06913803125768025, 
                    -0.07284387683262833, 
                    0.04144583651759998, 
                    0.09310805173383258, 
                    0.22736248105683393, 
                    0.18443251291040408, 
                    -0.1315770871105959, 
                    0.30010052904010687 
)
)

