model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.342301, 1);
tau[2,2] ~ dlnorm(-0.158036, 1);
tau[3,2] ~ dlnorm(-0.268728, 1);
tau[4,2] ~ dlnorm(-0.290706, 1);
tau[5,2] ~ dlnorm(-0.176278, 1);
tau[6,2] ~ dlnorm(-0.275358, 1);
tau[7,2] ~ dlnorm(-0.192221, 1);
tau[8,2] ~ dlnorm(-0.166733, 1);
tau[9,2] ~ dlnorm(-0.172528, 1);
tau[10,2] ~ dlnorm(-0.306892, 1);
tau[11,2] ~ dlnorm(-0.164152, 1);
tau[12,2] ~ dlnorm(-0.178756, 1);
tau[13,2] ~ dlnorm(-0.506386, 1);
tau[14,2] ~ dlnorm(-0.495058, 1);
tau[15,2] ~ dlnorm(-0.524156, 1);
tau[16,2] ~ dlnorm(-0.548291, 1);
tau[17,2] ~ dlnorm(-0.667216, 1);
tau[18,2] ~ dlnorm(-0.487188, 1);
tau[19,2] ~ dlnorm(-0.22477, 1);
tau[20,2] ~ dlnorm(-0.367232, 1);
tau[21,2] ~ dlnorm(-0.396354, 1);
tau[22,2] ~ dlnorm(-0.366104, 1);
tau[23,2] ~ dlnorm(-0.240168, 1);
tau[24,2] ~ dlnorm(-0.285307, 1);
tau[25,2] ~ dlnorm(-0.148082, 1);
tau[26,2] ~ dlnorm(-0.162918, 1);
tau[27,2] ~ dlnorm(-0.203964, 1);
tau[28,2] ~ dlnorm(-0.250736, 1);
tau[29,2] ~ dlnorm(-0.230051, 1);
tau[30,2] ~ dlnorm(-0.081305, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -0.7902298309809144, 
                    -1.3178402452503937, 
                    -0.989314885353216, 
                    -0.9283003875137159, 
                    -1.2611638338958662, 
                    -0.9707683978926996, 
                    -1.21247147232664, 
                    -1.290688652697285, 
                    -1.2727313078414664, 
                    -0.8842178264473657, 
                    -1.298723796641138, 
                    -1.2535467942728222, 
                    -0.39562122402571104, 
                    0.420833435416595, 
                    -0.35664509228360214, 
                    -0.30480238894518263, 
                    0.06685276432759668, 
                    -0.4385175004620194, 
                    1.1154431843532446, 
                    0.7260242874247246, 
                    0.6530240113475435, 
                    0.7288963715865812, 
                    1.0706292124299517, 
                    0.9431648411389196, 
                    1.3492029051690624, 
                    1.302570225586948, 
                    1.1771000995754597, 
                    1.0402698930671388, 
                    1.0999935868148927, 
                    1.5678778121491797 ),
tau=matrix(c( NA,1.1708131941104307, 
                    NA,1.4077102701174269, 
                    NA,1.260202383523594, 
                    NA,1.2328068739936584, 
                    NA,1.3822625614192439, 
                    NA,1.2518750106538223, 
                    NA,1.3603996910746616, 
                    NA,1.395519205061081, 
                    NA,1.3874563572208185, 
                    NA,1.2130138040748673, 
                    NA,1.399126984691871, 
                    NA,1.3788425106284974, 
                    NA,0.9936339295875443, 
                    NA,1.0049542125020512, 
                    NA,0.9761336464353374, 
                    NA,0.952856272636387, 
                    NA,0.846016891183091, 
                    NA,1.0128943577074467, 
                    NA,1.3168339897746069, 
                    NA,1.1419849050537014, 
                    NA,1.1092077810950471, 
                    NA,1.143274470842375, 
                    NA,1.2967125163810485, 
                    NA,1.239481013671375, 
                    NA,1.4217921044209092, 
                    NA,1.4008540312885396, 
                    NA,1.3445179447093816, 
                    NA,1.2830811819871455, 
                    NA,1.3098971204798868, 
                    NA,1.5199771376549818 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 -0.12121787722505137, 
                    0.23097840664715186, 
                    -0.09633679781341892, 
                    -0.09769916160923192, 
                    -0.16362421922878184, 
                    -0.11094840218115279, 
                    -0.12036239166837856, 
                    -0.09358088584379837, 
                    -0.15583192442073768, 
                    -0.13266842887777436, 
                    0.19119370578941774, 
                    -0.07587484076901974, 
                    0.13741843765152628, 
                    -0.06794503622887071, 
                    0.035698248552316236, 
                    -0.17699287207463815, 
                    0.12944980829524377, 
                    -0.3067794761705969, 
                    -0.006591921454211169, 
                    0.22918427593003143, 
                    -0.28247075396329635, 
                    0.03386125954847252, 
                    0.2542392379698377, 
                    0.025978058130729176, 
                    -0.08021026730900721, 
                    0.18987123824678664, 
                    0.23197848235377672, 
                    0.12095096465577343, 
                    -0.24974891157116624, 
                    0.24460259839252319, 
                    -0.2504675454584587, 
                    -0.27559246990254693, 
                    -0.08667596939771721, 
                    -0.10674772459028978, 
                    -0.18930605541665899, 
                    0.007432740409010707, 
                    0.20944879439671782, 
                    -0.1987699660911157, 
                    0.18310024794251611, 
                    0.11067648251431289, 
                    0.005292458497960839, 
                    0.14873551770150722, 
                    -0.0453110733086477, 
                    0.21486704432371184, 
                    -0.20917899116371233, 
                    0.2169360601435274, 
                    0.07839984356800395, 
                    0.0592193243163357, 
                    0.25360831657204874, 
                    0.2243149303664168, 
                    0.14263091693928887, 
                    0.11785030713778893, 
                    -0.2638232557198664, 
                    0.0685107175012803, 
                    0.08723988547377487, 
                    -0.16175134738236208, 
                    0.1926576275920484, 
                    0.16856860880771163, 
                    -0.12888078552177698, 
                    -0.04886578899142563, 
                    0.172905188576302, 
                    -0.05180822825709552, 
                    -0.14350041906360955, 
                    0.20208990066849897, 
                    -0.25484081861913377, 
                    -0.019270275456942654, 
                    -0.07392089341856228, 
                    0.021481322565535033, 
                    -0.09859523673815812, 
                    -0.070215130934694725, 
                    -0.09260328973500198, 
                    0.20449960335518969, 
                    0.1813557596681501, 
                    0.04925842093482263, 
                    0.06494351302799445, 
                    -0.33941558681720496, 
                    -0.30509076261944046, 
                    0.06845741757778401, 
                    0.21218700425998083, 
                    -0.046745220465267134, 
                    -0.3062070770630265, 
                    0.17941017339605503, 
                    -0.26304579352077295, 
                    -0.28346015142500464, 
                    0.20148455602827653, 
                    -0.23259874041209105, 
                    -0.06789348481198615, 
                    -0.18421819015381105, 
                    0.18022069812401553, 
                    -0.04076949901753024, 
                    0.09230261361768488, 
                    0.13647885121307274, 
                    -0.09341842571431386, 
                    0.21717330313607575, 
                    -0.24786503619579742, 
                    0.15721064238378324, 
                    0.06263424915672983, 
                    0.21216736083439525, 
                    0.13101556929718322, 
                    0.2107961544119923, 
                    -0.2186900901720415, 
                    0.21601202730364544, 
                    -0.006071424451269847, 
                    0.2270168460617814, 
                    -0.1257753267277688, 
                    -0.028170549800406175, 
                    -0.3422166101401981, 
                    -0.12431686703473763, 
                    -0.028233791044364354, 
                    -0.031713527908200756, 
                    0.24825288837617987, 
                    0.11910560130063802, 
                    0.197268786602117, 
                    0.17927543077317254, 
                    0.1424545735385852, 
                    -0.05023353801769914, 
                    0.21285417202110024, 
                    -0.014889681987454773, 
                    -0.26163638008589385, 
                    -0.2016574302474473, 
                    0.13096191968303494, 
                    -0.03138345543157556, 
                    0.13031721741989555, 
                    0.08303014454157026, 
                    0.07490949783818879, 
                    0.24315524291061408, 
                    0.03324760657638515, 
                    0.2008641868404477, 
                    -0.19832229101042237, 
                    0.10696052845674925, 
                    -0.05711600138699713, 
                    -0.20219411381700325, 
                    0.1934524073777586, 
                    -0.11116835648921725, 
                    0.13691617032373476, 
                    -0.12482454622585354, 
                    0.1735250155439435, 
                    -0.12226964829820292, 
                    0.2012707551967201, 
                    -0.21398140031109497, 
                    0.2542392379698377, 
                    -0.27277847146741474, 
                    -0.11692955785216019, 
                    -0.07778447990736126, 
                    -0.06575917799668862, 
                    0.08584857781620203, 
                    -0.018149198387742593, 
                    -0.13384885557209528, 
                    -0.29734605584188056, 
                    0.22350002111086498, 
                    -0.13494183841997887, 
                    -0.21581044400952043, 
                    -0.0757340577763656, 
                    -0.20216754705176082, 
                    0.22987675414118947, 
                    -0.19452416551316665, 
                    0.08324141262924095, 
                    -0.05775991722412699, 
                    0.2503649543082851, 
                    0.22497650695625193, 
                    0.23224085344946754, 
                    -0.34435966425658515, 
                    -0.09508265020421153, 
                    -0.15558169258028487, 
                    0.16397351108387492, 
                    0.06351357180904571, 
                    0.2204936065557288, 
                    -0.284540280523091, 
                    0.2626859459987644, 
                    -0.2048650636590899, 
                    0.08451528701683209, 
                    -0.16359251489931334, 
                    -0.17539306562378892, 
                    0.22745976965259873, 
                    -0.26835378730362147, 
                    -0.15596087265806685, 
                    0.14948594224135847, 
                    -7.684430922840213e-4, 
                    0.15256009295060668, 
                    -0.13101913114196795, 
                    -0.19068258118626247, 
                    -0.007480847033916271, 
                    -0.10184400603066318, 
                    -0.06803857478224967, 
                    0.26358322438574866, 
                    0.25900809740765207, 
                    0.2626859459987644, 
                    -0.07186901517527644, 
                    -0.35026472868575703, 
                    0.2037041015855462, 
                    0.14249003213649852, 
                    -0.11154955492868937, 
                    -0.1395336445501279, 
                    -0.0285049490199642, 
                    -0.017142775586090175, 
                    0.21503200663267963, 
                    0.1374228444327822, 
                    0.20757061085002593, 
                    -0.06913201236260785, 
                    0.12055342196722779, 
                    0.12356173575382767, 
                    -0.09709215612669708, 
                    -0.0018652020238473788, 
                    -0.03707454028271845, 
                    -0.11744081055956065, 
                    0.14957045179728679, 
                    -0.0635499024335166, 
                    -0.3382572628734355, 
                    0.2432067961053892, 
                    0.21448080438525297, 
                    0.21175807960811144, 
                    -0.09285587746614987, 
                    0.16897672682300913, 
                    -0.22899497374516825, 
                    -0.003332630984151319, 
                    -0.1438866638662615, 
                    0.20945017233209162, 
                    -0.24285108258331425, 
                    0.25114676234474087, 
                    0.16080201695017782, 
                    -0.04096283486664254, 
                    0.16781913574666474, 
                    -0.028930476510883485, 
                    0.18039747588989385, 
                    0.21432854305427296, 
                    0.07505230674755475, 
                    -0.09995549962639205, 
                    -0.07499088013774774, 
                    0.02465421353116226, 
                    -0.04483677452760826, 
                    -0.21873210288516953, 
                    0.18266279984475986, 
                    0.10055450877344313, 
                    0.1892319507601674, 
                    0.22745976965259873, 
                    -0.24294738659564735, 
                    0.17661689847139583, 
                    -0.194247648794066, 
                    -0.13460975647529796, 
                    -0.06549939190934673, 
                    -0.16507758036007436, 
                    0.21740598729709193, 
                    -0.02827132959825507, 
                    0.11141442007398639, 
                    0.04932658971494358, 
                    0.2129822477189569, 
                    -0.11151914542249922, 
                    0.19802203776273408, 
                    -0.1967956470014661, 
                    0.19902704193341025, 
                    0.11378115208837408, 
                    -0.24630443585350326, 
                    -0.13161773300746152, 
                    0.1708729095107845, 
                    0.07954293901050724, 
                    0.05701242660599859, 
                    -0.20706692434634436, 
                    -0.1061385143366701, 
                    0.25900809740765207, 
                    0.22498913270316223, 
                    0.1923376479126534, 
                    0.06148129240227301, 
                    -0.33592562944114285, 
                    -0.04984054447920355, 
                    -0.03550000584104074, 
                    0.148539052156681, 
                    -0.1567387672244984, 
                    0.028985813849964515, 
                    -0.051090627853318915, 
                    -0.026728312537020738, 
                    0.08439711906061498, 
                    -0.018601734508646106, 
                    0.025491516560727512, 
                    0.2672402060376289, 
                    0.11478666494894291, 
                    -0.2481169830963773, 
                    -0.04460484102156198, 
                    -0.01227868399258214, 
                    -0.09321545530627129, 
                    -0.21050210827009744, 
                    0.06032716286871698, 
                    -0.16777494491078487, 
                    0.21717330313607575, 
                    0.01541457443320915, 
                    -0.20304262692225725, 
                    0.12429107636190101, 
                    -0.28783704012312955, 
                    -0.27780201546304006, 
                    0.19853992197377335, 
                    0.08147717162022222, 
                    0.2336103951657137, 
                    0.24496517347268176, 
                    0.056969570391178614, 
                    0.23189985671736535, 
                    0.21866619460314418, 
                    0.008008171207378678, 
                    0.07659816441104855, 
                    0.1900172892124009, 
                    -0.07439368630052884, 
                    -0.01297602557656996, 
                    0.2672402060376289, 
                    -0.04748974414633805, 
                    0.23510568988127023, 
                    -0.18465270763972755, 
                    0.23115938551339432, 
                    0.1993395233387525, 
                    -0.14833631718721885, 
                    -0.1735499113267762, 
                    -0.031053518296866034, 
                    0.11879962212468625, 
                    -0.28199903730294545, 
                    -0.02581136644714499, 
                    0.10470659680986794, 
                    -0.2829098128640511, 
                    0.06465336914311065, 
                    0.19765517175754432, 
                    -0.17722827780463088, 
                    0.18466563012069992, 
                    0.18739550230037882, 
                    0.1548093849217329, 
                    0.05912820016152015, 
                    -0.2658286687686332, 
                    -0.0044898845676642485, 
                    -0.0036047253934209933, 
                    0.21285607137431994, 
                    0.017086680938068755, 
                    -0.23625396685695338, 
                    -0.1125750319791898, 
                    0.04596223364296481, 
                    -0.11756039121186795, 
                    0.18912944363834616, 
                    0.024856093469327156, 
                    0.18967637607639642, 
                    -0.2731627351440772, 
                    -0.17637028516498438, 
                    0.2336710550105986, 
                    -0.002372416197672922, 
                    -0.16966902827127764, 
                    0.11479324342981162, 
                    -0.011821126788631009, 
                    0.25007509411112117, 
                    0.06277802697485818, 
                    0.24134487822272133, 
                    -0.25250940253904386, 
                    0.1077116179326249, 
                    -0.005989328861850551, 
                    0.21902452846544795, 
                    0.010361186079936413, 
                    0.008349786773481582, 
                    0.15586206447390571, 
                    -0.007667458096143609, 
                    0.04342251841831518, 
                    5.907423687911417e-4, 
                    0.23527584946784308, 
                    0.05759951631376653, 
                    0.06951007185649205, 
                    -0.12125600026827321, 
                    -0.3506666217040566, 
                    0.019606961075043505, 
                    0.16603194378711017, 
                    -0.1591885101653513, 
                    -0.29996183105065005, 
                    -0.2675415278717187, 
                    0.046374198889911344, 
                    -0.022756589252941994, 
                    0.09559087832817365, 
                    -0.29217347435482094, 
                    4.7369805583746816e-4, 
                    -0.09401742313759198, 
                    -0.24577089222784143, 
                    0.1926031391413887, 
                    -0.19517657135162267, 
                    -0.16274051486251093, 
                    -0.15682318190165964, 
                    0.22745976965259873, 
                    -0.3001617814148095, 
                    -0.24369822346542586, 
                    0.15523558369456203, 
                    -0.1691249662870198, 
                    0.25007509411112117, 
                    -0.11482574195399808, 
                    -0.32744782959932484, 
                    0.1863052877581135, 
                    -0.27805023141922436, 
                    -0.05675346883071791, 
                    -0.025407557297928873, 
                    -0.07517472543851333, 
                    -0.025847667066277946, 
                    -0.17773116965338837, 
                    0.2006043891569127, 
                    0.20440374330007038, 
                    0.19571092418444647, 
                    0.0048590366697280896, 
                    0.12015116497708694, 
                    -0.18641682818876015, 
                    0.054793888588645256, 
                    -0.1892022127915663, 
                    0.17931111066571104, 
                    0.023323166488263603, 
                    0.22586478598759419, 
                    -0.2984619881969274, 
                    0.12166842420188367, 
                    -0.1773662264138061, 
                    -0.1754981640916391, 
                    -0.14744390324405882, 
                    -0.2624802302400214, 
                    0.24389917589686572, 
                    0.06291170074806068, 
                    -0.06616878707175688, 
                    0.15812972953507998, 
                    0.11181095915776534, 
                    0.24147918939164226, 
                    0.26358322438574866, 
                    -0.09077920511894794, 
                    0.2252249707689965, 
                    0.23910364685739405, 
                    -0.23339051843802888, 
                    0.045640321522056215, 
                    0.23197848235377672, 
                    -0.26585980621108246, 
                    0.02490288163399157, 
                    0.13198473225093776, 
                    -0.13310777407549002, 
                    0.14957456685883885, 
                    0.15525399579411725, 
                    -0.01853100773926819, 
                    0.08106775850061737, 
                    0.09594882079423839, 
                    0.0043446153705685164, 
                    0.01024812532792041, 
                    0.21406247472262852, 
                    -0.22060139954478974, 
                    -0.27910356071690084, 
                    -0.03706404799470159, 
                    0.12363662471644127, 
                    0.20141639190153993, 
                    -0.11675055788506694, 
                    -0.082569564134225, 
                    0.1996483732035934, 
                    0.17987203182688538, 
                    -0.21017668644362006, 
                    0.24389656770966706, 
                    -0.22154963541684952, 
                    0.2236332549733956, 
                    0.03914376788539897, 
                    -0.0011833767583850907, 
                    0.15575546922112637, 
                    0.065632056441460307, 
                    -0.03393404057496879, 
                    0.24389656770966706, 
                    -0.30076844701168204, 
                    0.04527826630160264, 
                    0.2395643836842536, 
                    -0.00480261211701799, 
                    0.04774246908847024, 
                    0.006555637943525761, 
                    0.17282304126056913, 
                    0.25114676234474087, 
                    -0.034074647332433206, 
                    -0.10857607394299737, 
                    -0.22630101743004274, 
                    -0.24802736100196532, 
                    -0.029599908502864314, 
                    0.24375952920899757, 
                    -0.22628377677364533, 
                    0.20033437418801525, 
                    0.019713230049807684, 
                    -0.24105619942074158, 
                    0.1251250639590078, 
                    0.06683283042448146, 
                    0.2542392379698377, 
                    -0.11437071286739325, 
                    0.1419423089851502, 
                    -0.24989795001898696, 
                    0.06992902061017936, 
                    -0.2983837053263325, 
                    -0.2213822052676268, 
                    0.10982358397261621, 
                    -0.10213765024057142, 
                    -0.05627202374366752, 
                    0.04118003717377283, 
                    -0.20818950094904184, 
                    0.12367362789924546, 
                    0.1241284692363035, 
                    -0.14697912020220794, 
                    -0.20359878321705843, 
                    0.045991334352706026, 
                    -0.3118625421105499, 
                    -0.05624858291252155, 
                    -0.00914625163861027, 
                    0.07279783107342458, 
                    0.15583059140695832, 
                    0.14876610310200716, 
                    -0.07573346016894145, 
                    -0.201861534854353, 
                    0.23585603895987373, 
                    0.14935760252323904, 
                    -0.2721332532954256, 
                    0.01513820933166915, 
                    0.24389917589686572 
)
)

