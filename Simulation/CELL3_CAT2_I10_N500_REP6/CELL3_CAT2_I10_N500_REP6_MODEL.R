model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.356796, 1);
tau[2,2] ~ dlnorm(-0.102681, 1);
tau[3,2] ~ dlnorm(-0.198863, 1);
tau[4,2] ~ dlnorm(-0.397496, 1);
tau[5,2] ~ dlnorm(-0.517286, 1);
tau[6,2] ~ dlnorm(-0.499462, 1);
tau[7,2] ~ dlnorm(-0.332597, 1);
tau[8,2] ~ dlnorm(-0.263551, 1);
tau[9,2] ~ dlnorm(-0.25167, 1);
tau[10,2] ~ dlnorm(-0.155953, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 0.7527071971526685, 
                    1.4962821392495642, 
                    1.1924166560589025, 
                    0.6502051978145531, 
                    0.3716313528475558, 
                    0.41099748731300745, 
                    -0.8156587132925933, 
                    -1.0038816817154204, 
                    -1.0376000681874031, 
                    -1.3243747023194756 ),
tau=matrix(c( NA,1.1539655315215482, 
                    NA,1.4878306805230546, 
                    NA,1.3513950785704472, 
                    NA,1.1079421338187343, 
                    NA,0.9828624774285526, 
                    NA,1.0005378718035405, 
                    NA,1.1822307622683745, 
                    NA,1.2667428750902239, 
                    NA,1.281882430616144, 
                    NA,1.4106442413414446 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 0.17389649828613524, 
                    -0.18923900685193187, 
                    -0.12524415078293205, 
                    0.25870293158185986, 
                    0.14747256420242438, 
                    -0.24919930718525227, 
                    -0.039317472560051636, 
                    -0.12093860368343626, 
                    0.17615984136452506, 
                    0.04498238699709545, 
                    -0.12093860368343626, 
                    0.24991243655702172, 
                    -0.20518618755203494, 
                    -0.0726571152592394, 
                    0.34635556950067026, 
                    -0.24919930718525227, 
                    0.11131027250250003, 
                    0.027107946809409533, 
                    -0.15172422596662316, 
                    -0.15172422596662316, 
                    0.16183547274233695, 
                    0.24978239913397637, 
                    0.16682112304418578, 
                    -0.10288552792000485, 
                    0.09275354398833457, 
                    0.003114850527934643, 
                    0.06739861313269052, 
                    0.2243773428469687, 
                    -0.15172422596662316, 
                    0.31012529677264444, 
                    -0.05809109055685374, 
                    0.2763014922413959, 
                    -0.05478267507155338, 
                    0.04498238699709545, 
                    -0.0457238475186838, 
                    -0.20518618755203494, 
                    -0.20518618755203494, 
                    -0.18923900685193187, 
                    -0.24919930718525227, 
                    0.23604110187609612, 
                    -0.12093860368343626, 
                    0.34635556950067026, 
                    0.11264379044612666, 
                    -0.20518618755203494, 
                    -0.15172422596662316, 
                    -0.24919930718525227, 
                    -0.2078105965163985, 
                    0.11264379044612666, 
                    0.23604110187609612, 
                    0.15804354436507734, 
                    0.24956412900224334, 
                    -0.07354752754309968, 
                    -0.12093860368343626, 
                    0.34173828965693187, 
                    -0.1691350912770606, 
                    -0.12093860368343626, 
                    0.13858554875369805, 
                    -0.18923900685193187, 
                    -0.09390129417388776, 
                    0.020401233859230872, 
                    -0.10130480053102578, 
                    0.2763014922413959, 
                    -0.18923900685193187, 
                    0.0055752339320253586, 
                    -0.05478267507155338, 
                    0.19626041253156423, 
                    -0.07354752754309968, 
                    -0.18923900685193187, 
                    -0.07354752754309968, 
                    0.16183547274233695, 
                    -0.07354752754309968, 
                    0.06741901627292379, 
                    0.25001612994603734, 
                    0.07978086306578464, 
                    -0.12093860368343626, 
                    -0.057098330040109446, 
                    -0.0457238475186838, 
                    0.19167506714953902, 
                    0.19857606750012008, 
                    -0.24919930718525227, 
                    0.028113290871679464, 
                    0.17417640686617325, 
                    -0.18923900685193187, 
                    -0.10815788574710733, 
                    0.31733045323981324, 
                    -0.10815788574710733, 
                    -0.0457238475186838, 
                    0.09365219774671035, 
                    0.024566826631441774, 
                    0.09154479859221148, 
                    0.3145185864922808, 
                    -0.18923900685193187, 
                    -0.24919930718525227, 
                    0.0661703565650707, 
                    0.16310446754718338, 
                    0.09313006052123268, 
                    0.25001612994603734, 
                    0.18707882192356318, 
                    0.0745584708567662, 
                    0.3145185864922808, 
                    0.05769583602565398, 
                    -0.0921191172075663, 
                    0.31012529677264444, 
                    0.14391205810908236, 
                    0.09154479859221148, 
                    -0.18923900685193187, 
                    0.24179784213765287, 
                    -0.16649350755954279, 
                    -0.18923900685193187, 
                    -0.04797442258663964, 
                    0.24991243655702172, 
                    0.16310446754718338, 
                    0.03123089134427176, 
                    0.14616062917074346, 
                    -0.154184609370714, 
                    -0.14449474210617036, 
                    0.32095051321366264, 
                    -0.15172422596662316, 
                    0.04498238699709545, 
                    0.13874732317088584, 
                    0.09279681115985838, 
                    -0.16649350755954279, 
                    -0.15172422596662316, 
                    -0.16649350755954279, 
                    -0.0726571152592394, 
                    0.04498238699709545, 
                    -0.12864178818511252, 
                    -0.12093860368343626, 
                    0.04498238699709545, 
                    -0.08991239831051626, 
                    0.11053639129162779, 
                    -0.24919930718525227, 
                    0.24978239913397637, 
                    -0.0726571152592394, 
                    0.24179784213765287, 
                    -0.15172422596662316, 
                    -0.24919930718525227, 
                    -0.15172422596662316, 
                    -0.04797442258663964, 
                    0.11500905461168903, 
                    -0.07617193650746323, 
                    0.0055752339320253586, 
                    0.26457848946029705, 
                    -0.07354752754309968, 
                    -0.18923900685193187, 
                    -0.15172422596662316, 
                    -0.24919930718525227, 
                    -0.18923900685193187, 
                    0.2763014922413959, 
                    -9.701480624724201e-4, 
                    0.2166670409569943, 
                    -0.20562550671545682, 
                    0.0661703565650707, 
                    0.09326387542129244, 
                    -0.03740009699347652, 
                    0.2292496442427976, 
                    -0.07617193650746323, 
                    -0.0392560552880063, 
                    -0.24919930718525227, 
                    -0.24919930718525227, 
                    -0.12093860368343626, 
                    -0.12093860368343626, 
                    0.07512025407332062, 
                    0.1087287352783069, 
                    0.1087287352783069, 
                    0.2243773428469687, 
                    -0.01714239811409901, 
                    -0.07354752754309968, 
                    -0.20562550671545682, 
                    0.34173828965693187, 
                    -0.18923900685193187, 
                    0.25001612994603734, 
                    -0.1691350912770606, 
                    -0.11123742614970444, 
                    0.1521918209153736, 
                    0.014506176657916425, 
                    0.07771134533636237, 
                    0.34635556950067026, 
                    0.09279681115985838, 
                    0.2469879657563871, 
                    0.17615984136452506, 
                    0.29163654928658045, 
                    0.09326387542129244, 
                    -0.13283387742293123, 
                    -0.15172422596662316, 
                    -0.1691350912770606, 
                    -0.021452916293373453, 
                    0.24179784213765287, 
                    -0.20518618755203494, 
                    0.23814850103059498, 
                    -0.20518618755203494, 
                    0.2794885989450011, 
                    0.04498238699709545, 
                    0.09365219774671035, 
                    0.23917343317328932, 
                    -0.11123742614970444, 
                    0.34635556950067026, 
                    -0.1824055402293909, 
                    0.13352700024678343, 
                    0.020401233859230872, 
                    0.16394287189683587, 
                    0.31012529677264444, 
                    -0.012874852466748937, 
                    0.13874732317088584, 
                    -0.07240272585920823, 
                    0.08011980151293258, 
                    0.16183547274233695, 
                    0.34173828965693187, 
                    0.0012426845208075021, 
                    -0.24919930718525227, 
                    -0.04797442258663964, 
                    -0.031093006853825156, 
                    0.033302238562634146, 
                    -0.24919930718525227, 
                    0.020401233859230872, 
                    -0.18923900685193187, 
                    -0.15172422596662316, 
                    0.11264379044612666, 
                    0.04498238699709545, 
                    -0.07116937183431793, 
                    -0.154184609370714, 
                    0.2443198255923924, 
                    0.015057917054337733, 
                    0.01023885068399355, 
                    -0.15172422596662316, 
                    -0.07354752754309968, 
                    -0.07838805444392036, 
                    -0.11783600982635148, 
                    0.34173828965693187, 
                    -0.154184609370714, 
                    0.028113290871679464, 
                    0.2859226347465109, 
                    0.020401233859230872, 
                    0.34635556950067026, 
                    -0.07240272585920823, 
                    0.022106443227350947, 
                    -0.12093860368343626, 
                    0.18319232960731585, 
                    0.15937508933824612, 
                    -0.15172422596662316, 
                    0.34635556950067026, 
                    0.07978086306578464, 
                    -0.20562550671545682, 
                    -0.07354752754309968, 
                    0.34793530595985067, 
                    -0.0457238475186838, 
                    0.0055752339320253586, 
                    -0.07354752754309968, 
                    -0.0921191172075663, 
                    -0.04797442258663964, 
                    0.16394287189683587, 
                    -0.053701356563794406, 
                    -0.12093860368343626, 
                    -0.154184609370714, 
                    0.007155961321004434, 
                    -0.0457238475186838, 
                    0.2292496442427976, 
                    0.13242013888823712, 
                    0.24514285011029935, 
                    0.020401233859230872, 
                    -0.09529024544960138, 
                    -9.701480624724201e-4, 
                    -0.18923900685193187, 
                    0.29163654928658045, 
                    -0.12093860368343626, 
                    -0.06820772093975463, 
                    -0.24919930718525227, 
                    -0.1691350912770606, 
                    0.12208455115781036, 
                    -0.0921191172075663, 
                    -0.24919930718525227, 
                    -0.04797442258663964, 
                    -0.07617193650746323, 
                    -0.12093860368343626, 
                    0.09326387542129244, 
                    -0.24919930718525227, 
                    0.2737296768260914, 
                    0.005605143532910195, 
                    -0.24919930718525227, 
                    0.04498238699709545, 
                    -0.19114681683677776, 
                    -0.15172422596662316, 
                    -0.154184609370714, 
                    -0.0457238475186838, 
                    -0.24919930718525227, 
                    0.23660101683212315, 
                    0.3437311605363069, 
                    0.16310446754718338, 
                    0.31012529677264444, 
                    -0.031093006853825156, 
                    0.0926129766583732, 
                    0.04498238699709545, 
                    -0.07354752754309968, 
                    -0.2078105965163985, 
                    0.16682112304418578, 
                    0.2098594692462072, 
                    0.23066409019183814, 
                    -0.15172422596662316, 
                    -0.07354752754309968, 
                    -0.24919930718525227, 
                    -0.0457238475186838, 
                    0.06032416374699984, 
                    -0.24919930718525227, 
                    -0.10083803251639742, 
                    -0.24919930718525227, 
                    -0.19114681683677776, 
                    0.20788344286919402, 
                    -0.08389393522058844, 
                    -0.24919930718525227, 
                    0.11585496455631045, 
                    0.005605143532910195, 
                    0.024566826631441774, 
                    -0.10815788574710733, 
                    0.020401233859230872, 
                    -0.12524415078293205, 
                    -0.1457280532209372, 
                    -0.0457238475186838, 
                    0.005605143532910195, 
                    0.24514285011029935, 
                    0.23660101683212315, 
                    0.34793530595985067, 
                    -0.154184609370714, 
                    -0.007498498530324638, 
                    -0.20518618755203494, 
                    -0.04797442258663964, 
                    -0.06942849587251113, 
                    -0.12864178818511252, 
                    -0.16649350755954279, 
                    0.07441134479752448, 
                    -0.0457238475186838, 
                    -0.24919930718525227, 
                    0.17228273159724244, 
                    -0.031093006853825156, 
                    -0.1824055402293909, 
                    -0.01576105784069351, 
                    -0.24919930718525227, 
                    -0.24919930718525227, 
                    -0.0457238475186838, 
                    0.13189324815660658, 
                    -0.02053958570385009, 
                    0.09877245576520105, 
                    0.13858554875369805, 
                    -0.15172422596662316, 
                    -0.18923900685193187, 
                    -0.007498498530324638, 
                    0.2859226347465109, 
                    -0.15172422596662316, 
                    -0.0457238475186838, 
                    0.22700175181133225, 
                    -0.15172422596662316, 
                    0.2124838782105707, 
                    0.1087287352783069, 
                    -0.12093860368343626, 
                    -0.16158100714199508, 
                    -0.24919930718525227, 
                    -0.12093860368343626, 
                    0.23604110187609612, 
                    -0.20518618755203494, 
                    0.11053639129162779, 
                    -0.20518618755203494, 
                    -0.031093006853825156, 
                    0.028113290871679464, 
                    -0.021906607249614185, 
                    0.31733045323981324, 
                    -0.10288552792000485, 
                    -0.10288552792000485, 
                    -0.24919930718525227, 
                    0.06741901627292379, 
                    0.005605143532910195, 
                    -0.154184609370714, 
                    -0.0457238475186838, 
                    0.07978086306578464, 
                    0.14647031793355303, 
                    0.23660101683212315, 
                    0.08430043200573839, 
                    -0.1691350912770606, 
                    -0.03666233325169993, 
                    -0.15172422596662316, 
                    -0.18923900685193187, 
                    0.16183547274233695, 
                    -0.1485399199684696, 
                    0.027107946809409533, 
                    -0.04797442258663964, 
                    -0.15172422596662316, 
                    0.19167506714953902, 
                    -0.15172422596662316, 
                    0.07441134479752448, 
                    -0.24919930718525227, 
                    0.18707882192356318, 
                    -0.05373474516668536, 
                    -0.20518618755203494, 
                    -0.0636472621519383, 
                    0.25870293158185986, 
                    0.014792166768565596, 
                    -0.24919930718525227, 
                    -0.0457238475186838, 
                    0.31733045323981324, 
                    0.024566826631441774, 
                    0.027107946809409533, 
                    0.15804354436507734, 
                    0.23814850103059498, 
                    -0.06988518916259379, 
                    -0.07354752754309968, 
                    0.11264379044612666, 
                    -0.0457238475186838, 
                    0.271378850407203, 
                    0.2763014922413959, 
                    0.2292496442427976, 
                    -0.20518618755203494, 
                    0.29743232145645626, 
                    0.16682112304418578, 
                    0.23660101683212315, 
                    -0.24919930718525227, 
                    -0.05478267507155338, 
                    -0.14449474210617036, 
                    0.027107946809409533, 
                    -0.1691350912770606, 
                    -0.24919930718525227, 
                    -0.07354752754309968, 
                    -0.0457238475186838, 
                    -0.24919930718525227, 
                    -0.12864178818511252, 
                    -0.0457238475186838, 
                    0.20819025001942204, 
                    0.11264379044612666, 
                    0.34793530595985067, 
                    0.012319169187613499, 
                    0.2098594692462072, 
                    0.2369982542110985, 
                    0.035276069206570726, 
                    -0.18923900685193187, 
                    0.11264379044612666, 
                    0.04498238699709545, 
                    0.31012529677264444, 
                    -0.15172422596662316, 
                    -0.12524415078293205, 
                    -0.24919930718525227, 
                    -0.15172422596662316, 
                    0.13242013888823712, 
                    0.20343900267596576, 
                    -0.24919930718525227, 
                    0.11053639129162779, 
                    -0.12093860368343626, 
                    -0.029759046011666485, 
                    -0.0457238475186838, 
                    -0.12093860368343626, 
                    -0.18923900685193187, 
                    0.028113290871679464, 
                    -0.15172422596662316, 
                    -0.154184609370714, 
                    -0.24919930718525227, 
                    -0.05478267507155338, 
                    -0.07354752754309968, 
                    -0.08389393522058844, 
                    0.25203029156544177, 
                    0.31733045323981324, 
                    -0.12093860368343626, 
                    0.04498238699709545, 
                    -0.2078105965163985, 
                    -0.18923900685193187, 
                    -0.0457238475186838, 
                    -0.0921191172075663, 
                    0.028113290871679464, 
                    -0.0921191172075663, 
                    -0.154184609370714, 
                    -0.12093860368343626, 
                    -0.08904381202200395, 
                    -0.24919930718525227, 
                    -0.07354752754309968, 
                    0.020401233859230872, 
                    -0.24919930718525227, 
                    -0.15172422596662316, 
                    -0.10815788574710733, 
                    -0.09529024544960138, 
                    -0.1362942932594613, 
                    0.23660101683212315, 
                    0.24179784213765287, 
                    -0.20562550671545682, 
                    0.1502945790759232, 
                    0.25870293158185986, 
                    -0.0726571152592394, 
                    -0.12093860368343626, 
                    -0.03740009699347652, 
                    0.07512025407332062, 
                    0.24179784213765287, 
                    -0.09266583648523782, 
                    -0.18923900685193187, 
                    0.09365219774671035, 
                    -0.16649350755954279, 
                    0.12989961551747997, 
                    -0.15172422596662316, 
                    0.21811768724284153, 
                    0.018153341427765424, 
                    -0.13910415879879323, 
                    0.13290672377572682, 
                    -0.24919930718525227, 
                    -0.10815788574710733, 
                    -0.026219515382154862, 
                    0.17453062402870795, 
                    -0.0457238475186838 
)
)

