model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.18877, 1);
tau[1,3] ~ dlnorm(0.06677, 1);
tau[1,4] ~ dlnorm(-0.072209, 1);
tau[1,5] ~ dlnorm(-0.23367, 1);
tau[1,6] ~ dlnorm(-0.426316, 1);
tau[2,2] ~ dlnorm(0.057899, 1);
tau[2,3] ~ dlnorm(-0.068801, 1);
tau[2,4] ~ dlnorm(-0.213914, 1);
tau[2,5] ~ dlnorm(-0.383719, 1);
tau[2,6] ~ dlnorm(-0.588377, 1);
tau[3,2] ~ dlnorm(-0.07635, 1);
tau[3,3] ~ dlnorm(-0.208583, 1);
tau[3,4] ~ dlnorm(-0.361004, 1);
tau[3,5] ~ dlnorm(-0.54091, 1);
tau[3,6] ~ dlnorm(-0.76044, 1);
tau[4,2] ~ dlnorm(0.140348, 1);
tau[4,3] ~ dlnorm(0.016683, 1);
tau[4,4] ~ dlnorm(-0.124462, 1);
tau[4,5] ~ dlnorm(-0.288855, 1);
tau[4,6] ~ dlnorm(-0.485694, 1);
tau[5,2] ~ dlnorm(-0.255244, 1);
tau[5,3] ~ dlnorm(-0.396165, 1);
tau[5,4] ~ dlnorm(-0.560255, 1);
tau[5,5] ~ dlnorm(-0.756659, 1);
tau[5,6] ~ dlnorm(-1.001306, 1);
tau[6,2] ~ dlnorm(-0.23725, 1);
tau[6,3] ~ dlnorm(-0.377222, 1);
tau[6,4] ~ dlnorm(-0.540025, 1);
tau[6,5] ~ dlnorm(-0.734587, 1);
tau[6,6] ~ dlnorm(-0.976376, 1);
tau[7,2] ~ dlnorm(0.045752, 1);
tau[7,3] ~ dlnorm(-0.081417, 1);
tau[7,4] ~ dlnorm(-0.227147, 1);
tau[7,5] ~ dlnorm(-0.397797, 1);
tau[7,6] ~ dlnorm(-0.603685, 1);
tau[8,2] ~ dlnorm(0.053491, 1);
tau[8,3] ~ dlnorm(-0.073378, 1);
tau[8,4] ~ dlnorm(-0.218714, 1);
tau[8,5] ~ dlnorm(-0.388824, 1);
tau[8,6] ~ dlnorm(-0.593926, 1);
tau[9,2] ~ dlnorm(0.038373, 1);
tau[9,3] ~ dlnorm(-0.089084, 1);
tau[9,4] ~ dlnorm(-0.235193, 1);
tau[9,5] ~ dlnorm(-0.406363, 1);
tau[9,6] ~ dlnorm(-0.613009, 1);
tau[10,2] ~ dlnorm(0.137317, 1);
tau[10,3] ~ dlnorm(0.013545, 1);
tau[10,4] ~ dlnorm(-0.127739, 1);
tau[10,5] ~ dlnorm(-0.292322, 1);
tau[10,6] ~ dlnorm(-0.489433, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.4086108688476848, 
                    1.0499235930900506, 
                    0.727644947602046, 
                    1.2703977188726978, 
                    0.360220377482125, 
                    0.3942755259944867, 
                    -1.0189506899434817, 
                    -1.0386411500291692, 
                    -1.0003183301405099, 
                    -1.2619669858432054 ),
tau=matrix(c( NA,1.9912640016852736,1.7625645712921079,1.533865140898942,1.3051657105057763,1.0764662801126106, 
                    NA,1.7469979668943245,1.5391023984951016,1.3312068300958786,1.1233112616966556,0.9154156932974327, 
                    NA,1.5275262093169932,1.3383228023560747,1.149119395395156,0.9599159884342373,0.7707125814733187, 
                    NA,1.8971408465523074,1.6764577788576909,1.4557747111630743,1.2350916434684578,1.0144085757738412, 
                    NA,1.2773100770653272,1.109417295171364,0.9415245132774006,0.7736317313834373,0.605738949489474, 
                    NA,1.3005016332022454,1.130633652694565,0.9607656721868849,0.7908976916792047,0.6210297111715244, 
                    NA,1.725905419851511,1.519806279834789,1.313707139818067,1.107607999801345,0.9015088597846233, 
                    NA,1.7393146231698646,1.5320734364681727,1.3248322497664808,1.117591063064789,0.910349876363097, 
                    NA,1.7132167828256875,1.508198319677538,1.3031798565293882,1.0981613933812384,0.8931429302330889, 
                    NA,1.891399517359223,1.6712054321803171,1.4510113470014112,1.2308172618225053,1.0106231766435994 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.4636088027854409, 
                    0.3783820772644054, 
                    0.3938078389756382, 
                    -0.2536675097148049, 
                    0.0387418687974691, 
                    -0.09780620202711765, 
                    -0.30613868275935796, 
                    -0.03720443387255856, 
                    0.008696107256223273, 
                    0.616659985016259, 
                    0.09986599227114079, 
                    -0.27517996617168194, 
                    0.46725502879551584, 
                    -0.1722051703385945, 
                    -0.49866349413180344, 
                    0.12818824090435932, 
                    -0.0067343789034931545, 
                    -0.4688719262560275, 
                    -0.6902729967949702, 
                    0.43951563099640667, 
                    0.3571442648477653, 
                    -0.13228179755444924, 
                    0.27139613468706636, 
                    0.08782626120570924, 
                    -0.48830052021003256, 
                    -0.35915118698936005, 
                    0.5499362248323384, 
                    -0.1125889789475153, 
                    -0.42960140469431024, 
                    -0.42709678560480036, 
                    0.4866025332766867, 
                    -0.6019521029158844, 
                    0.5102586386852869, 
                    0.4682027379639141, 
                    -0.3292829605990324, 
                    -0.06651746831188476, 
                    0.5509572895722689, 
                    0.2046472836018538, 
                    0.21524123771312886, 
                    0.22273677380291224, 
                    0.44218678389257915, 
                    0.26213284541971493, 
                    0.3407372630768718, 
                    -0.0677872207891812, 
                    -0.6902729967949702, 
                    0.18719022510868155, 
                    -0.3706310263129674, 
                    -0.35401266816500226, 
                    -0.6389498724611343, 
                    -0.03892754058288439, 
                    0.17125011508618293, 
                    -0.37349118533555975, 
                    0.5712834565213677, 
                    0.7370561499232188, 
                    -0.23165570573772593, 
                    -0.4033844522602211, 
                    -0.3331779577043682, 
                    -0.3643860711874565, 
                    -0.4733260120269313, 
                    -0.3259519578347936, 
                    -0.5269295962538587, 
                    -0.23190644479448386, 
                    0.12191470843538355, 
                    0.5387048134592828, 
                    0.12431628950991547, 
                    0.7421301392201515, 
                    0.3764404692479678, 
                    -0.16322004503080512, 
                    0.6675747758701235, 
                    -0.2878235655836035, 
                    0.35587289836023295, 
                    0.2693164398692184, 
                    0.5285163640751006, 
                    -0.38894477238158087, 
                    -0.5876263301610851, 
                    -0.3491290946122555, 
                    0.15654254136846413, 
                    0.009387267185992032, 
                    0.25695560424412833, 
                    -0.4894768027977093, 
                    -0.19520612516799424, 
                    -0.6313967935405963, 
                    0.42332457079933106, 
                    -0.11148080291028484, 
                    0.46141434968597805, 
                    -0.18813764849820014, 
                    0.5697190146387897, 
                    0.3514122469612183, 
                    -0.4370175487438279, 
                    -0.22754508138893303, 
                    0.39341489075608893, 
                    0.6202505326956661, 
                    0.038515644958516115, 
                    0.5286355237554173, 
                    -0.4890031740134513, 
                    0.5887702747887661, 
                    -0.23938824000684417, 
                    -0.6206541720243295, 
                    -0.46104662115370526, 
                    0.5979137833735032, 
                    0.24028208313693267, 
                    -0.19370899271593528, 
                    0.47296070192083717, 
                    -0.2169639495993515, 
                    0.5169372505339936, 
                    -0.539611336018836, 
                    0.381411246291124, 
                    0.1329245616094723, 
                    0.24243644292170474, 
                    -0.4026106567084703, 
                    -0.03422029237176105, 
                    0.48899534582953386, 
                    -0.43478554481662124, 
                    -0.5916776765413833, 
                    -0.591854958047478, 
                    0.15542907214198498, 
                    0.16856625920171087, 
                    0.3469330217185981, 
                    -0.6494377118629535, 
                    -0.4682701325004427, 
                    -0.4450011547985784, 
                    -0.05636371545925034, 
                    -0.12158952485313401, 
                    -0.014093367421654457, 
                    -0.39795475674935266, 
                    0.6817333104763231, 
                    -0.47816673186607545, 
                    -0.5407360345393131, 
                    -0.5320733068054229, 
                    -0.2208482416918761, 
                    0.535754644396511, 
                    -0.5815107099271564, 
                    0.3109530794293932, 
                    -0.2907780191794745, 
                    0.2229652062102392, 
                    -0.6341376229277115, 
                    0.38467102637934103, 
                    0.11727490375536576, 
                    -0.4828952660592741, 
                    -0.5050939027628494, 
                    -0.44108382300680044, 
                    -0.5034307115351554, 
                    0.6345444317309351, 
                    -0.2881779887426226, 
                    -0.029391450915463913, 
                    0.2545208747412202, 
                    0.4034915654817438, 
                    -0.5602876742562218, 
                    -0.6705594109657208, 
                    -0.2886423591104727, 
                    0.5423579426482305, 
                    -0.002844214820455937, 
                    -0.3848274851474445, 
                    0.20502874596452503, 
                    -0.5394777523499925, 
                    -0.19056068162224477, 
                    -0.6902729967949702, 
                    -0.2466235413724004, 
                    0.2673814117403829, 
                    0.19604127450193265, 
                    0.4517904730564669, 
                    0.28830563428072964, 
                    0.32534941105840465, 
                    -0.004713709545620448, 
                    0.1298735850513436, 
                    -0.3798570895006821, 
                    0.06753284088304534, 
                    -0.25641383550029434, 
                    -0.5084442249544678, 
                    -0.29342263565303145, 
                    0.5696011898691687, 
                    0.14225637763484655, 
                    0.0031634403489003704, 
                    -0.5407360345393131, 
                    0.49579749478099433, 
                    -0.17063913267396835, 
                    -0.6440233732604908, 
                    0.4439328142068856, 
                    -0.06811425247391223, 
                    0.09711362829702475, 
                    0.529145484349908, 
                    0.7237807682189213, 
                    -0.5707311356257013, 
                    -0.2966078247471701, 
                    -0.6320531422101192, 
                    0.25003294121567854, 
                    -0.3400458713663832, 
                    0.33309069696388083, 
                    0.11240113480237257, 
                    0.5733325281596439, 
                    0.15797164674314612, 
                    -0.0883530858833258, 
                    0.10366754236470366, 
                    0.39493790850272104, 
                    -0.4137411961728437, 
                    0.39493863042962174, 
                    -0.17992775609320488, 
                    -0.5590927551923044, 
                    -0.2971578735284372, 
                    0.7641611777608223, 
                    0.39498065224328227, 
                    0.6730233561543985, 
                    -0.3047624556613053, 
                    0.4892579408827119, 
                    -0.04694499660870577, 
                    0.6261545305082895, 
                    0.5141907864966152, 
                    -0.49821113531310857, 
                    -0.036138938285171895, 
                    0.375331308063925, 
                    -0.22033036148463264, 
                    -0.06704989184732857, 
                    -0.3291424620773028, 
                    0.28953200210436625, 
                    -0.6902729967949702, 
                    0.66368014846497, 
                    -0.6069412697156701, 
                    0.6547062115393604, 
                    0.5569530948758358, 
                    -0.2567209381636614, 
                    -0.047539257491039044, 
                    -0.5133535989586124, 
                    0.03591573116464675, 
                    -0.09114969846179599, 
                    -0.15977181755833259, 
                    -0.34905791978270345, 
                    0.22511846485711595, 
                    0.5535910653342214, 
                    0.39944107759586156, 
                    0.5140654184248178, 
                    -0.2538842874020935, 
                    0.5173583233010691, 
                    -0.0890837809982713, 
                    -0.11162496480873274, 
                    -0.16078567526488774, 
                    -0.39959998383312484, 
                    -0.6902729967949702, 
                    0.19511448509925433, 
                    0.48753113327697595, 
                    0.5877015017743471, 
                    0.4539721684382684, 
                    0.3231787099569, 
                    0.3551873508616724, 
                    -0.5237853202811905, 
                    0.15551167569493385, 
                    0.21089118117045846, 
                    0.6339691142630409, 
                    -0.21576273211245023, 
                    -0.2195183993066388, 
                    0.5095496724404202, 
                    0.6673551909462657, 
                    -0.5149294359442428, 
                    -0.23024046832615758, 
                    -0.071375775847347, 
                    -0.32798137347166706, 
                    0.6541921185823806, 
                    -0.04600594886682796, 
                    -0.6012537349719406, 
                    0.3870058684239094, 
                    0.7115895416193968, 
                    0.2040796954712426, 
                    -0.11167638926745438, 
                    -0.5700485834627481, 
                    0.6258931455027931, 
                    0.4552640172317427, 
                    -0.3728469354117331, 
                    0.024263046618505535, 
                    0.536136648761293, 
                    -0.08063827146537239, 
                    -0.42803633490559584, 
                    0.2969088098912288, 
                    0.4137418565616825, 
                    0.31253434480225384, 
                    0.12922004257323016, 
                    0.4801500816537513, 
                    0.35782580911162765, 
                    -0.040847678526042874, 
                    0.34664258469100673, 
                    -0.1571023606636498, 
                    0.6314924812909503, 
                    0.25259453633211093, 
                    0.6070701033370792, 
                    -0.3191486443753321, 
                    -0.13003088608140212, 
                    -0.4590491599744352, 
                    0.012650283173104016, 
                    0.6553253446833808, 
                    -0.19686890699336884, 
                    0.7120250078297051, 
                    0.20269981745726018, 
                    0.27576603840447766, 
                    0.2635115303656107, 
                    0.5259048469083755, 
                    -0.2745864323875815, 
                    -0.10950105267745036, 
                    -7.010363838798606e-4, 
                    -0.14098943771000205, 
                    -0.6437865349238037, 
                    -0.0162039056887735, 
                    -0.4834023020867543, 
                    7.700317951424562e-4, 
                    -0.23858742971530883, 
                    -0.035279268745946, 
                    -0.2840032818919074, 
                    -0.07179310220511681, 
                    -0.13425754209507146, 
                    0.706842404262965, 
                    -0.20768200247640384, 
                    0.45921543483771277, 
                    -0.37143153824571506, 
                    -0.5769791231955953, 
                    0.3235125897770267, 
                    -0.3769159317593168, 
                    -0.3531444817050104, 
                    0.1061307119116216, 
                    -0.24687565091690084, 
                    -0.5807104451264956, 
                    -0.03217009086530531, 
                    -0.0949477167856928, 
                    0.4962318854736373, 
                    0.16957519372432694, 
                    -0.12008764320332721, 
                    -0.14470695277663603, 
                    0.2941514448320486, 
                    -0.4232384106828837, 
                    -0.5084442249544678, 
                    -0.3088608891100832, 
                    0.5897917812137728, 
                    0.030501897117349297, 
                    -0.4987501546338536, 
                    0.13156153058125464, 
                    0.02852151021478888, 
                    -0.25761299763472123, 
                    -0.3484003131257359, 
                    -0.3464690728379455, 
                    0.10316968954196348, 
                    0.684695043277734, 
                    0.5629120826104083, 
                    0.3811891086557534, 
                    -0.678939283238125, 
                    0.5489770525848602, 
                    0.22536897367078557, 
                    -0.39926136682149893, 
                    -0.2691130459322439, 
                    0.30918864265427026, 
                    0.5413684479858251, 
                    0.6625531746745431, 
                    -0.384160655111188, 
                    -0.5613713654861505, 
                    -0.45799446144526107, 
                    0.17283555429107722, 
                    -0.004062746248990612, 
                    -0.1337898739716077, 
                    -0.5916776765413833, 
                    -0.08887373659984565, 
                    -0.12542568427281842, 
                    -0.22181880771579787, 
                    0.5517621612910958, 
                    0.31417753172356366, 
                    -0.4095219296484127, 
                    -0.551941430050743, 
                    -0.023117107091742306, 
                    0.5088873972622591, 
                    0.14818520606699292, 
                    0.23786030333457808, 
                    0.20857886784362967, 
                    -0.5247163088627114, 
                    -0.20293547250031763, 
                    0.6375752899634327, 
                    0.5023050403070574, 
                    -0.5239275383925321, 
                    0.4771740456262864, 
                    0.051841535517437975, 
                    0.027913961014215616, 
                    -0.20611438446194658, 
                    -0.048963156449977174, 
                    -0.39099985563918876, 
                    0.5300454025418361, 
                    -0.4181446010079114, 
                    0.1245849640068537, 
                    -0.6124977683465919, 
                    -0.49821113531310857, 
                    -0.5074958041814785, 
                    0.20061159241991677, 
                    -0.6199968377919324, 
                    -0.053511871395364174, 
                    -0.46203074618593243, 
                    0.5558650349976716, 
                    0.1731395903548706, 
                    -0.5203350163455683, 
                    -0.0026543787407050656, 
                    -0.3664182396924814, 
                    0.6055505238269409, 
                    -0.3652460760114972, 
                    -0.0648718476419553, 
                    -0.3222170169461947, 
                    0.27120102886161146, 
                    -0.3943522693303189, 
                    -0.2098376749957347, 
                    -0.2537963810650356, 
                    -0.10262188955676721, 
                    -0.3257372676971353, 
                    -0.06278912942231296, 
                    0.00903314063372429, 
                    0.6672145984830501, 
                    0.43077312062243067, 
                    0.4622131160241797, 
                    -0.059446891539953195, 
                    0.18380476549511338, 
                    0.08203861833726389, 
                    0.5742497082514068, 
                    -0.6341376229277115, 
                    -0.5277848979465231, 
                    -0.270206711579416, 
                    -0.6044176030863077, 
                    0.22851723357917275, 
                    -0.047160489080564916, 
                    -0.612070919695393, 
                    0.040333233217566544, 
                    0.005834424494793655, 
                    -0.3220711213430964, 
                    0.4683383618334108, 
                    -0.48878439724607603, 
                    0.7239140157838567, 
                    0.6154499756094837, 
                    0.2762279792357877, 
                    0.06253362218271041, 
                    0.52573236056679, 
                    -0.4675042122071499, 
                    0.3836983532370498, 
                    -0.4320318421589447, 
                    0.11480248105830537, 
                    0.605813274746026, 
                    0.7171440133843342, 
                    0.21099807795111536, 
                    -0.14470044167599694, 
                    -0.05381428100470942, 
                    -0.2013034070225166, 
                    0.4573088107454494, 
                    -0.011760250356600221, 
                    0.5035121842126925, 
                    0.1667481991268731, 
                    0.16127708082017378, 
                    -0.588792957371113, 
                    0.4901205283440605, 
                    0.6142633939108345, 
                    -0.4980170204906549, 
                    -0.2708992589312048, 
                    -0.3659527030043046, 
                    0.6553253446833808, 
                    -0.6341376229277115, 
                    -0.5320733068054229, 
                    0.3330455485531677, 
                    0.6169948828565105, 
                    0.5883544905346431, 
                    0.17105091612654366, 
                    0.3123820876863995, 
                    -0.31133509673194437, 
                    -0.6436442792112604, 
                    0.3978987972489, 
                    -0.33353076020330524, 
                    0.5750100731961695, 
                    0.29564432151404263, 
                    -0.35417636088744675, 
                    0.3423558988137715, 
                    0.3648787806065973, 
                    -0.17960594450539658, 
                    0.23173209435822228, 
                    0.14036491071810298, 
                    -0.39005421226894105, 
                    -0.1061435803845241, 
                    -0.40924718653980274, 
                    0.2008632256394689, 
                    -0.44545574980161884, 
                    0.6924906899018425, 
                    -0.5479899501957473, 
                    -0.34547869462011077, 
                    -0.3934364907396093, 
                    0.1457544539737654, 
                    0.49374785031185253, 
                    -0.16325027025616878, 
                    0.19830077049926453, 
                    -0.44039207582860534, 
                    -0.32400024124665033, 
                    -0.33508331272492853, 
                    0.17552193990105003, 
                    -0.03194638168936115, 
                    -0.4158234638579957, 
                    0.0057105895209079716, 
                    0.637093275444561, 
                    -0.12971259641675892, 
                    0.1980913996880307, 
                    -0.17158954108639046, 
                    -0.5023743129047844, 
                    0.128748101246562, 
                    -0.6445337082660342, 
                    -0.0858552984358194, 
                    -0.5318501187469679, 
                    -0.4067925351904093, 
                    0.5617182417638892 
)
)

