model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.131644, 1);
tau[2,2] ~ dlnorm(-0.302556, 1);
tau[3,2] ~ dlnorm(-0.266967, 1);
tau[4,2] ~ dlnorm(-0.429063, 1);
tau[5,2] ~ dlnorm(-0.543441, 1);
tau[6,2] ~ dlnorm(-0.485596, 1);
tau[7,2] ~ dlnorm(-0.274508, 1);
tau[8,2] ~ dlnorm(-0.311099, 1);
tau[9,2] ~ dlnorm(-0.110816, 1);
tau[10,2] ~ dlnorm(-0.206608, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.401685773477697, 
                    -0.8959562109689446, 
                    -0.9942597842202304, 
                    -0.5735271474015411, 
                    -0.3151206113418699, 
                    -0.4421120408524065, 
                    0.9731389337587538, 
                    0.8728759163900791, 
                    1.469435760374115, 
                    1.169195387792147 ),
tau=matrix(c( NA,1.4453569122914862, 
                    NA,1.2182843387250561, 
                    NA,1.2624226431148835, 
                    NA,1.073513689183292, 
                    NA,0.9574891544924997, 
                    NA,1.0145083063427305, 
                    NA,1.2529393812576806, 
                    NA,1.2079212864591455, 
                    NA,1.4757766564079777, 
                    NA,1.340968729118674 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 0.2672118855367247, 
                    -0.28596032042971486, 
                    0.19538021426592483, 
                    0.16565624905768905, 
                    0.251540218731064, 
                    0.3104736020262501, 
                    0.06365728843146123, 
                    0.004865194601281986, 
                    -0.019098951488422666, 
                    0.25949934573913436, 
                    -0.2975423211381427, 
                    0.17740415463362835, 
                    -0.03143471046814644, 
                    -0.15869366187382147, 
                    0.18599342094098664, 
                    0.07650036280188527, 
                    0.19999745337194325, 
                    -0.07606455408880716, 
                    0.03826345043697782, 
                    0.3104736020262501, 
                    0.1432373546555652, 
                    -0.053906862976454, 
                    -0.2029714628661864, 
                    -0.0598046875275525, 
                    -0.005106979300741166, 
                    0.268767321135042, 
                    -0.11296485316713067, 
                    0.268767321135042, 
                    0.17740415463362835, 
                    -0.28596032042971486, 
                    -0.2975423211381427, 
                    -0.1807238745926616, 
                    -0.020166267270633198, 
                    0.03826345043697782, 
                    0.11541720256122096, 
                    0.15843773912966347, 
                    0.026423644884277675, 
                    0.03826345043697782, 
                    -0.05189163679511519, 
                    0.11541720256122096, 
                    0.025149298707028034, 
                    -0.04173372866939301, 
                    -0.03241979564772024, 
                    -0.09186667896154233, 
                    0.1432373546555652, 
                    0.25949934573913436, 
                    -0.2879043398238586, 
                    -0.23147574629198292, 
                    0.16565624905768905, 
                    0.25949934573913436, 
                    -0.07746588591472711, 
                    -0.1689093986080255, 
                    -0.10143212057693105, 
                    -0.22869418951883555, 
                    0.15843773912966347, 
                    -0.18084633984999843, 
                    -0.2029714628661864, 
                    0.251540218731064, 
                    0.025149298707028034, 
                    0.025149298707028034, 
                    -0.020166267270633198, 
                    0.3104736020262501, 
                    0.2672118855367247, 
                    0.1432373546555652, 
                    0.23004494782657048, 
                    -0.2879043398238586, 
                    0.20818695250709707, 
                    0.251540218731064, 
                    0.05592464882415238, 
                    -0.13804878797546422, 
                    0.3104736020262501, 
                    -0.24447206331349525, 
                    0.22433736101082646, 
                    -0.18699031317820375, 
                    0.04490393013383259, 
                    0.15070743874442027, 
                    0.05592464882415238, 
                    -0.18699031317820375, 
                    -0.11296485316713067, 
                    -0.12028327466222599, 
                    0.03826345043697782, 
                    0.1177730232112632, 
                    -0.1339582440265067, 
                    -0.038563768975925616, 
                    -0.2975423211381427, 
                    -0.22869418951883555, 
                    0.20838463151822229, 
                    -0.038563768975925616, 
                    0.11386344548032457, 
                    -0.20908913522494527, 
                    -0.020166267270633198, 
                    0.06745738141435204, 
                    0.17740415463362835, 
                    -0.13317234844206868, 
                    0.06745738141435204, 
                    0.05592464882415238, 
                    0.03821972897592091, 
                    0.1177730232112632, 
                    0.23004494782657048, 
                    -0.22869418951883555, 
                    0.06345832471290597, 
                    -0.20714212965116646, 
                    0.007963450968151708, 
                    -0.29637043512456096, 
                    0.07335520596545053, 
                    -0.08013962555971388, 
                    0.1374547915231366, 
                    0.12262445258360016, 
                    0.17982169187481345, 
                    0.14823757160131745, 
                    0.18412845007203404, 
                    -0.15538221552140674, 
                    -0.1187474162995592, 
                    0.0819159344314539, 
                    -0.23147574629198292, 
                    0.05248662488900813, 
                    0.05592464882415238, 
                    -0.23147574629198292, 
                    -0.07689085967226666, 
                    -0.29637043512456096, 
                    0.013514471800584349, 
                    0.24441808004425802, 
                    0.03826345043697782, 
                    -0.08899861850492674, 
                    0.1374547915231366, 
                    -0.18084633984999843, 
                    -0.1314278081431165, 
                    -0.20202037015048363, 
                    -0.15766238224388363, 
                    0.3104736020262501, 
                    -0.2465211959034417, 
                    0.23004494782657048, 
                    0.11386344548032457, 
                    -0.07746588591472711, 
                    -0.04019561848625908, 
                    -0.03241979564772024, 
                    0.2672118855367247, 
                    -0.1510336574460032, 
                    -0.2975423211381427, 
                    0.036678820985767246, 
                    -0.2510944902660036, 
                    -0.22329253815489597, 
                    0.251540218731064, 
                    0.14411972348809376, 
                    0.1432373546555652, 
                    0.06745738141435204, 
                    0.20838463151822229, 
                    0.09930547030602443, 
                    -0.2975423211381427, 
                    -0.22393275764883913, 
                    0.0973759414883717, 
                    0.23004494782657048, 
                    -0.11296485316713067, 
                    -0.15291421627762242, 
                    -0.030515017595466154, 
                    -0.14473298913337587, 
                    0.0585251086755591, 
                    -0.20202037015048363, 
                    -0.0726165778551445, 
                    -0.2576480618160893, 
                    0.22433736101082646, 
                    -0.2975423211381427, 
                    -0.29637043512456096, 
                    0.03674048291022525, 
                    0.03826345043697782, 
                    -0.09881964407009511, 
                    -0.14911577693586459, 
                    -0.29637043512456096, 
                    -0.07746588591472711, 
                    -0.28596032042971486, 
                    -0.20202037015048363, 
                    -0.17189472175054035, 
                    -0.18084633984999843, 
                    -0.22869418951883555, 
                    0.3104736020262501, 
                    0.03826345043697782, 
                    -0.2510944902660036, 
                    0.3104736020262501, 
                    -0.13548365913632432, 
                    0.07094423460755611, 
                    -0.20908913522494527, 
                    0.25949934573913436, 
                    0.14411972348809376, 
                    0.15843773912966347, 
                    0.15719015375698658, 
                    -0.14911577693586459, 
                    0.3104736020262501, 
                    0.23004494782657048, 
                    0.14133080105327395, 
                    0.06745738141435204, 
                    0.12410369864929582, 
                    -0.16192568267008062, 
                    -0.1652105205926287, 
                    -0.08899861850492674, 
                    0.2672118855367247, 
                    0.18300528976082253, 
                    -0.16192568267008062, 
                    0.128688941335031, 
                    0.02142590425686386, 
                    -0.2510944902660036, 
                    -0.28596032042971486, 
                    0.251540218731064, 
                    0.023408659229339046, 
                    -0.09107418757369243, 
                    0.251540218731064, 
                    -0.13317234844206868, 
                    0.079114977584528845, 
                    -0.2975423211381427, 
                    -0.08377092218975646, 
                    -0.10016897677533976, 
                    0.251540218731064, 
                    0.1177730232112632, 
                    -0.07746588591472711, 
                    -0.0598046875275525, 
                    0.26030122583433957, 
                    -0.28596032042971486, 
                    0.05592464882415238, 
                    -0.2510944902660036, 
                    0.11541720256122096, 
                    0.15843773912966347, 
                    0.21612391685150556, 
                    -0.2765735271047767, 
                    0.23004494782657048, 
                    -0.019098951488422666, 
                    0.06745738141435204, 
                    0.251540218731064, 
                    -0.2465211959034417, 
                    -0.08625598439809973, 
                    0.19999745337194325, 
                    0.03826345043697782, 
                    0.1177730232112632, 
                    -0.2465211959034417, 
                    0.09665217927484798, 
                    -0.23147574629198292, 
                    0.1963296436593202, 
                    0.08705194192893734, 
                    0.22433736101082646, 
                    0.24441808004425802, 
                    0.251540218731064, 
                    -0.23147574629198292, 
                    0.22433736101082646, 
                    0.20445103065953452, 
                    0.251540218731064, 
                    -0.03241979564772024, 
                    -0.2465211959034417, 
                    0.20938424669688138, 
                    0.05014208569172379, 
                    -0.23147574629198292, 
                    0.0036540278025344874, 
                    -0.21126363237753745, 
                    -0.07486599395261778, 
                    0.25949934573913436, 
                    0.3104736020262501, 
                    0.03826345043697782, 
                    0.23004494782657048, 
                    0.16134682589207178, 
                    -0.019098951488422666, 
                    -0.0640278933045173, 
                    0.25949934573913436, 
                    0.1645476800422746, 
                    0.06828691864256436, 
                    0.23004494782657048, 
                    -0.06046879243606673, 
                    -0.10143212057693105, 
                    -0.2975423211381427, 
                    -0.1314278081431165, 
                    0.3104736020262501, 
                    0.0036540278025344874, 
                    -0.11298272073410864, 
                    -0.22279636496773708, 
                    0.23004494782657048, 
                    -0.09186667896154233, 
                    0.0585251086755591, 
                    0.3104736020262501, 
                    0.015975285713660636, 
                    0.11231171358619174, 
                    -0.025652147335717912, 
                    0.19999745337194325, 
                    -0.15538221552140674, 
                    0.05592464882415238, 
                    0.1177730232112632, 
                    0.03826345043697782, 
                    -0.2975423211381427, 
                    -0.22869418951883555, 
                    0.1177730232112632, 
                    -0.03241979564772024, 
                    0.016527004512804533, 
                    -0.15538221552140674, 
                    0.3104736020262501, 
                    0.3104736020262501, 
                    0.19597210037854285, 
                    -0.03241979564772024, 
                    -0.23903755961900486, 
                    -0.1436739950230334, 
                    -0.0640278933045173, 
                    0.2672118855367247, 
                    -0.026310240598838575, 
                    0.20818695250709707, 
                    -0.03241979564772024, 
                    -0.11631938527906921, 
                    0.026175851029519914, 
                    -0.178448293300626, 
                    -0.0014012439842601698, 
                    0.06446337139874703, 
                    0.0036540278025344874, 
                    -0.019098951488422666, 
                    -0.1510336574460032, 
                    0.12693387574921738, 
                    0.3104736020262501, 
                    0.22132266676872192, 
                    0.12767073093830805, 
                    -0.11296485316713067, 
                    -0.08899861850492674, 
                    0.0036540278025344874, 
                    -0.16192568267008062, 
                    -0.22136689194204945, 
                    -0.2465211959034417, 
                    -0.042564246653809534, 
                    -0.2029714628661864, 
                    -0.23147574629198292, 
                    -0.211598320441239, 
                    0.268767321135042, 
                    0.025149298707028034, 
                    0.05592464882415238, 
                    -0.07746588591472711, 
                    -0.2638397952780359, 
                    0.1645476800422746, 
                    0.24441808004425802, 
                    -0.13548365913632432, 
                    0.18599342094098664, 
                    -0.22279636496773708, 
                    -0.23147574629198292, 
                    -0.020166267270633198, 
                    0.11348855686093268, 
                    -0.1436739950230334, 
                    0.03826345043697782, 
                    0.24441808004425802, 
                    0.11541720256122096, 
                    -0.17457990126445627, 
                    0.12767073093830805, 
                    -0.23147574629198292, 
                    0.1432373546555652, 
                    0.03826345043697782, 
                    -0.14546348981441018, 
                    -0.09945704427481855, 
                    -0.11296485316713067, 
                    -0.2465211959034417, 
                    0.251540218731064, 
                    0.251540218731064, 
                    0.06034995429815582, 
                    -0.2465211959034417, 
                    -0.2975423211381427, 
                    0.17740415463362835, 
                    0.26030122583433957, 
                    -0.13548365913632432, 
                    0.268767321135042, 
                    0.26030122583433957, 
                    0.26030122583433957, 
                    0.251540218731064, 
                    0.26030122583433957, 
                    0.1177730232112632, 
                    0.15070743874442027, 
                    -0.0640278933045173, 
                    0.17740415463362835, 
                    0.251540218731064, 
                    -0.12497835770657131, 
                    -0.03241979564772024, 
                    0.3104736020262501, 
                    -0.2975423211381427, 
                    0.17740415463362835, 
                    0.251540218731064, 
                    -0.29637043512456096, 
                    -0.0250537079703948, 
                    -0.23147574629198292, 
                    -0.18084633984999843, 
                    -0.014161682746317406, 
                    -0.03882228346799138, 
                    -0.2975423211381427, 
                    0.15070743874442027, 
                    0.079114977584528845, 
                    0.18300528976082253, 
                    0.3104736020262501, 
                    -0.019098951488422666, 
                    0.12767073093830805, 
                    -0.04719503829446442, 
                    -0.04173372866939301, 
                    -0.07156806136362862, 
                    -0.14543184057407318, 
                    0.07650036280188527, 
                    -0.13317234844206868, 
                    0.26030122583433957, 
                    -0.2465211959034417, 
                    -0.1689093986080255, 
                    0.10234835283331462, 
                    -0.08899861850492674, 
                    0.025149298707028034, 
                    -0.29637043512456096, 
                    -0.03241979564772024, 
                    0.20445103065953452, 
                    0.019513380506247124, 
                    0.09665217927484798, 
                    -0.18084633984999843, 
                    -0.01357307460144358, 
                    -0.2510944902660036, 
                    -0.22869418951883555, 
                    -0.1684703462155745, 
                    -0.16232637288736917, 
                    0.251540218731064, 
                    0.26030122583433957, 
                    0.18803513603413435, 
                    0.04490393013383259, 
                    0.3104736020262501, 
                    -0.2465211959034417, 
                    -0.13548365913632432, 
                    -0.020166267270633198, 
                    -0.10601061582490429, 
                    -0.2975423211381427, 
                    0.1177730232112632, 
                    -0.23147574629198292, 
                    0.025149298707028034, 
                    0.23004494782657048, 
                    -0.22279636496773708, 
                    0.3104736020262501, 
                    -0.16192568267008062, 
                    0.23004494782657048, 
                    -0.22869418951883555, 
                    0.21612391685150556, 
                    -0.11296485316713067, 
                    -0.18084633984999843, 
                    -0.1596151684754989, 
                    -0.1339113995985678, 
                    0.3104736020262501, 
                    -0.03241979564772024, 
                    -0.05871558544888833, 
                    0.251540218731064, 
                    -0.2975423211381427, 
                    0.027508018303860238, 
                    0.3104736020262501, 
                    -0.08769919669754461, 
                    -0.04719503829446442, 
                    -0.15453698973873628, 
                    -0.237450379509832, 
                    0.03780150759605477, 
                    0.07035638947367989, 
                    0.251540218731064, 
                    0.0085146526423453, 
                    0.251540218731064, 
                    -0.1510336574460032, 
                    -0.22279636496773708, 
                    0.06828691864256436, 
                    -0.020166267270633198, 
                    0.18803513603413435, 
                    -0.09277284311690687, 
                    -0.09945704427481855, 
                    -0.20870457130839523, 
                    0.3104736020262501, 
                    0.20818695250709707, 
                    0.15843773912966347, 
                    -0.03241979564772024, 
                    -0.2975423211381427, 
                    -0.237450379509832, 
                    -0.18084633984999843, 
                    -0.2465211959034417, 
                    -0.28596032042971486, 
                    -0.2879043398238586, 
                    -0.23147574629198292, 
                    0.22433736101082646, 
                    -0.22329253815489597, 
                    -0.10143212057693105, 
                    -0.04173372866939301, 
                    0.08522453263341051, 
                    -0.17189472175054035, 
                    -0.20202037015048363, 
                    -0.042564246653809534, 
                    -0.020166267270633198, 
                    0.20818695250709707, 
                    0.03826345043697782, 
                    -0.2029714628661864, 
                    -0.11296485316713067, 
                    0.2672118855367247, 
                    -0.14138148368742287, 
                    0.17740415463362835, 
                    -0.04384744228915771, 
                    0.049454292281949364, 
                    -0.21702609956935376, 
                    -0.020166267270633198, 
                    -0.2510944902660036, 
                    0.09665217927484798, 
                    -0.1652105205926287, 
                    -0.22329253815489597, 
                    0.20818695250709707, 
                    0.3104736020262501, 
                    0.17740415463362835, 
                    0.17982169187481345, 
                    -0.29637043512456096, 
                    -0.22329253815489597, 
                    0.15258581878879612, 
                    0.08522453263341051, 
                    -0.09945704427481855, 
                    0.0085146526423453 
)
)

