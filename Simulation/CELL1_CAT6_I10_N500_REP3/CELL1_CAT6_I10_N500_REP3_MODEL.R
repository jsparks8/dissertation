model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.128247, 1);
tau[1,3] ~ dlnorm(0.004152, 1);
tau[1,4] ~ dlnorm(-0.137552, 1);
tau[1,5] ~ dlnorm(-0.302706, 1);
tau[1,6] ~ dlnorm(-0.500637, 1);
tau[2,2] ~ dlnorm(0.258826, 1);
tau[2,3] ~ dlnorm(0.139093, 1);
tau[2,4] ~ dlnorm(0.003048, 1);
tau[2,5] ~ dlnorm(-0.154463, 1);
tau[2,6] ~ dlnorm(-0.341509, 1);
tau[3,2] ~ dlnorm(0.136838, 1);
tau[3,3] ~ dlnorm(0.013049, 1);
tau[3,4] ~ dlnorm(-0.128257, 1);
tau[3,5] ~ dlnorm(-0.292869, 1);
tau[3,6] ~ dlnorm(-0.490024, 1);
tau[4,2] ~ dlnorm(0.060927, 1);
tau[4,3] ~ dlnorm(-0.065656, 1);
tau[4,4] ~ dlnorm(-0.210618, 1);
tau[4,5] ~ dlnorm(-0.380214, 1);
tau[4,6] ~ dlnorm(-0.584568, 1);
tau[5,2] ~ dlnorm(-0.286107, 1);
tau[5,3] ~ dlnorm(-0.4287, 1);
tau[5,4] ~ dlnorm(-0.595062, 1);
tau[5,5] ~ dlnorm(-0.794733, 1);
tau[5,6] ~ dlnorm(-1.044479, 1);
tau[6,2] ~ dlnorm(-0.304605, 1);
tau[6,3] ~ dlnorm(-0.448226, 1);
tau[6,4] ~ dlnorm(-0.615989, 1);
tau[6,5] ~ dlnorm(-0.817686, 1);
tau[6,6] ~ dlnorm(-1.070614, 1);
tau[7,2] ~ dlnorm(-0.032114, 1);
tau[7,3] ~ dlnorm(-0.162437, 1);
tau[7,4] ~ dlnorm(-0.312326, 1);
tau[7,5] ~ dlnorm(-0.488711, 1);
tau[7,6] ~ dlnorm(-0.703016, 1);
tau[8,2] ~ dlnorm(-0.074064, 1);
tau[8,3] ~ dlnorm(-0.206195, 1);
tau[8,4] ~ dlnorm(-0.358483, 1);
tau[8,5] ~ dlnorm(-0.538201, 1);
tau[8,6] ~ dlnorm(-0.757453, 1);
tau[9,2] ~ dlnorm(0.041525, 1);
tau[9,3] ~ dlnorm(-0.085809, 1);
tau[9,4] ~ dlnorm(-0.231755, 1);
tau[9,5] ~ dlnorm(-0.402703, 1);
tau[9,6] ~ dlnorm(-0.609024, 1);
tau[10,2] ~ dlnorm(0.218801, 1);
tau[10,3] ~ dlnorm(0.097793, 1);
tau[10,4] ~ dlnorm(-0.0399, 1);
tau[10,5] ~ dlnorm(-0.199627, 1);
tau[10,6] ~ dlnorm(-0.389808, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.2368885568579424, 
                    1.6208050891489827, 
                    1.260637418637019, 
                    1.0577033220992167, 
                    0.30321584235387167, 
                    0.2698844708977026, 
                    -0.8290985621717575, 
                    -0.7327795633927319, 
                    -1.008260774724632, 
                    -1.497756864275873 ),
tau=matrix(c( NA,1.8743211072202588,1.6555815709224981,1.4368420346247375,1.2181024983269768,0.9993629620292162, 
                    NA,2.1357682657104577,1.8947615705398164,1.6537548753691753,1.4127481801985342,1.171741485027893, 
                    NA,1.89049408209181,1.6703771118108628,1.4502601415299157,1.2301431712489685,1.0100262009680214, 
                    NA,1.7522959623495666,1.543949169667812,1.3356023769860574,1.1272555843043028,0.9189087916225482, 
                    NA,1.2384899886429865,1.073903469786462,0.9093169509299375,0.7447304320734129,0.5801439132168884, 
                    NA,1.2157913246813354,1.0531380253692686,0.890484726057202,0.7278314267451352,0.5651781274330685, 
                    NA,1.5966161208389666,1.4015284042330047,1.2064406876270428,1.011352971021081,0.816265254415119, 
                    NA,1.5310228826704506,1.3415216679936721,1.1520204533168936,0.9625192386401151,0.7730180239633366, 
                    NA,1.7186255875874743,1.5131464626534457,1.307667337719417,1.1021882127853884,0.8967090878513597, 
                    NA,2.0519724245718702,1.8181025264438693,1.5842326283158685,1.3503627301878678,1.116492832059867 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 0.013403170562841127, 
                    -0.6147979767318439, 
                    -0.19522063887827018, 
                    0.7881396557779434, 
                    -0.5677592440418068, 
                    0.16518746272434126, 
                    -0.0451749769877543, 
                    -0.5094724566350156, 
                    0.579084685537101, 
                    0.37882243861231024, 
                    -0.41996666128560745, 
                    0.03313994456636116, 
                    0.482286729267579, 
                    0.6585214393229246, 
                    0.0781415734554115, 
                    0.25041992497090926, 
                    0.21311398826072236, 
                    -0.34369552341205223, 
                    -0.4938495044883207, 
                    -0.41097304037848337, 
                    -0.5352411874331409, 
                    -0.29515191424978565, 
                    -0.5398562152498773, 
                    -0.4357062510103126, 
                    -0.3414552566319715, 
                    0.3344326182562366, 
                    -0.3820556742177016, 
                    -0.39297814703531786, 
                    0.4320904215953767, 
                    -0.36773580547197376, 
                    0.5586813205019086, 
                    0.021103234484093014, 
                    0.12863730053154987, 
                    0.11205332203450946, 
                    -0.22630931530076576, 
                    -0.2514919712426946, 
                    -0.4873013678645014, 
                    -0.17208579555226217, 
                    -0.40720221331822004, 
                    0.7743530191290979, 
                    0.35176202143664326, 
                    0.13901246449337556, 
                    0.01743337025348146, 
                    0.18484474665398254, 
                    -0.511563102689148, 
                    -0.3623653657271926, 
                    0.5830051251557291, 
                    -0.5677592440418068, 
                    -0.25153443797239633, 
                    -0.1384455679323306, 
                    0.27301951720892725, 
                    -0.3176594446233133, 
                    -0.607144384394704, 
                    -0.3715192449496089, 
                    -0.5408662568091552, 
                    0.3041738101113476, 
                    -0.5327857552624078, 
                    -0.2303312545716848, 
                    -0.20012113480571375, 
                    0.3787308518971457, 
                    0.012762132551461858, 
                    -0.4579982137444941, 
                    -0.09991171577794, 
                    -0.585308561810859, 
                    0.2236899013580148, 
                    0.3636662185001115, 
                    0.25422822633802145, 
                    0.8220506277119453, 
                    0.15046424836388028, 
                    -0.49992926837729823, 
                    -0.0911941520867734, 
                    -0.08793900453621262, 
                    -0.4411766309532752, 
                    -0.17735465100507009, 
                    0.5924294603807627, 
                    0.1431973230510083, 
                    0.05661672553689334, 
                    0.04253975691579548, 
                    0.4742869208266034, 
                    -0.4011309680608187, 
                    0.1653017941385685, 
                    0.5181504257085612, 
                    0.11419272441177897, 
                    -0.0682611022413534, 
                    -0.03686383645354052, 
                    0.23681838391442667, 
                    0.6879194958501191, 
                    -0.43797714606725807, 
                    -0.3326086280990666, 
                    -0.1491643485808859, 
                    -0.25168742063187266, 
                    -0.042866664257819154, 
                    0.24743247658146583, 
                    0.76064514506416, 
                    -0.5667045842330743, 
                    -0.4430812807507706, 
                    -0.43172783129721215, 
                    0.06948664821523909, 
                    0.28601333234989157, 
                    0.13533865578625448, 
                    0.2765606563986067, 
                    -0.006175109342466789, 
                    0.8040116816744391, 
                    0.7721849333364095, 
                    -0.361372433245207, 
                    0.26874406095117653, 
                    0.220670796758752, 
                    0.7273418078682801, 
                    0.027147753552526077, 
                    0.23191344206268083, 
                    0.48232732437219505, 
                    0.322461044866049, 
                    -0.5675230994897394, 
                    0.398255628503309, 
                    -0.2449045958246996, 
                    0.8378760052590748, 
                    0.2042080339603346, 
                    0.6388167714506392, 
                    -0.1912282865916246, 
                    0.6360915529174007, 
                    -0.06347144502199364, 
                    0.1875459216334564, 
                    0.4767679291639926, 
                    0.6823495241030468, 
                    -0.38469310328389106, 
                    -0.1634575680899007, 
                    -0.6147979767318439, 
                    -0.27135987224634933, 
                    -0.0057852314488997525, 
                    0.042571168900053524, 
                    -0.26730769423812434, 
                    -0.5229443423716367, 
                    0.11774344520562086, 
                    0.8755107016671848, 
                    0.4841986846799682, 
                    -0.5318589972665739, 
                    0.03124808001704993, 
                    0.021333975503064817, 
                    0.6718811194776464, 
                    0.07471329856076725, 
                    0.4834880623818021, 
                    -0.3160979589226501, 
                    0.04466773513344835, 
                    0.047162861484470464, 
                    -0.6181193215173274, 
                    -0.32146074089354065, 
                    -0.3455908212119024, 
                    0.3944900491705168, 
                    -0.2849111783170572, 
                    0.634963853261292, 
                    -0.46149373238085817, 
                    -0.0713336388566751, 
                    -0.14597482917885124, 
                    0.21825400235150683, 
                    -0.3871453655022118, 
                    -0.14888649791377373, 
                    -0.009381462211274672, 
                    -0.1947264443741234, 
                    -0.5841975160956533, 
                    0.314109839515757, 
                    -0.42437974029142056, 
                    0.1899494016333766, 
                    -0.16435685562396735, 
                    0.7445350303370388, 
                    0.5329191384807541, 
                    -0.490908501124541, 
                    0.5684202916886381, 
                    0.12575086761046717, 
                    -0.5805098830614577, 
                    -0.32819638363953524, 
                    -0.042677560213812415, 
                    -0.48857935052482876, 
                    -0.36770248445962356, 
                    0.024078899300988832, 
                    0.4295375378065651, 
                    -0.5662022170499945, 
                    0.07633797923110319, 
                    -0.4316967572330501, 
                    -0.31260552239958594, 
                    0.7984853582732183, 
                    -0.4408643319884965, 
                    0.04074397478823666, 
                    0.6717275606613338, 
                    0.19429549803183654, 
                    -0.42724277481034245, 
                    -0.09678587888564694, 
                    -0.09062146289730222, 
                    -0.36568799108510713, 
                    0.6433288507834538, 
                    -0.5805098830614577, 
                    0.6066279173276061, 
                    0.015532574689418821, 
                    0.6957550504275578, 
                    -0.3625869957781816, 
                    0.11553905956625865, 
                    -0.4708113454608246, 
                    0.5106156302758327, 
                    0.13041772239923244, 
                    -0.2467722499991028, 
                    -0.37954998471930446, 
                    -0.2825949994226201, 
                    0.1993559458047811, 
                    -0.23383969073026367, 
                    -0.4752874902275154, 
                    0.23051891343032305, 
                    -0.031890572245603654, 
                    0.004580765968465128, 
                    -0.11242104078684756, 
                    0.7063313107165872, 
                    -0.4366970787512806, 
                    0.5062219004175164, 
                    -0.08686060742831359, 
                    0.1766061316380122, 
                    0.34210981472671875, 
                    -0.26725100047018024, 
                    0.3712985401725445, 
                    -0.12461870907414607, 
                    0.28143456674965395, 
                    -0.2662030815767492, 
                    0.28729089424263143, 
                    0.03710160787475991, 
                    -0.07960752209678701, 
                    -0.3673783704786617, 
                    -0.4151402936156993, 
                    -0.17967788110145833, 
                    -0.2600880784551875, 
                    -0.4099140347756379, 
                    -0.2127432138835041, 
                    0.2506179275081858, 
                    0.5951932781320781, 
                    0.15887795171568153, 
                    -0.418573673800659, 
                    0.4727819426558577, 
                    -0.40709903477410225, 
                    0.583051981345051, 
                    0.2607201834317191, 
                    0.2798476686015764, 
                    0.09844633642823963, 
                    -0.07343492173249477, 
                    -0.24299640823159457, 
                    -0.12337253773183832, 
                    -0.023963106351408636, 
                    -0.23245147951469558, 
                    -0.38292161806652303, 
                    -0.011953767880040433, 
                    0.5645862339647734, 
                    -0.4787787833026813, 
                    0.16368130729592933, 
                    -0.35406595770106714, 
                    -0.2197985795280165, 
                    0.6720458655412376, 
                    -0.3723208504277501, 
                    0.20597467507967004, 
                    -0.32121623213139283, 
                    0.528549898380061, 
                    -0.5189432769399233, 
                    0.36426150688525794, 
                    -0.3186013362603577, 
                    0.05275426775138181, 
                    0.6167135282242062, 
                    0.4845414685553844, 
                    -0.40640546536405775, 
                    -0.15761302437960883, 
                    0.07084297809192219, 
                    -0.3919911576474014, 
                    -0.12997514421382012, 
                    -0.301153605438917, 
                    -0.593172755370888, 
                    0.019848262587175314, 
                    0.5149661662039091, 
                    0.6716507758392347, 
                    -0.43860172854877605, 
                    -0.44184405891686646, 
                    -0.5016401195803164, 
                    0.5693032899542501, 
                    -0.5427381153246446, 
                    0.07332902973485445, 
                    -0.3199656506224822, 
                    0.07067727875849394, 
                    -0.5832637307481285, 
                    -0.22179307640293566, 
                    -0.5662022170499945, 
                    0.2989809734230895, 
                    0.34838923340585737, 
                    -0.08550773488986063, 
                    -0.4221016676918881, 
                    0.7546061730840721, 
                    0.22928616386300393, 
                    0.2781507648645756, 
                    -0.050713731301688214, 
                    -0.13784563830537622, 
                    -0.15731086596205318, 
                    0.12758843630806072, 
                    -0.528734181192558, 
                    0.25032219766530395, 
                    0.20739420093039374, 
                    -0.26969559325864695, 
                    -0.5408662568091552, 
                    -0.5170206471707182, 
                    -0.2955068303842823, 
                    -0.3836201140012017, 
                    0.38842975491164533, 
                    -0.5832637307481285, 
                    0.1833971377846555, 
                    0.19670077173831702, 
                    -0.2939916759742114, 
                    -0.4337044028278513, 
                    0.12836480491039215, 
                    -0.5920975498400438, 
                    -0.09931715340430758, 
                    -0.30757374294065826, 
                    -0.22055899518849947, 
                    0.28470147607788976, 
                    0.03274988426791947, 
                    0.6701659931934021, 
                    -0.3419596863235981, 
                    -0.018796745350466382, 
                    0.547873863612139, 
                    -0.07324292836068136, 
                    0.6327451655699643, 
                    -0.24028137129012017, 
                    0.23038699621332415, 
                    0.33828767337669496, 
                    -0.2941080628607742, 
                    0.22458029226214926, 
                    -0.5215262303730066, 
                    -0.17603845706413246, 
                    0.25216716485797774, 
                    0.31101565961465505, 
                    0.19730212051202456, 
                    0.1342697696959695, 
                    0.5734469539486275, 
                    0.6289357235314024, 
                    -0.16946452777220244, 
                    -0.0314591921046985, 
                    0.18031579020174593, 
                    0.2835276869454383, 
                    -0.5099218199678149, 
                    0.05226246035131343, 
                    -0.27568475496218636, 
                    -0.564353359100157, 
                    -0.4217935147435931, 
                    -0.3546065686711114, 
                    0.4514977717748807, 
                    -0.20304786216146747, 
                    0.5626841895438628, 
                    0.6347500179709824, 
                    0.19696055235137977, 
                    -0.607144384394704, 
                    -0.44528695447082356, 
                    0.11580909993028121, 
                    -0.20988872611961712, 
                    0.5716574710306164, 
                    -0.0932885846230892, 
                    0.14957841846272146, 
                    -0.34646825373042195, 
                    0.20589206078224165, 
                    0.03603860983331153, 
                    -0.2951571203443561, 
                    -0.39272002233689707, 
                    0.6276245560457829, 
                    0.4760134105872844, 
                    -0.5094784764970678, 
                    -0.5843626430126186, 
                    0.03960410849671947, 
                    -0.23863510635335933, 
                    -0.40093919996369976, 
                    -0.21022602021728343, 
                    -0.5397586028135978, 
                    0.34703941896497104, 
                    0.08912063781367163, 
                    0.7694853823951684, 
                    -0.166016900036838, 
                    0.05192174260115667, 
                    -0.36006994419869115, 
                    0.3502203099012767, 
                    0.19248693498028235, 
                    0.45463980063763954, 
                    0.03818061588035626, 
                    0.5557721732657639, 
                    0.515395821722513, 
                    -0.5098333986517162, 
                    -0.09572811866560482, 
                    -0.20217402936678336, 
                    0.594852135492572, 
                    -0.535983339363737, 
                    -0.41412143794912226, 
                    -0.1400316246063218, 
                    -0.36968194553098443, 
                    0.4503666716107444, 
                    0.7246849178499799, 
                    0.022996595625092597, 
                    0.4421461344938449, 
                    -0.5435570415928886, 
                    -0.1304123671946164, 
                    -0.31670711972456567, 
                    -0.22543449430930834, 
                    -0.4463643794326444, 
                    -0.056356096684788914, 
                    -0.23154146234646, 
                    0.7069880412047578, 
                    0.39157830995018394, 
                    -0.5107385558104012, 
                    0.7403496524315318, 
                    0.6801183486996913, 
                    0.615372747829857, 
                    -0.4659566307282945, 
                    0.5437431014310412, 
                    -0.44459072869823435, 
                    -0.4801693025150084, 
                    0.1317826141495494, 
                    0.20022066293781737, 
                    0.16634857561516148, 
                    -0.09802720380772423, 
                    0.553929920784344, 
                    0.08757795584837891, 
                    -0.4248055325756455, 
                    -0.4140634222240827, 
                    0.18462223537948763, 
                    0.2091111278043437, 
                    0.592284292277591, 
                    -0.1849404173647442, 
                    -0.03599077534220663, 
                    -0.032991145071114, 
                    0.7839960733935367, 
                    0.6262032157583457, 
                    -0.4201954382567641, 
                    0.24694199431852548, 
                    -0.46843211583348654, 
                    0.04256299115762918, 
                    -0.026685528078182474, 
                    -0.36900351248144203, 
                    0.35781687870764056, 
                    0.890915770345978, 
                    0.43104996607824586, 
                    0.7697515405848125, 
                    -0.21050332397865756, 
                    0.06899378718120275, 
                    0.22554338117649597, 
                    -0.35261854352899746, 
                    0.025025076765196386, 
                    -0.40533840641077035, 
                    0.3188122055045842, 
                    -0.16288488129754458, 
                    -0.19454547702632596, 
                    0.524504881414283, 
                    -0.3396748832152331, 
                    0.3321627567555785, 
                    -0.37596378902243, 
                    -0.44621768681881113, 
                    0.428840593680035, 
                    -0.20257236138508344, 
                    0.006477007689167702, 
                    -0.4323207255060366, 
                    -0.15317317292966953, 
                    -0.157729053867461, 
                    0.30404494356236944, 
                    -0.43155710541697634, 
                    0.208078648404752, 
                    -0.21898680543620114, 
                    0.15117070725620274, 
                    -0.4453597224981368, 
                    -0.37265678806765545, 
                    -0.585308561810859, 
                    -0.3767165504516843, 
                    -0.04017775911985755, 
                    -0.40373037671561696, 
                    -0.3920603317319227, 
                    -0.21871028176973867, 
                    -0.23793268893467678, 
                    -0.15815269200313364, 
                    0.10474089054053914, 
                    0.007381979436810626, 
                    -0.3063045996466083, 
                    -0.5252698285857959, 
                    0.225266565186666, 
                    0.3646939702469595, 
                    0.05146882969573541, 
                    -0.07726994288372757, 
                    -0.03377184659182331, 
                    -0.2032415650600471, 
                    -0.11861240631015457, 
                    -0.21217009336049902, 
                    0.18928551617854428, 
                    0.05519931327797656, 
                    0.03681095593084871, 
                    0.08343912856968849, 
                    0.5248970586176402, 
                    0.47749678402015694, 
                    0.14582204186634207, 
                    -0.3844974811553525, 
                    -0.09702107963505868, 
                    -0.1803899417718437, 
                    -0.5677592440418068, 
                    0.11799448008744484, 
                    0.7058850257288409, 
                    -0.43622087846283547, 
                    -0.2770089932973355, 
                    0.5987015206295192, 
                    0.23387229696813494 
)
)

