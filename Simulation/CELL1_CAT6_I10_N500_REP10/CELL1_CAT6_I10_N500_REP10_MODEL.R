model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.233709, 1);
tau[1,3] ~ dlnorm(0.113182, 1);
tau[1,4] ~ dlnorm(-0.023889, 1);
tau[1,5] ~ dlnorm(-0.182778, 1);
tau[1,6] ~ dlnorm(-0.371772, 1);
tau[2,2] ~ dlnorm(0.235155, 1);
tau[2,3] ~ dlnorm(0.114674, 1);
tau[2,4] ~ dlnorm(-0.022337, 1);
tau[2,5] ~ dlnorm(-0.181145, 1);
tau[2,6] ~ dlnorm(-0.370025, 1);
tau[3,2] ~ dlnorm(0.089052, 1);
tau[3,3] ~ dlnorm(-0.03647, 1);
tau[3,4] ~ dlnorm(-0.180041, 1);
tau[3,5] ~ dlnorm(-0.347736, 1);
tau[3,6] ~ dlnorm(-0.549334, 1);
tau[4,2] ~ dlnorm(-0.11597, 1);
tau[4,3] ~ dlnorm(-0.249988, 1);
tau[4,4] ~ dlnorm(-0.404789, 1);
tau[4,5] ~ dlnorm(-0.588022, 1);
tau[4,6] ~ dlnorm(-0.812534, 1);
tau[5,2] ~ dlnorm(-0.37561, 1);
tau[5,3] ~ dlnorm(-0.52337, 1);
tau[5,4] ~ dlnorm(-0.696811, 1);
tau[5,5] ~ dlnorm(-0.906781, 1);
tau[5,6] ~ dlnorm(-1.172886, 1);
tau[6,2] ~ dlnorm(-0.368646, 1);
tau[6,3] ~ dlnorm(-0.515986, 1);
tau[6,4] ~ dlnorm(-0.688849, 1);
tau[6,5] ~ dlnorm(-0.897971, 1);
tau[6,6] ~ dlnorm(-1.162712, 1);
tau[7,2] ~ dlnorm(0.05592, 1);
tau[7,3] ~ dlnorm(-0.070856, 1);
tau[7,4] ~ dlnorm(-0.216069, 1);
tau[7,5] ~ dlnorm(-0.386011, 1);
tau[7,6] ~ dlnorm(-0.590868, 1);
tau[8,2] ~ dlnorm(0.008881, 1);
tau[8,3] ~ dlnorm(-0.119749, 1);
tau[8,4] ~ dlnorm(-0.267403, 1);
tau[8,5] ~ dlnorm(-0.440699, 1);
tau[8,6] ~ dlnorm(-0.650455, 1);
tau[9,2] ~ dlnorm(0.062874, 1);
tau[9,3] ~ dlnorm(-0.063635, 1);
tau[9,4] ~ dlnorm(-0.208498, 1);
tau[9,5] ~ dlnorm(-0.377961, 1);
tau[9,6] ~ dlnorm(-0.582121, 1);
tau[10,2] ~ dlnorm(0.039683, 1);
tau[10,3] ~ dlnorm(-0.087723, 1);
tau[10,4] ~ dlnorm(-0.233764, 1);
tau[10,5] ~ dlnorm(-0.404841, 1);
tau[10,6] ~ dlnorm(-0.611352, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.5430118877582046, 
                    1.5474383780108325, 
                    1.131099347730708, 
                    0.6405141917306721, 
                    0.14751429453934994, 
                    0.1591350190650912, 
                    -1.0448514573517014, 
                    -0.9272090381453582, 
                    -1.0627190371588915, 
                    -1.003616451325883 ),
tau=matrix(c( NA,2.082791095563338,1.8462964060733618,1.6098017165833858,1.3733070270934098,1.1368123376034338, 
                    NA,2.0858055354253775,1.8490541095007489,1.6123026835761205,1.375551257651492,1.1387998317268637, 
                    NA,1.802278655804612,1.5896748936362308,1.3770711314678499,1.164467369299469,0.9518636071310878, 
                    NA,1.4681901645685878,1.2840403414482089,1.0998905183278298,0.9157406952074508,0.7315908720870719, 
                    NA,1.1324572345812975,0.9769014054980152,0.8213455764147328,0.6657897473314505,0.5102339182481681, 
                    NA,1.140370947983327,0.9841411168775518,0.8279112857717765,0.6716814546660013,0.515451623560226, 
                    NA,1.7435438424565084,1.5359424579301098,1.328341073403711,1.1207396888773125,0.9131383043509138, 
                    NA,1.663429354976989,1.4626512307645583,1.2618731065521274,1.0610949823396965,0.8603168581272658, 
                    NA,1.7557116643052053,1.5470739601499894,1.3384362559947738,1.1297985518395581,0.9211608476843423, 
                    NA,1.7154628033529262,1.510253049176025,1.3050432949991237,1.0998335408222224,0.8946237866453213 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.17915166743814226, 
                    0.7534853662564235, 
                    -0.5258089481892815, 
                    -0.07170430207489142, 
                    -0.4852825299451017, 
                    0.17074724567768462, 
                    -0.33070421656621946, 
                    -0.09072685729349383, 
                    -0.047211449721148546, 
                    0.6891102357611948, 
                    -0.37209141463889617, 
                    -0.2789668114512244, 
                    -0.5838092162239308, 
                    -0.027399579616348757, 
                    0.20916795822777356, 
                    -0.1796957657316659, 
                    -0.3483627575355373, 
                    0.28719730337046756, 
                    -0.4635038568992664, 
                    0.7193106568946778, 
                    0.6335237297878867, 
                    -0.17752881092621464, 
                    -0.3220020744487709, 
                    0.15223683672841504, 
                    -0.5950476484452635, 
                    -0.16883429605921174, 
                    0.35175130809165656, 
                    0.04892238903325352, 
                    -0.22427563972824738, 
                    -0.5942305997846927, 
                    0.12636436533608486, 
                    -0.2366842437674686, 
                    -0.31294145900423864, 
                    -0.1977147148838197, 
                    -0.4718908175753969, 
                    0.12908854154182725, 
                    0.6300689091119639, 
                    0.5629532427965894, 
                    0.08773436658591416, 
                    0.21204567329714907, 
                    -0.5284407348582847, 
                    -0.3907123840062361, 
                    -0.22489874448951275, 
                    -0.10935451054615863, 
                    -0.5485720774301603, 
                    -0.570687924195637, 
                    -0.36922682030719894, 
                    -0.4677844539689262, 
                    -0.07101749116273104, 
                    -0.4614905176317608, 
                    0.40107420933975024, 
                    -0.41493106453347384, 
                    -0.33837167050172834, 
                    -0.21549701839835395, 
                    0.4874339643381872, 
                    -0.29222133297056047, 
                    -0.17387076444234767, 
                    -0.4391001905829357, 
                    -0.3314507601158276, 
                    -0.19343430980561427, 
                    0.04825964460580934, 
                    -0.1377415384619698, 
                    -0.089471843092233, 
                    -0.5191186129251417, 
                    0.4983409675617988, 
                    -0.04989588798217326, 
                    -0.08470249988299472, 
                    0.006845221907546772, 
                    0.2717113475677335, 
                    0.24196673339521357, 
                    -0.1497412707414636, 
                    -0.3601801825850229, 
                    -0.5860941709828658, 
                    -0.019706518094260717, 
                    -0.23591619123584784, 
                    0.3508696463403316, 
                    0.22520985610540623, 
                    -0.4293797353197001, 
                    -0.40115611316458955, 
                    -0.14693086101019154, 
                    0.6086629262961202, 
                    -0.03911969397135262, 
                    -0.24403868281490393, 
                    0.7907557136406375, 
                    0.5889430573360969, 
                    0.8382598901129107, 
                    -0.07380751167203092, 
                    0.049794861952782044, 
                    -0.14522706544002295, 
                    -0.45367302016025735, 
                    0.4284996781733118, 
                    0.6416777005610538, 
                    0.24776237652103528, 
                    -0.17742139993906603, 
                    -0.11768174241446883, 
                    0.009598871047647228, 
                    -0.2013605611751444, 
                    0.05771818567093223, 
                    -0.32372209044742234, 
                    -0.3305456876819804, 
                    -0.3357606542111908, 
                    0.030266772548155907, 
                    -0.40663730503593304, 
                    0.7061195832266128, 
                    -0.13867331524798332, 
                    -0.3738504108180656, 
                    0.08705869771378172, 
                    -0.20353913614678637, 
                    -0.35030097113037995, 
                    -0.261975311219947, 
                    -0.15981526638840032, 
                    -0.2574397707955918, 
                    -0.528625318274349, 
                    -0.1567177571264915, 
                    -0.011203550421024389, 
                    0.7356826989123194, 
                    0.5680751335355158, 
                    0.7069924903222745, 
                    0.4323923865064031, 
                    0.13021971700071466, 
                    0.39809015476403464, 
                    -0.4575206844528621, 
                    0.002060098602083671, 
                    -0.09700969955798466, 
                    -0.25861012469631833, 
                    0.24814576774249075, 
                    -0.3362745652370614, 
                    -0.08647962656726849, 
                    -0.5942500308224956, 
                    0.2603061240529895, 
                    -0.179687301578222, 
                    -0.491915031017696, 
                    0.7626109802891315, 
                    -0.42563650694072014, 
                    -0.48746063449498267, 
                    -0.23975263913873096, 
                    -0.4126999951006229, 
                    0.47522949270564896, 
                    0.4069517026613291, 
                    0.6930012646588838, 
                    0.7421077574308054, 
                    0.5785615552869413, 
                    -0.002130949372574964, 
                    0.22111538457164537, 
                    -0.2491386536756165, 
                    -0.13574051480810534, 
                    -0.3398341249396915, 
                    -0.43219360026941533, 
                    0.671246234369408, 
                    0.5200706215264764, 
                    0.3612096580378561, 
                    0.4622709935182615, 
                    0.09226482840690342, 
                    -0.3792032221195235, 
                    0.5226932845403581, 
                    -0.2659959952753475, 
                    -0.38474665257919016, 
                    -0.3414713842155979, 
                    -0.6061414239411693, 
                    -0.5707191752997681, 
                    0.006832063039214353, 
                    0.6867748286341907, 
                    0.6275166360610939, 
                    -0.007669408978505099, 
                    -0.2457478529886457, 
                    0.07086406075947771, 
                    0.023047949195555195, 
                    -0.3874820354555625, 
                    0.1888496939506782, 
                    0.015403779576746213, 
                    -0.25451770680025726, 
                    -0.10411557968972296, 
                    0.2725008581764262, 
                    -0.10833616283338154, 
                    0.6053231266247946, 
                    -0.5010653128884625, 
                    0.4471163712698786, 
                    0.46031188871949336, 
                    0.27202701486762837, 
                    -0.562907613468413, 
                    0.07815010893870034, 
                    -0.18650096343462036, 
                    -0.2952714533809908, 
                    0.17916599453548898, 
                    -0.4464287047585014, 
                    -0.47661471641809616, 
                    -0.15916304841845796, 
                    -0.1659326739478456, 
                    -0.20559927084756185, 
                    0.6435743846251168, 
                    -0.17676100493037833, 
                    -0.0717213337165038, 
                    -0.10128729605516396, 
                    -0.5509858595248336, 
                    -0.18592524700405927, 
                    -0.037799796483889536, 
                    -0.1422771798891343, 
                    -0.18219106420714748, 
                    -0.018389431322431538, 
                    0.053716622649753965, 
                    0.668484468324155, 
                    0.023086611034527804, 
                    -0.5399933217501585, 
                    0.7245518221109778, 
                    0.01587389019129648, 
                    -0.3455448862077679, 
                    -0.053952480776280676, 
                    0.8456510216027923, 
                    -0.29102059957893434, 
                    0.07405705725822953, 
                    -0.30990403438256753, 
                    0.15901503337189937, 
                    -0.10606123952853264, 
                    -0.1149307878405571, 
                    -0.5935882686074145, 
                    -0.4784504211153512, 
                    -0.41249916669813497, 
                    -0.3104407167438707, 
                    -0.46618256301375843, 
                    -0.2036060704695059, 
                    -0.3282366272700798, 
                    -0.32271508026649887, 
                    -0.3534450048336119, 
                    -0.5159349448143254, 
                    0.12251534377613693, 
                    0.5568482269025977, 
                    0.5380558958092617, 
                    -0.0928622495915018, 
                    0.6759807972166226, 
                    -0.282594215407806, 
                    -0.22466997902320535, 
                    0.6551122145417053, 
                    0.5986236934183661, 
                    0.7995764219891307, 
                    0.6031317229977963, 
                    -0.539464379469424, 
                    -0.3193584097011343, 
                    -0.25731561762907906, 
                    -0.46306734915406866, 
                    -0.5398639659433258, 
                    -0.24704615444265027, 
                    -0.3264011057420173, 
                    -0.02182979564678078, 
                    -0.24782563789338163, 
                    0.14611522541433275, 
                    0.23991158763981524, 
                    0.05739368913266907, 
                    -0.04875896397596147, 
                    0.03151287262086366, 
                    0.2825697029052512, 
                    0.8194818790290938, 
                    0.16743611877957754, 
                    0.18843312739368434, 
                    -0.29046606339512865, 
                    0.1178848113101737, 
                    0.3152008527247959, 
                    0.2982765849132789, 
                    -0.09881635879093287, 
                    -0.5292634461246057, 
                    0.4600171640463152, 
                    0.14907131895651393, 
                    0.17399152196410383, 
                    0.17814974646364146, 
                    -0.2705498892728121, 
                    0.13289017755562815, 
                    0.3666206530103725, 
                    0.45815848983675134, 
                    -0.4876392880730911, 
                    -0.10103640980723727, 
                    -0.22050671155139934, 
                    -0.13399016226148885, 
                    0.38876464679988343, 
                    -0.6118156176994608, 
                    -0.3186749345519002, 
                    0.3755722052659459, 
                    -0.11784717817799217, 
                    -0.07070460366061226, 
                    0.339742033621226, 
                    -0.45167352658272375, 
                    -0.04187777886540944, 
                    0.19866117779987247, 
                    -0.3938884863189125, 
                    -0.1624935912335586, 
                    -0.37658541827693315, 
                    -0.38237132260121715, 
                    0.4602754889136639, 
                    0.8258563562995768, 
                    -0.3121898002872938, 
                    0.28157715355318, 
                    -0.25645817304951746, 
                    -0.6145444538844796, 
                    -0.1042658362208041, 
                    0.22987834915063265, 
                    -0.185733984431871, 
                    0.3214577238537485, 
                    -0.49504976642064585, 
                    -0.4977534995761391, 
                    -0.24093117669451497, 
                    -0.4301169766983862, 
                    -0.23467564788714673, 
                    -0.13278954563589357, 
                    0.03945643448960501, 
                    0.7067997461373806, 
                    0.6044224266213881, 
                    0.556382848220455, 
                    0.08836228976435812, 
                    0.24729734768116973, 
                    -0.3147823427049404, 
                    0.03490877440931506, 
                    0.0692553529874329, 
                    -0.039358475808439985, 
                    -0.2959858291339334, 
                    0.34213105120576137, 
                    -0.07513522863261135, 
                    0.25399212293221374, 
                    0.6656009215414002, 
                    -0.013502904833899265, 
                    -0.2668324253320421, 
                    -0.26771662478098834, 
                    0.0738369429577217, 
                    -0.06730244971424804, 
                    0.1434359856915699, 
                    -0.031066963638797462, 
                    -0.3569226027254044, 
                    0.30727537134228566, 
                    0.6559853702520647, 
                    -0.4404360389377889, 
                    -0.35380950802877326, 
                    -0.4533312341447943, 
                    0.058897969077857604, 
                    -0.1386461708045471, 
                    -0.18249175990821298, 
                    0.4090472583054433, 
                    0.2477201679488943, 
                    -0.12012702018984056, 
                    0.3512212430923707, 
                    -0.054130785822866456, 
                    -0.3604226651732291, 
                    -0.2303035578706027, 
                    0.08226913556594839, 
                    -0.12336042707814687, 
                    0.4643360409802887, 
                    -0.5477283874402069, 
                    -0.3891842528239914, 
                    -0.4066108984408586, 
                    0.3487698010544542, 
                    0.03649578881980409, 
                    0.6405509046433241, 
                    -0.18046801453120753, 
                    0.6783482946302365, 
                    0.23199955831646957, 
                    0.03820487821038032, 
                    -0.11216040697730045, 
                    0.6265202489884586, 
                    0.314496834994914, 
                    -0.26153159359303596, 
                    -0.42900895862753063, 
                    0.29188289200076933, 
                    0.5791154779109654, 
                    -0.05000571624969807, 
                    -0.4853056129834768, 
                    0.42983643654517467, 
                    -0.1452685340958264, 
                    0.46143424196692606, 
                    0.3233524157203004, 
                    0.2458869654264615, 
                    0.010127255101491373, 
                    0.7606119360502367, 
                    0.6880362283732805, 
                    0.20776071297202292, 
                    -0.02839301667763816, 
                    0.6948714700354052, 
                    -0.28378538761636685, 
                    -0.1547796849323994, 
                    -0.12809776070112316, 
                    -0.5551229944074185, 
                    0.812932086973699, 
                    -0.2469041340224878, 
                    0.454833587085664, 
                    0.1368523740704396, 
                    -0.1865566726211949, 
                    -0.3256234461156176, 
                    -0.17834705839690324, 
                    0.2967539250130812, 
                    0.37117192842832203, 
                    -0.16174780145234086, 
                    -0.07777631074720259, 
                    -0.4409584803653773, 
                    0.17973725518632777, 
                    0.5353741186377404, 
                    -0.10613547131840251, 
                    0.7063532284902142, 
                    0.4096503523488143, 
                    0.42809505344326315, 
                    -0.15162960939704445, 
                    -0.10910498984264716, 
                    -0.24483906880139245, 
                    -0.44610021068966477, 
                    0.6979184921724196, 
                    -0.060875020185200635, 
                    -0.24015289300331683, 
                    0.4100108016186744, 
                    0.8044707219262418, 
                    0.7077306730487049, 
                    -0.2099498487204321, 
                    -0.1577127913199472, 
                    0.27910309729744576, 
                    0.5107505550000254, 
                    0.056042498138134555, 
                    -0.14777338399113243, 
                    0.7024199525859293, 
                    -0.01083829735614028, 
                    -0.4263661773906589, 
                    -0.48692471109366053, 
                    -0.32210046337352094, 
                    0.13820228455276695, 
                    0.6519601115645252, 
                    -0.5709206867604599, 
                    0.35315574607766975, 
                    -0.5860941709828658, 
                    0.495609821990329, 
                    0.16386328685080465, 
                    0.21232326033326443, 
                    0.10445225232232369, 
                    -2.789721198391826e-4, 
                    0.07141942652035815, 
                    0.001523002975038823, 
                    0.3072467281445852, 
                    -0.1562514349330713, 
                    0.0851564712788706, 
                    0.32982889933872217, 
                    0.5058528643963894, 
                    0.14576852516319194, 
                    -0.45698479014100996, 
                    0.3105849335224824, 
                    0.3225792677965793, 
                    0.377473817906812, 
                    -0.36911226433094596, 
                    0.023460597647833703, 
                    0.44246458700419933, 
                    0.007206135364489774, 
                    3.2562001174529787e-4, 
                    -0.08564699085364447, 
                    -0.08267005841902164, 
                    0.5997473536090888, 
                    0.22757568929745475, 
                    0.19366791318954657, 
                    -0.4375131881572464, 
                    -0.4330977216791749, 
                    0.33117302480095934, 
                    0.3513344228197065, 
                    0.12170491579137166, 
                    -0.38859649507788185, 
                    -0.5318800514600658, 
                    -0.24262747121384748, 
                    -0.4931942802663941, 
                    0.3833024299581764, 
                    0.2451446455157933, 
                    -0.282797067137042, 
                    -0.21728902313691262, 
                    0.5238244031156815, 
                    0.7766740757013705, 
                    0.459532971581358, 
                    0.7458694990072784, 
                    0.12697846536937163, 
                    0.23946877784756848, 
                    -0.4337911322262767, 
                    -0.41078480911043624, 
                    -0.43571295203091426, 
                    -0.04834870687623272, 
                    -0.2600466287027333, 
                    0.445805231335617, 
                    0.39659306315154297, 
                    -0.2943835941727204, 
                    -0.513318748027166, 
                    -0.257242952895948, 
                    -0.20315103701067405, 
                    -0.4694922474359551, 
                    0.18513738590033835, 
                    -0.548924220597607, 
                    -0.14708328144650007, 
                    -0.1734753393806533, 
                    0.7084936281735194, 
                    -0.2846021995323341, 
                    -0.563159325086693, 
                    -0.09809990710491101, 
                    0.19592545588140375, 
                    -0.4497511101132145, 
                    -0.07600400750378256, 
                    0.16472162179454142, 
                    -0.39032183974724155, 
                    0.05435923403733367, 
                    -0.295191706155681, 
                    0.3982042818691499, 
                    0.5912817328458088, 
                    -0.31157173034116903, 
                    -0.37709227895183717, 
                    0.20155219137965485, 
                    0.3605483067848413, 
                    0.5123023215615169 
)
)

