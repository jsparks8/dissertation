model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.128826, 1);
tau[2,2] ~ dlnorm(-0.125506, 1);
tau[3,2] ~ dlnorm(-0.130701, 1);
tau[4,2] ~ dlnorm(-0.358789, 1);
tau[5,2] ~ dlnorm(-0.190089, 1);
tau[6,2] ~ dlnorm(-0.141511, 1);
tau[7,2] ~ dlnorm(-0.43688, 1);
tau[8,2] ~ dlnorm(-0.450205, 1);
tau[9,2] ~ dlnorm(-0.511683, 1);
tau[10,2] ~ dlnorm(-0.16307, 1);
tau[11,2] ~ dlnorm(-0.17723, 1);
tau[12,2] ~ dlnorm(-0.429269, 1);
tau[13,2] ~ dlnorm(-0.482317, 1);
tau[14,2] ~ dlnorm(-0.501429, 1);
tau[15,2] ~ dlnorm(-0.508082, 1);
tau[16,2] ~ dlnorm(-0.487542, 1);
tau[17,2] ~ dlnorm(-0.580288, 1);
tau[18,2] ~ dlnorm(-0.685924, 1);
tau[19,2] ~ dlnorm(-0.253468, 1);
tau[20,2] ~ dlnorm(-0.254387, 1);
tau[21,2] ~ dlnorm(-0.24631, 1);
tau[22,2] ~ dlnorm(-0.328243, 1);
tau[23,2] ~ dlnorm(-0.383301, 1);
tau[24,2] ~ dlnorm(-0.404883, 1);
tau[25,2] ~ dlnorm(-0.193532, 1);
tau[26,2] ~ dlnorm(-0.066581, 1);
tau[27,2] ~ dlnorm(-0.055626, 1);
tau[28,2] ~ dlnorm(-0.159595, 1);
tau[29,2] ~ dlnorm(-0.232465, 1);
tau[30,2] ~ dlnorm(-0.202715, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.4107676287244395, 
                    -1.4215038579371009, 
                    -1.4047205708148796, 
                    -0.7475902517320021, 
                    -1.2189402374953895, 
                    -1.3700791612067702, 
                    -0.5549108954555739, 
                    -0.5235096866695074, 
                    -0.38393163330583824, 
                    -1.302096032513786, 
                    -1.2582350033130472, 
                    -0.5730337073722918, 
                    -0.4495329086449591, 
                    -0.40661952923723316, 
                    -0.39187172633687417, 
                    -0.4377201540395892, 
                    -0.23797440430295622, 
                    -0.03193069770669271, 
                    1.0324726136421032, 
                    1.029854532849904, 
                    1.052945386137838, 
                    0.8271482140558398, 
                    0.6854813349474231, 
                    0.6320426103941211, 
                    1.2085020453654738, 
                    1.6180883407690345, 
                    1.6559313684991883, 
                    1.3129549777677787, 
                    1.0929594598779295, 
                    1.1808437363352873 ),
tau=matrix(c( NA,1.4494346652972734, 
                    NA,1.4542552322137583, 
                    NA,1.446719536295881, 
                    NA,1.151668023027669, 
                    NA,1.36330416663543, 
                    NA,1.43116554338184, 
                    NA,1.0651549920595527, 
                    NA,1.051055849314609, 
                    NA,0.9883853033543215, 
                    NA,1.40064111859869, 
                    NA,1.3809475164875582, 
                    NA,1.073292134610159, 
                    NA,1.0178402759815868, 
                    NA,0.9985721686275177, 
                    NA,0.9919504051252566, 
                    NA,1.0125363491637756, 
                    NA,0.9228505075320275, 
                    NA,0.8303368832703051, 
                    NA,1.2795802035253043, 
                    NA,1.278404685249607, 
                    NA,1.2887724783758894, 
                    NA,1.1873895481110721, 
                    NA,1.1237811193913931, 
                    NA,1.0997871320669605, 
                    NA,1.3586174183690978, 
                    NA,1.5425216650052964, 
                    NA,1.5595131844561356, 
                    NA,1.4055167850177326, 
                    NA,1.3067387974851905, 
                    NA,1.3461988376145442 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 -0.29580855054861993, 
                    0.2164010309271307, 
                    0.25638742706010365, 
                    0.15422790789148277, 
                    0.2768935955643812, 
                    -0.308691955540658, 
                    -0.15575566563621496, 
                    0.2695809835026961, 
                    -0.1340002760598775, 
                    -0.10903710249822257, 
                    0.03650938034177459, 
                    0.07987106397389926, 
                    0.14894335235988143, 
                    -0.22607798071956584, 
                    0.07921597183013279, 
                    0.13897010388491182, 
                    -0.04685510989394448, 
                    0.15364249425932797, 
                    0.1480114877989812, 
                    0.1510050071165825, 
                    -0.12289420066766088, 
                    -0.17837560098963798, 
                    -0.06266173820144835, 
                    0.08778073687414628, 
                    0.1917393189630967, 
                    -0.0647369100797893, 
                    -0.27149875700756354, 
                    0.172236034212168, 
                    0.16346727361824565, 
                    0.07041444617572062, 
                    -0.27084173966312053, 
                    0.11942715719875102, 
                    -0.04435209531065587, 
                    0.20950717653722395, 
                    -0.11236390800258603, 
                    0.07956254805177082, 
                    0.09493632833082599, 
                    -0.11500317170057539, 
                    -0.12118168677977009, 
                    0.10107935176536048, 
                    0.1748767303121837, 
                    -0.28117767900579843, 
                    0.04040809738841361, 
                    -0.017575184705688307, 
                    -0.1079760698435121, 
                    0.2007411919045955, 
                    -0.23189611749242722, 
                    0.1780722349941713, 
                    0.11994726237697967, 
                    0.03959426926540538, 
                    0.14556188236115508, 
                    0.18753928800116043, 
                    0.013748115008007378, 
                    -0.14644027769679357, 
                    0.1361640857621595, 
                    0.08848092704016602, 
                    0.15071712330245146, 
                    -0.2824955728404355, 
                    -0.10389387486228288, 
                    0.1610656185084141, 
                    -0.17914533652396636, 
                    0.24382556670796973, 
                    -0.14202273973802573, 
                    0.21655425641243986, 
                    -0.30283429199942263, 
                    0.10329591898477636, 
                    0.26469230732207083, 
                    -0.21769586178245368, 
                    0.2631026321317451, 
                    0.22270628492156963, 
                    -0.209581233909538, 
                    0.007086000201276865, 
                    -0.12298341729858475, 
                    -0.17109195089040952, 
                    -0.20084570595125195, 
                    -0.3088104685901852, 
                    0.21029568413072552, 
                    -0.041122182161854426, 
                    -0.18296220085498535, 
                    0.0575433756695769, 
                    -0.019345443188718503, 
                    -0.13637327279571054, 
                    0.16856055058827685, 
                    0.05278952347744431, 
                    0.15746298147797272, 
                    -0.018831290558226854, 
                    0.14640704194392984, 
                    -0.1387368086808571, 
                    -0.26140833882526315, 
                    -0.18037322736181716, 
                    0.2136837308649291, 
                    0.24245029108159166, 
                    0.010373910102218276, 
                    0.2820200377962252, 
                    -0.033692725614088204, 
                    0.19545043031509968, 
                    -0.1763527368485301, 
                    0.1310402610887339, 
                    -0.13526054929192108, 
                    -0.025432614060245717, 
                    -0.21103857226918976, 
                    0.07934185010347222, 
                    0.0044916827370922174, 
                    -0.08978657490180561, 
                    0.288975605354329, 
                    -0.24262724996990082, 
                    0.25544685717577875, 
                    -0.06874055680812105, 
                    0.04806548842650177, 
                    -0.27525437179224804, 
                    0.12126817988871574, 
                    -0.11671596172933887, 
                    -0.1274796256537717, 
                    -0.1655873892860585, 
                    0.28001306752041644, 
                    -0.03377347714889084, 
                    -0.11039455511947169, 
                    0.26089036368435015, 
                    -0.16417578034278313, 
                    -0.040281673288366404, 
                    0.09580219572638848, 
                    -0.14188301964420955, 
                    0.2663346888570308, 
                    0.25638742706010365, 
                    -0.2373668026200434, 
                    0.13808535349218465, 
                    0.15031251071427038, 
                    -0.2237877573828458, 
                    -0.18375596151960719, 
                    -0.18228837701746275, 
                    0.13440129987886545, 
                    -0.2316919675369362, 
                    -0.2002684996278774, 
                    -0.22922893569890188, 
                    0.22464197799651997, 
                    0.049954657373993516, 
                    0.22267734792749494, 
                    -0.2375851726356328, 
                    0.08023150746617519, 
                    0.27930166204198614, 
                    0.10383730619246306, 
                    -0.16403584169704935, 
                    -0.1330369821667411, 
                    0.12745175439159256, 
                    0.18568067970904872, 
                    -0.020074816511136573, 
                    -0.25668689151492674, 
                    -0.24654930498967143, 
                    0.1144021447171969, 
                    -0.03997437508117385, 
                    0.2339400696106645, 
                    0.15972373691673036, 
                    0.21237633423306068, 
                    0.2504553311023816, 
                    -0.20571013435456542, 
                    0.19081348299528272, 
                    -0.016500133948820828, 
                    -0.28375305958095076, 
                    -0.14598270820324152, 
                    -0.08604063930447081, 
                    0.2473602518220297, 
                    -0.011667318402842075, 
                    -0.11061181074919005, 
                    -0.06999193019851987, 
                    0.02543493012619763, 
                    -0.24757670621449654, 
                    0.1731041100309536, 
                    0.17166979468350763, 
                    0.025233199878946955, 
                    0.05412162517208452, 
                    -0.08926250801039995, 
                    0.11002708275643419, 
                    -0.294326095533013, 
                    -0.044755697674568495, 
                    -0.065831714893194615, 
                    -0.03460289806660333, 
                    0.1754983749306424, 
                    0.05462417083784632, 
                    -0.13736410008480313, 
                    0.28594201744585945, 
                    0.1543461187504005, 
                    -0.13546949595569355, 
                    0.14868154093434938, 
                    0.2653343370135286, 
                    0.09133998920384667, 
                    -0.037945992276893714, 
                    -0.026331109858344526, 
                    0.12790279601747695, 
                    0.10189610496852436, 
                    0.1828355775870426, 
                    -0.23060298210030508, 
                    0.16747873300404426, 
                    -0.06913909152807235, 
                    -0.19858368749036126, 
                    0.036819130416810675, 
                    -0.1927297905818996, 
                    0.027331329138974292, 
                    0.264002084946256, 
                    0.10537225545350515, 
                    0.24149252876525817, 
                    0.004765265324266299, 
                    0.05936339453281769, 
                    -0.023113904214210612, 
                    -0.0024162173841613677, 
                    0.09869916032601483, 
                    0.12185222674448926, 
                    0.20044021633520037, 
                    0.15088365494380435, 
                    -0.1906160319196143, 
                    -0.22158687060676993, 
                    0.06745727034526733, 
                    0.04042597685025234, 
                    -0.3026866155427333, 
                    -0.07382546681631308, 
                    0.07564036222373982, 
                    -0.0461603590740296, 
                    -0.15843947743570858, 
                    -0.12745347385804068, 
                    0.11044582404708975, 
                    -0.07489333855376532, 
                    0.010054174699877683, 
                    0.2624457723763399, 
                    0.11510684237886332, 
                    -0.26140833882526315, 
                    -0.15943213904155049, 
                    0.23890596131814168, 
                    0.13361723481811472, 
                    0.23006571608927373, 
                    -0.11889649573793559, 
                    -0.12273334355346707, 
                    -0.12814244256235047, 
                    0.21402726541031347, 
                    0.18390699368151653, 
                    -0.11674458887503922, 
                    0.0919762033555287, 
                    0.23510938527878955, 
                    -0.029213997729153507, 
                    -0.019143906708131486, 
                    0.09204544848583546, 
                    -0.13370840688676594, 
                    0.2820200377962252, 
                    -0.11442904306836033, 
                    -0.17031303549377816, 
                    0.11810693356015745, 
                    0.1338051964769571, 
                    -0.20580407062485462, 
                    -0.23778217580548505, 
                    -0.12289420066766088, 
                    -0.27042553654006385, 
                    0.1333701964328735, 
                    -0.11184666372845783, 
                    0.23335127751425955, 
                    0.13864257735649582, 
                    -0.03452572496970341, 
                    0.1694808704102453, 
                    -0.1886601548376674, 
                    0.09793362084380125, 
                    -0.2126516180187627, 
                    -0.05111749179802966, 
                    0.11097647834297242, 
                    0.270903068033602, 
                    -0.08822629171482374, 
                    0.08059299896709277, 
                    0.1531546326136996, 
                    -0.16229380646194608, 
                    0.06857294829041821, 
                    0.24025049256944098, 
                    0.04091842843763638, 
                    0.21830044313550523, 
                    0.22776187477805354, 
                    0.1012794880380331, 
                    -0.1304381108282665, 
                    0.06951141455932269, 
                    0.12950747923326328, 
                    -0.23036968560061316, 
                    0.19552506330298114, 
                    -0.2192717963203967, 
                    -0.03516185523104548, 
                    -0.21507354466750755, 
                    0.06653635868695512, 
                    0.27071761629241176, 
                    0.029675948990260992, 
                    -0.16108660841229172, 
                    -0.12405041256980195, 
                    0.2226843517864896, 
                    0.08067815499494374, 
                    -0.26433520479271033, 
                    0.076609245550042, 
                    -0.048220675848930805, 
                    -0.14796608407156372, 
                    0.11619096241198174, 
                    -0.1408909859407194, 
                    -0.0196122675183118, 
                    -0.13072662627408915, 
                    -0.12261809155610456, 
                    -0.1393707334951076, 
                    -0.05762094140080559, 
                    0.27857140137254277, 
                    0.15988156391274055, 
                    -0.20313564291466796, 
                    -0.07170247051066156, 
                    -0.041456158442577606, 
                    0.002797057663816993, 
                    -0.07535881596237554, 
                    0.24442037827577368, 
                    0.06881105716103114, 
                    -0.08849005722920722, 
                    -0.040267169035412886, 
                    -0.16754153210622444, 
                    0.08189021358348836, 
                    0.013848722617993414, 
                    -0.04096161458768882, 
                    0.27857140137254277, 
                    0.032774440514091674, 
                    -0.048204307986256356, 
                    0.20485762494217907, 
                    0.19564980627403483, 
                    -0.10801074537294236, 
                    0.19310269623354404, 
                    -0.10309332181930009, 
                    -0.159366754975843, 
                    0.2742263550184513, 
                    0.24315555370304742, 
                    -0.043079623594372785, 
                    -0.24881029677995797, 
                    0.14546394973655064, 
                    -0.10601560972973387, 
                    0.2638156516917419, 
                    0.12050531617235449, 
                    0.12187117765180161, 
                    -0.2720907645617938, 
                    0.16704300733053162, 
                    -0.24257381974965186, 
                    -0.18981504544782463, 
                    -0.007937814735293036, 
                    0.1177459408496842, 
                    -0.07189049943091422, 
                    -0.19599401615494197, 
                    0.18132868501499022, 
                    0.2268270809542623, 
                    0.2518728202102857, 
                    -0.1287199312896414, 
                    0.1592620803962813, 
                    -0.043474208384087276, 
                    -0.24910233073998395, 
                    0.2327430579937334, 
                    -0.0823718425357245, 
                    -0.12074804456226212, 
                    0.2605011303762762, 
                    -0.04287697662418982, 
                    0.0069769450390023136, 
                    0.21690453241815721, 
                    0.22054252796126295, 
                    -0.14897200984133244, 
                    -0.010067684715885927, 
                    0.009737343022633793, 
                    -0.24284924516006207, 
                    -0.05869686958661269, 
                    -0.2109818614997332, 
                    0.14556535262920273, 
                    -0.13350851193558796, 
                    -0.14623051854872132, 
                    -0.12640391135521495, 
                    -0.0024513788091846678, 
                    0.017449380812466664, 
                    0.0827911044825968, 
                    -0.1862397345559204, 
                    -0.16498543607657956, 
                    0.21394674985690199, 
                    -0.21354611238575053, 
                    0.2516928344692526, 
                    0.05878518544632799, 
                    0.10455912666727524, 
                    0.2214920886445908, 
                    0.059329876002943815, 
                    -0.25013826987270427, 
                    0.2029137755020527, 
                    0.008241008981721476, 
                    -0.0021875807859933483, 
                    -0.10037017762607303, 
                    0.21292187576314614, 
                    -0.26714451253948934, 
                    -0.1966945310938966, 
                    -0.18581824572963326, 
                    -0.11199417867545922, 
                    0.10530282334961083, 
                    -0.28154623868833506, 
                    0.12320764324468403, 
                    -0.29165244234957916, 
                    -0.18443069698552933, 
                    0.07554926866052097, 
                    -0.29367143324548556, 
                    -0.09728052138616186, 
                    0.271102653395362, 
                    0.1839749880561875, 
                    -0.023904168264410497, 
                    -0.255905589589118, 
                    -0.07817158282382214, 
                    -0.008465963157724798, 
                    0.0926723470925711, 
                    -0.057729075166630284, 
                    0.08292023517163444, 
                    -0.2605950008421774, 
                    -0.017521281152870216, 
                    -0.07696306372031428, 
                    0.08374961159430672, 
                    -0.13522308053280144, 
                    -0.17702959369549842, 
                    -0.11966012505916748, 
                    0.08565708568629998, 
                    0.25913005038093295, 
                    -0.07161730352459192, 
                    0.2056561264251564, 
                    -0.010480382930484755, 
                    0.25332322337316115, 
                    -0.005471216781331167, 
                    0.234281585439706, 
                    0.1816343029556241, 
                    -0.04062278630437427, 
                    -0.04368872184654976, 
                    0.07160541063599585, 
                    -0.17976486261830252, 
                    0.20905548498264437, 
                    0.08218467961122466, 
                    0.23552089080672745, 
                    0.27871763755602863, 
                    0.05717983636824525, 
                    0.12131652929305131, 
                    -0.2752373757619532, 
                    -0.03636106110419929, 
                    -0.2676253193243989, 
                    0.14476079774429856, 
                    0.17132440038036673, 
                    0.06721377682323165, 
                    -0.05945778353947187, 
                    -0.19866614755471357, 
                    -0.015444648483454004, 
                    0.2823630099566986, 
                    -0.02270815524742148, 
                    -0.003117559763186728, 
                    -0.1838887127590132, 
                    -0.2092455501697556, 
                    -0.1973880642007997, 
                    0.03377544498952517, 
                    0.2626176612825881, 
                    -0.025537716199873883, 
                    0.24101742484651956, 
                    -0.2790223306800972, 
                    -0.2233815897194576, 
                    0.061553285824467896, 
                    0.1862382964383199, 
                    0.1929541650351947, 
                    -0.03094861420828582, 
                    -0.15246667741238054, 
                    -0.0710797819458093, 
                    -0.21776442635273113, 
                    0.2516980921385049, 
                    -0.1279302406747936, 
                    0.129482515305621, 
                    0.1246474928899135, 
                    0.21334806220339986, 
                    -0.2493401265548093, 
                    -0.18219133200231624, 
                    0.110588780870713, 
                    -0.22729651947137347, 
                    0.22680720570706348, 
                    -0.09516273171411477, 
                    -0.15181116022926336, 
                    0.1548580318444711, 
                    0.1195727933208881, 
                    0.026531518694922207, 
                    0.2662576965178468, 
                    -0.11261615406744357, 
                    0.18585077114176002, 
                    -0.21517568678906634, 
                    -0.1319688778528519, 
                    -0.19219804855415837, 
                    -0.031738358741495165, 
                    -0.14352370530476594, 
                    -0.2357143460833726, 
                    -0.06736728013492754, 
                    0.009023911959008035, 
                    -0.15700663454356634, 
                    -0.1874057219059747, 
                    0.2497011604014926, 
                    -0.04075807920981478, 
                    -0.20854761177869718, 
                    0.021536418426692405, 
                    -0.25387594822694964, 
                    -0.03440032050625047, 
                    0.10465107554281644, 
                    -0.27213009600284177, 
                    -0.09103813709532421, 
                    0.14849867234865266, 
                    0.08231361011323807, 
                    -0.056369127575870925, 
                    0.14316535367064637, 
                    0.00843798566982662, 
                    -0.0899811590993019, 
                    -0.27397909368926804 
)
)

