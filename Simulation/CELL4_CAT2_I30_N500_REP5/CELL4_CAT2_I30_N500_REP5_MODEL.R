model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.141104, 1);
tau[2,2] ~ dlnorm(-0.265703, 1);
tau[3,2] ~ dlnorm(-0.204553, 1);
tau[4,2] ~ dlnorm(-0.171254, 1);
tau[5,2] ~ dlnorm(-0.31334, 1);
tau[6,2] ~ dlnorm(-0.130906, 1);
tau[7,2] ~ dlnorm(-0.148709, 1);
tau[8,2] ~ dlnorm(-0.425988, 1);
tau[9,2] ~ dlnorm(-0.168794, 1);
tau[10,2] ~ dlnorm(-0.501699, 1);
tau[11,2] ~ dlnorm(-0.180734, 1);
tau[12,2] ~ dlnorm(-0.165096, 1);
tau[13,2] ~ dlnorm(-0.494618, 1);
tau[14,2] ~ dlnorm(-0.515788, 1);
tau[15,2] ~ dlnorm(-0.529992, 1);
tau[16,2] ~ dlnorm(-0.592348, 1);
tau[17,2] ~ dlnorm(-0.546484, 1);
tau[18,2] ~ dlnorm(-0.582645, 1);
tau[19,2] ~ dlnorm(-0.245852, 1);
tau[20,2] ~ dlnorm(-0.355136, 1);
tau[21,2] ~ dlnorm(-0.347892, 1);
tau[22,2] ~ dlnorm(-0.351218, 1);
tau[23,2] ~ dlnorm(-0.254375, 1);
tau[24,2] ~ dlnorm(-0.296688, 1);
tau[25,2] ~ dlnorm(-0.208593, 1);
tau[26,2] ~ dlnorm(-0.14053, 1);
tau[27,2] ~ dlnorm(-0.209815, 1);
tau[28,2] ~ dlnorm(-0.239411, 1);
tau[29,2] ~ dlnorm(-0.085877, 1);
tau[30,2] ~ dlnorm(-0.165188, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.37137553642666, 
                    -0.9978178794135732, 
                    -1.175338879090931, 
                    -1.2766710684464462, 
                    -0.866855218333727, 
                    -1.4040619221969757, 
                    -1.3472170072504392, 
                    -0.5808900588107232, 
                    -1.2842907858351775, 
                    -0.4060189242463285, 
                    -1.247478376698282, 
                    -1.2957835552533448, 
                    0.42181932855840193, 
                    -0.37491350746352414, 
                    -0.34399370555095876, 
                    -0.21333657769780595, 
                    -0.30864071256576375, 
                    -0.23313567284671435, 
                    1.0542588662691161, 
                    0.756977575336595, 
                    0.7756931534514089, 
                    0.7670829797256433, 
                    1.0298892296191262, 
                    0.9119270384644604, 
                    1.1632732761944964, 
                    1.3732081248560912, 
                    1.1596310378959878, 
                    1.0728161233898275, 
                    1.5524348066664044, 
                    1.2954969220841734 ),
tau=matrix(c( NA,1.4317476158555704, 
                    NA,1.2640202278566943, 
                    NA,1.343727156711828, 
                    NA,1.3892253097324545, 
                    NA,1.2052179930318436, 
                    NA,1.446423803066442, 
                    NA,1.4209004362554474, 
                    NA,1.0768196364060147, 
                    NA,1.3926465628399947, 
                    NA,0.9983024969866015, 
                    NA,1.3761177911375286, 
                    NA,1.3978068163087518, 
                    NA,1.0053968785227225, 
                    NA,0.9843361648511224, 
                    NA,0.9704531737923805, 
                    NA,0.911788123386315, 
                    NA,0.9545796799420281, 
                    NA,0.9206779171081747, 
                    NA,1.2893622309548332, 
                    NA,1.1558829313261312, 
                    NA,1.1642862258996827, 
                    NA,1.160420257896814, 
                    NA,1.2784202640989877, 
                    NA,1.2254552402705428, 
                    NA,1.338309701011329, 
                    NA,1.432570448060385, 
                    NA,1.3366743360152986, 
                    NA,1.2976944394020327, 
                    NA,1.5130432281932156, 
                    NA,1.397678118015794 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 0.0684290457833282, 
                    -0.04317326145245198, 
                    -0.18178995741248058, 
                    0.2389870049399409, 
                    -0.05836836927630534, 
                    -0.2542099584831767, 
                    0.07502839579722348, 
                    0.03683106918502277, 
                    -0.21933890180756707, 
                    0.046230861889591024, 
                    -0.12294578504822981, 
                    0.22731845440871695, 
                    -0.025174323173259017, 
                    0.03934988653466187, 
                    0.09620833848751043, 
                    0.2662909514657023, 
                    0.14131526228265262, 
                    -0.2376463137140135, 
                    0.14474933773482884, 
                    -0.2890394647436772, 
                    -0.08500718534070278, 
                    0.12695644766892417, 
                    -0.13977948881468924, 
                    0.2441198660138187, 
                    -0.01662842205281756, 
                    0.08979898360474309, 
                    -0.12058641829864175, 
                    -0.09977116036641709, 
                    -0.15271491027359124, 
                    -0.05742114529367176, 
                    0.21170766345963415, 
                    -0.23462228737959812, 
                    -0.1608856448826206, 
                    -0.21839481391003013, 
                    -0.15728583777306884, 
                    0.17840685735293, 
                    -0.09952895049664731, 
                    -0.0530856577859351, 
                    0.06877191076794426, 
                    0.20853321354405735, 
                    0.1874796326307991, 
                    0.0017970359697588867, 
                    -0.08435493881485012, 
                    -0.10297609031692484, 
                    0.15576325380405392, 
                    -0.28435378939503936, 
                    0.15836380108105602, 
                    -0.11316173075590016, 
                    -0.23860872060933852, 
                    0.1445648182057419, 
                    0.1776802631819167, 
                    0.14548924263872937, 
                    0.0891782657594033, 
                    -0.21158399969011832, 
                    0.2239327385531798, 
                    -0.2000777488418039, 
                    -0.03131595437766932, 
                    -0.050588080842696115, 
                    -0.15772422737968744, 
                    -0.3208301653586972, 
                    0.15112969116130265, 
                    -0.2066129156283625, 
                    -0.09126590948308144, 
                    -0.2121852766385189, 
                    -0.07587024048020125, 
                    -0.2774245492264474, 
                    0.17151778407787605, 
                    0.25670396426190717, 
                    0.03391558845378462, 
                    -2.0701276130918878e-4, 
                    -0.11097236148542838, 
                    0.2329074516618202, 
                    0.10227299153462893, 
                    0.16383761820295478, 
                    0.21857749050227743, 
                    -0.10429094063298416, 
                    0.04391132967823025, 
                    -0.31183528315024084, 
                    -0.142436721542143, 
                    -0.013854291117012585, 
                    0.010346616792843266, 
                    -0.2639749226415981, 
                    -0.09584308313877615, 
                    -0.2489325676173338, 
                    0.15374967649011834, 
                    0.026201492344318178, 
                    -0.25919007886715434, 
                    -0.039014884233604, 
                    -0.3480001124008439, 
                    0.0039044617281541183, 
                    0.1614205642962125, 
                    -0.10002966069473238, 
                    0.12783969289522612, 
                    0.26287009157801283, 
                    0.2581888063201219, 
                    -0.3313076673130919, 
                    0.2462618398634157, 
                    0.17125732826623713, 
                    -0.16142378133118135, 
                    0.13433758981454763, 
                    0.12174027031027762, 
                    -0.12340986344582858, 
                    0.1236583856651961, 
                    0.13712410930598762, 
                    0.0827332627490967, 
                    0.053189510157126696, 
                    -0.1953582416645043, 
                    -0.06601564058276072, 
                    -0.28734369414261696, 
                    0.08166542403907823, 
                    0.02170310420893168, 
                    0.20932764463287828, 
                    0.14974980200027704, 
                    0.11241102706211331, 
                    0.09603600913400157, 
                    0.1749442098214677, 
                    0.2349215891437339, 
                    -0.0032531564860109885, 
                    -0.3137288028897511, 
                    0.1445981955744347, 
                    -0.09947255500005256, 
                    -0.17458540873312714, 
                    0.11798957067419863, 
                    0.13346041596585523, 
                    0.1507053512953193, 
                    0.062765662711322, 
                    0.12306714763335524, 
                    0.23754629200738092, 
                    -0.08975801807203682, 
                    0.21404285498338155, 
                    -0.3049455797928168, 
                    -0.34559178407711755, 
                    0.05853068327485028, 
                    0.12923444724952315, 
                    -0.12146273841610189, 
                    0.2398166047679013, 
                    0.09751951282492677, 
                    -0.1533805943452372, 
                    0.03493083813379999, 
                    -0.1928551430459623, 
                    0.0953973993824393, 
                    0.09995942222328147, 
                    0.0453408786221734, 
                    -0.13276947473873438, 
                    -0.21706171959005952, 
                    -0.24688527068282876, 
                    0.18352147907955857, 
                    0.07804756120862127, 
                    0.0016664887093998937, 
                    -0.3180639668741788, 
                    0.17050880931143747, 
                    -0.3076932699262778, 
                    0.0599817548501711, 
                    -0.11129163119360988, 
                    -0.044993019434837134, 
                    0.23586950269532198, 
                    0.18369855027420828, 
                    -0.2830669608274707, 
                    0.03739495419393185, 
                    -0.1727962540543077, 
                    9.242617284942467e-4, 
                    0.04060818877336936, 
                    -0.21759824042697848, 
                    -0.2702794744592192, 
                    -0.32576002188907455, 
                    0.25115650977340104, 
                    0.21193424697873314, 
                    0.2107059828261088, 
                    0.17297846408348588, 
                    0.21843373332439692, 
                    0.10402644733522487, 
                    0.22400561632513355, 
                    0.07826458320366542, 
                    0.005244888070217946, 
                    0.16736984782400605, 
                    0.1754897174180236, 
                    0.08724139792476515, 
                    0.009905383783926247, 
                    -0.08475430894247321, 
                    0.18465334898019597, 
                    0.1492544444449388, 
                    0.240223227283396, 
                    -0.2199631502595547, 
                    -0.17399681731154523, 
                    0.056588982318722114, 
                    -0.09959259670588833, 
                    -0.32564211176499763, 
                    -0.0813051325337763, 
                    -0.0647565465229486, 
                    -0.21702056497931763, 
                    0.10381048619467859, 
                    -0.1319115171267307, 
                    0.18331271839702373, 
                    0.13966938671181423, 
                    -0.27948509299596147, 
                    -0.2412731213085843, 
                    -0.2226022841723872, 
                    0.1863208201971857, 
                    0.06390632724249551, 
                    -0.019964595464471435, 
                    -0.2510115588875619, 
                    -0.18473273554822242, 
                    0.234163571849693, 
                    0.21429658126534695, 
                    -0.27894562796388556, 
                    -0.13579341748060003, 
                    -0.32199245131965026, 
                    0.1283382089108291, 
                    0.010263487336057808, 
                    -0.2838306275022889, 
                    0.277702268299909, 
                    -0.06164680926376126, 
                    0.15307632112299224, 
                    -0.08642894317138305, 
                    -0.3053853567233619, 
                    0.06483562275130078, 
                    0.2258271579385686, 
                    0.25670396426190717, 
                    0.029898968411081084, 
                    0.17176007802510557, 
                    -0.1478031498587401, 
                    -0.198756259393471, 
                    0.21168320527818846, 
                    0.18721649153264158, 
                    -0.1566671948160994, 
                    -0.04611653543670735, 
                    0.05783739906151353, 
                    -0.07178058242925456, 
                    -0.07794519215740991, 
                    0.18786420275027643, 
                    0.2244353077290952, 
                    0.18252440995688862, 
                    -0.20535139136721878, 
                    -0.11230620624803517, 
                    0.20411105511208788, 
                    0.1128194412398068, 
                    0.23937430057455983, 
                    0.09270844212882834, 
                    -0.03587299620485762, 
                    0.13842614831664452, 
                    -0.06452839621240414, 
                    0.019792029185300708, 
                    0.14010583038043334, 
                    0.17537306517660028, 
                    0.128090542169562, 
                    0.277702268299909, 
                    -0.2559080728795289, 
                    0.2665422945272337, 
                    -0.037095203125487475, 
                    0.1312199600142851, 
                    0.1876961252063834, 
                    -0.20887462433640236, 
                    -0.2536143730197371, 
                    0.2624975764146608, 
                    0.23485480333375536, 
                    -0.1615986920330207, 
                    0.2302775466371509, 
                    0.09768259555349623, 
                    -0.11988897463300927, 
                    0.2201327526282723, 
                    0.22523130620193738, 
                    -0.2681944703600836, 
                    0.22779750726254627, 
                    0.044738784602396164, 
                    0.03379962715366125, 
                    0.20024976847909887, 
                    -0.14168915132638366, 
                    -0.2947032653171625, 
                    0.11891712129177218, 
                    0.07995767900015788, 
                    0.11283680024594822, 
                    -0.17439578076327003, 
                    -0.3260616181496869, 
                    0.20952911991899886, 
                    -0.20314474679054312, 
                    0.0764579040738384, 
                    0.2261053161385424, 
                    0.1998396270685298, 
                    0.07161816057740678, 
                    0.014079096205535824, 
                    0.18333507857536607, 
                    0.07826643302184128, 
                    -0.34874071756233926, 
                    -0.27138626481642103, 
                    -0.1217217395412879, 
                    -0.13668579379674384, 
                    0.2065630690610572, 
                    -0.16650435188981735, 
                    -0.327101664501476, 
                    -0.29067127504440415, 
                    0.003087553592842518, 
                    -0.14469854039819777, 
                    0.16942098841217507, 
                    0.07878780991497353, 
                    -0.09131610286680308, 
                    -0.08681769263287126, 
                    0.19074539017568565, 
                    -0.11692128323223366, 
                    -0.043750669852832325, 
                    0.006569043893162263, 
                    0.10519137695452535, 
                    -0.06152332473102268, 
                    0.25917359769474796, 
                    -0.11286016764506035, 
                    0.034815041974401384, 
                    0.09502659835376687, 
                    -0.14022199822808185, 
                    0.19493987775044924, 
                    -0.06965358950660039, 
                    0.20605775602231907, 
                    0.1720683775715534, 
                    0.14645638920809412, 
                    -0.0932333799109426, 
                    0.1154792702228658, 
                    0.05666788458671601, 
                    0.1331650992760801, 
                    -0.13336104359810108, 
                    0.004045126659946108, 
                    -0.013921858410704202, 
                    0.13973306769915228, 
                    0.20538578952326442, 
                    -0.15470226146435329, 
                    -0.2273691437557931, 
                    -0.052865995357441575, 
                    0.042949634252353985, 
                    -0.07580107080765863, 
                    0.2233127939255875, 
                    0.1594035178045135, 
                    0.18485581907807164, 
                    -0.18791824596071882, 
                    0.10706468846569578, 
                    -0.08618956206409911, 
                    -0.04859521494979707, 
                    -0.30440757764922266, 
                    0.1964479597668029, 
                    0.16694171133942387, 
                    -0.1907921907978391, 
                    0.2011105351466626, 
                    -0.3003880858463101, 
                    0.17786933166785562, 
                    0.0877408078570367, 
                    -0.03082947450257384, 
                    0.13592279828460097, 
                    0.22795303946046203, 
                    -0.10416836319144071, 
                    0.2344771775938988, 
                    -0.10371249172919533, 
                    -0.27151205099575343, 
                    -0.08536215775794853, 
                    -0.01696245209525077, 
                    -0.2299335644816858, 
                    0.041387272726524704, 
                    0.10109975197919602, 
                    -0.23643369493473512, 
                    -0.1470174263717623, 
                    -0.2704614678903, 
                    -0.28391774709839585, 
                    -0.11763874830786508, 
                    0.18494010965726077, 
                    -0.16185188434140363, 
                    -0.19062531640988925, 
                    0.23035255293390983, 
                    -0.28430439412649955, 
                    0.21422207105622443, 
                    0.10768621128091271, 
                    0.10502876027294822, 
                    -0.2912939407245326, 
                    0.06217535434695537, 
                    0.14363383230743082, 
                    -0.13842662160947977, 
                    -0.16964431672899158, 
                    -0.0604468688792979, 
                    0.05520741316630284, 
                    0.08579840291352792, 
                    0.11929318158907914, 
                    -0.1747895330456588, 
                    0.12259449647023496, 
                    0.20437698680653654, 
                    0.13865812850450832, 
                    0.012739896627477543, 
                    0.13675108896759314, 
                    -0.34934938709492497, 
                    0.020658104159392232, 
                    0.13142635637036748, 
                    0.17397211077474578, 
                    0.16690814860545283, 
                    -0.08346119969921922, 
                    -0.10301112993962414, 
                    0.11847029690776306, 
                    -0.08876210025633852, 
                    -0.27165081107655326, 
                    0.25022059207438024, 
                    0.18629476288713182, 
                    0.2410588339588095, 
                    0.06416872559882042, 
                    0.25029725655380447, 
                    0.13833150835242608, 
                    0.15748018653974344, 
                    -0.060106307847648754, 
                    -0.2858720787673894, 
                    -0.2755351640164624, 
                    -0.14495443473053557, 
                    -0.24471158176797658, 
                    0.17722837586798484, 
                    0.12733469082772947, 
                    -0.18925791112831533, 
                    0.06337035307558664, 
                    -0.2443542136265575, 
                    -0.11329531109413316, 
                    0.020830548891948242, 
                    -0.14113544668634195, 
                    0.09153196438716055, 
                    -0.17883494883767354, 
                    -0.07183205655732405, 
                    -0.17226467464990844, 
                    -0.30971390519641173, 
                    0.09931189332238932, 
                    0.09001330148171255, 
                    2.599743937882759e-4, 
                    -0.12263227222930137, 
                    0.26605034659929633, 
                    -0.22660341252578056, 
                    0.061673048732755587, 
                    0.07493781251163967, 
                    -0.23930212131142614, 
                    0.22749026061464822, 
                    0.17187912636241748, 
                    -0.08853736291747855, 
                    0.2662909514657023, 
                    0.05989801490162633, 
                    0.1922532407347715, 
                    0.19812496716418632, 
                    -0.19202528643550096, 
                    0.13406010164029297, 
                    0.17281141773782988, 
                    0.2388298075901027, 
                    -0.10980239337939937, 
                    -0.1825677093801293, 
                    0.12001360188032295, 
                    -0.06879409367292066, 
                    -0.3174406089224162, 
                    -0.29371271143914074, 
                    -0.07997843552886402, 
                    0.11856996144135529, 
                    0.22211734938752287, 
                    0.15554229869416997, 
                    0.18997000191623808, 
                    0.15432381803428669, 
                    -0.003715114189490887, 
                    0.1823366826991472, 
                    -0.06842693663988408, 
                    -0.13085780776945838, 
                    0.10785056340586624, 
                    0.15888384085604207, 
                    0.1923307351666546, 
                    -0.29430139381592013, 
                    0.20374929054057594, 
                    -0.2662839754792169, 
                    0.190400616151647, 
                    0.10498128705827686, 
                    -0.3437443532361399, 
                    -0.06324610275894049, 
                    -0.07779896453960555, 
                    0.26357281434875296, 
                    -0.2825325022225776, 
                    -0.22891545040279732, 
                    -0.18867137685028082, 
                    -0.06603750994773971, 
                    -0.11374536052521253, 
                    0.17929970997103167, 
                    0.14236757652370546, 
                    0.14222082427098437, 
                    -0.2623683419551688, 
                    0.1916222149724059, 
                    -0.02721987921475344, 
                    0.23551371642867175, 
                    0.20837133953604986, 
                    0.09715826506715292, 
                    0.1427660363425347, 
                    0.0647695778523506, 
                    -0.05721416187684608, 
                    -0.2608955817661185, 
                    0.13023081024051053, 
                    -0.29532559543810016, 
                    0.2205980060674158, 
                    0.23797670711931368, 
                    -0.038833806066970844, 
                    0.005451676254946025, 
                    0.13494012514535197, 
                    0.006322392015165601, 
                    0.20026781263500743, 
                    0.10147994719504694, 
                    0.2442556955920599, 
                    0.060487150183097305, 
                    -0.29723787012184827, 
                    -0.12102992738228668, 
                    -0.2544984941897981, 
                    -0.24085409106575553, 
                    0.1946822064484372, 
                    0.15444380042140365 
)
)

