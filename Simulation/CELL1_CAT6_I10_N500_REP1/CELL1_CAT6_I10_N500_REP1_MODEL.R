model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.224035, 1);
tau[1,3] ~ dlnorm(0.103196, 1);
tau[1,4] ~ dlnorm(-0.034277, 1);
tau[1,5] ~ dlnorm(-0.193708, 1);
tau[1,6] ~ dlnorm(-0.38347, 1);
tau[2,2] ~ dlnorm(0.104934, 1);
tau[2,3] ~ dlnorm(-0.020002, 1);
tau[2,4] ~ dlnorm(-0.162807, 1);
tau[2,5] ~ dlnorm(-0.329457, 1);
tau[2,6] ~ dlnorm(-0.529545, 1);
tau[3,2] ~ dlnorm(0.064747, 1);
tau[3,3] ~ dlnorm(-0.061691, 1);
tau[3,4] ~ dlnorm(-0.206461, 1);
tau[3,5] ~ dlnorm(-0.375795, 1);
tau[3,6] ~ dlnorm(-0.579768, 1);
tau[4,2] ~ dlnorm(0.138516, 1);
tau[4,3] ~ dlnorm(0.014787, 1);
tau[4,4] ~ dlnorm(-0.126442, 1);
tau[4,5] ~ dlnorm(-0.29095, 1);
tau[4,6] ~ dlnorm(-0.487953, 1);
tau[5,2] ~ dlnorm(-0.281005, 1);
tau[5,3] ~ dlnorm(-0.423317, 1);
tau[5,4] ~ dlnorm(-0.589298, 1);
tau[5,5] ~ dlnorm(-0.788419, 1);
tau[5,6] ~ dlnorm(-1.037305, 1);
tau[6,2] ~ dlnorm(-0.291411, 1);
tau[6,3] ~ dlnorm(-0.434296, 1);
tau[6,4] ~ dlnorm(-0.601057, 1);
tau[6,5] ~ dlnorm(-0.801303, 1);
tau[6,6] ~ dlnorm(-1.051952, 1);
tau[7,2] ~ dlnorm(0.062582, 1);
tau[7,3] ~ dlnorm(-0.063938, 1);
tau[7,4] ~ dlnorm(-0.208816, 1);
tau[7,5] ~ dlnorm(-0.378299, 1);
tau[7,6] ~ dlnorm(-0.582488, 1);
tau[8,2] ~ dlnorm(-0.147668, 1);
tau[8,3] ~ dlnorm(-0.28317, 1);
tau[8,4] ~ dlnorm(-0.439955, 1);
tau[8,5] ~ dlnorm(-0.625976, 1);
tau[8,6] ~ dlnorm(-0.854694, 1);
tau[9,2] ~ dlnorm(0.102458, 1);
tau[9,3] ~ dlnorm(-0.02257, 1);
tau[9,4] ~ dlnorm(-0.165493, 1);
tau[9,5] ~ dlnorm(-0.332305, 1);
tau[9,6] ~ dlnorm(-0.532625, 1);
tau[10,2] ~ dlnorm(0.120875, 1);
tau[10,3] ~ dlnorm(-0.003484, 1);
tau[10,4] ~ dlnorm(-0.145533, 1);
tau[10,5] ~ dlnorm(-0.311155, 1);
tau[10,6] ~ dlnorm(-0.509761, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.513566764387967, 
                    1.1734678855423897, 
                    1.067550515647805, 
                    1.2652998083935907, 
                    0.31251900162283797, 
                    0.29359617762230694, 
                    -1.0619655320848522, 
                    -0.5732471146869524, 
                    -1.1668173424464894, 
                    -1.216673125032231 ),
tau=matrix(c( NA,2.0627389665482054,1.8279520942137035,1.5931652218792014,1.3583783495446993,1.1235914772101971, 
                    NA,1.8311316300543672,1.6160704926929086,1.40100935533145,1.1859482179699914,0.9708870806085328, 
                    NA,1.7590019011561553,1.5500839712485825,1.3411660413410098,1.132248111433437,0.9233301815258643, 
                    NA,1.8936691695160353,1.6732817806292068,1.4528943917423787,1.2325070028555505,1.012119613968722, 
                    NA,1.2448254401051526,1.079699338011028,0.9145732359169034,0.7494471338227788,0.5843210317286542, 
                    NA,1.231938996960791,1.0679104186586972,0.90388184035660335,0.7398532620545095,0.5758246837524157, 
                    NA,1.7551985273497845,1.546604526488863,1.3380105256279415,1.12941652476702,0.9208225239060985, 
                    NA,1.4223812851018145,1.2421329524499711,1.061884619798128,0.8816362871462847,0.7013879544944415, 
                    NA,1.826602610206059,1.6119272043441626,1.3972517984822663,1.18257639262037,0.9679009867584736, 
                    NA,1.8605543981469495,1.64298735689508,1.4254203156432106,1.2078532743913413,0.9902862331394717 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.011116715596574456, 
                    0.3484912039541468, 
                    0.6607453783891266, 
                    0.08745204325100642, 
                    0.21784588828417661, 
                    -0.3399997337350957, 
                    0.09388219144987386, 
                    0.05957244456151778, 
                    0.06690658107676173, 
                    -0.11903974405517459, 
                    -0.3951040474757238, 
                    -0.5399821061745625, 
                    0.5815077201991841, 
                    0.14288904729452667, 
                    0.20442733610361696, 
                    -0.5972207306841298, 
                    0.4139128971878858, 
                    -0.1154732398113516, 
                    -0.29620131416000717, 
                    0.20591024792050194, 
                    0.008050214891427654, 
                    -0.3890197495970706, 
                    0.4538340347755905, 
                    0.6038292032578432, 
                    -0.5185292156839079, 
                    0.009612193098262889, 
                    -0.39743777861087787, 
                    0.17012740088872447, 
                    -0.28099803496869497, 
                    -0.5584758273143182, 
                    -0.16145620585455783, 
                    0.4050127999387825, 
                    -0.3912507317442267, 
                    -0.14011733887037425, 
                    0.5013755298651217, 
                    -0.36128388387988425, 
                    -0.10117276606516667, 
                    -0.4754498642086078, 
                    -0.3941928809079652, 
                    -0.2620505592046626, 
                    -0.4195723442079873, 
                    0.189161975561418, 
                    0.1304625703162301, 
                    -0.02430785710334238, 
                    0.5184558748903223, 
                    0.1597892248635744, 
                    -0.24522325863027583, 
                    0.43094953924986124, 
                    0.3803589961440841, 
                    -0.4898944117195381, 
                    0.4323742535851558, 
                    -0.4386142991479268, 
                    -0.5703911332859521, 
                    0.7433004344604193, 
                    -0.33847898071040794, 
                    0.7971652454758849, 
                    0.010951491420996717, 
                    -0.4787815989508558, 
                    -0.33617368939200154, 
                    -0.054842586435313034, 
                    0.40639692451687304, 
                    0.5304024949873618, 
                    -0.25666335374731203, 
                    0.4637088351254066, 
                    -0.25830138647925593, 
                    0.5017153194629007, 
                    -0.24426847222401266, 
                    -0.37357180808445767, 
                    0.3157299351024123, 
                    -0.38246476399913476, 
                    -0.03998439924114805, 
                    0.4782365380720812, 
                    -0.187023954715053, 
                    0.6412639576394454, 
                    -0.07360865547425421, 
                    0.34695011248031105, 
                    -0.21541784274881548, 
                    -0.10643802725281193, 
                    0.039364606484867504, 
                    -0.5999869171453426, 
                    -0.03429749251890701, 
                    -0.09429144555403768, 
                    0.4738533616295799, 
                    0.5542624490638022, 
                    0.5163722212610582, 
                    -0.13932053275117146, 
                    0.6858080792513994, 
                    0.3071287079948477, 
                    -0.2291247156680773, 
                    -0.30687205105478577, 
                    0.15546694820433615, 
                    -0.09298194132333915, 
                    -0.17359910680261087, 
                    0.04383262420233125, 
                    0.0676207104601525, 
                    -0.1995737753006659, 
                    0.04798174912165387, 
                    0.4286599004431475, 
                    -0.25266751313797314, 
                    0.09127145882291332, 
                    0.4084391783576704, 
                    -0.4094748536520209, 
                    0.5226694565831509, 
                    0.6991250049097688, 
                    -0.03024065083867844, 
                    -0.19293644851702973, 
                    -0.1316743704396271, 
                    -0.43954177006928613, 
                    0.5426137984571893, 
                    0.00866619640154509, 
                    -0.08063357811013105, 
                    -0.10463609334470325, 
                    0.47367661968083663, 
                    -0.30914782999024765, 
                    -0.5862483719568844, 
                    -0.30348702361813085, 
                    -0.013066341696598927, 
                    -0.24397865667281576, 
                    -0.4929002413515895, 
                    -0.35348410418363224, 
                    0.18902589183918672, 
                    -0.3660026886970492, 
                    -0.5649579065842839, 
                    0.35108893278017195, 
                    -0.36515026235326326, 
                    -0.2125590495458794, 
                    -0.44845402731013617, 
                    -0.6228165412899401, 
                    -0.5365359173903878, 
                    0.3698062725182105, 
                    -0.08352934794940226, 
                    0.07019604721533268, 
                    0.30746844668962103, 
                    0.1382607818260202, 
                    0.1883071460418998, 
                    -0.36276483916368313, 
                    0.04746240642500499, 
                    0.6069509643482924, 
                    0.7971798059657946, 
                    0.604435347994253, 
                    0.23110077540062823, 
                    -0.42731017490829193, 
                    -0.30341521712215186, 
                    -0.2508393784407467, 
                    -0.18814842216781186, 
                    -0.22756394644390976, 
                    -0.11292722266760091, 
                    -0.38515139690076916, 
                    -0.38523102498738887, 
                    0.11919438820224537, 
                    -0.11271859537527529, 
                    -0.3291239531070059, 
                    -0.1679176715402817, 
                    0.4979239924313281, 
                    -0.09259347373386206, 
                    0.4607366396621444, 
                    0.7517363698128268, 
                    -0.5440892538070363, 
                    -0.3032061689148266, 
                    -0.4169494611144263, 
                    0.5530005121093737, 
                    0.6542696112702229, 
                    -0.06563284544795767, 
                    -0.07413200087359462, 
                    -0.35321428135645855, 
                    -0.5317776220429618, 
                    -0.19248625189994933, 
                    -0.15412766450934406, 
                    -0.5274047224989222, 
                    -0.27756522634703057, 
                    0.4535403068228563, 
                    0.4523402489077175, 
                    -0.07407804921722505, 
                    0.47118271043589166, 
                    -0.4949775656259954, 
                    0.010374027736784308, 
                    -0.32382878237599055, 
                    -0.5252616314056844, 
                    -0.14894644175574545, 
                    0.6308176695037868, 
                    0.11948110321117167, 
                    0.394469124921099, 
                    -0.3426565489480879, 
                    -0.4834690038143223, 
                    -0.5710218940859698, 
                    0.08067810428318456, 
                    0.491494865219414, 
                    0.25572603360418256, 
                    0.5456466185563558, 
                    -0.4157767665659775, 
                    -0.15505207901356627, 
                    -0.46024519624674687, 
                    0.2268541675783281, 
                    0.24196888429490848, 
                    0.44561624075433626, 
                    -0.08292414301895934, 
                    0.39509218807289304, 
                    0.2656647010144544, 
                    0.18202749441082988, 
                    0.4954669929548532, 
                    -0.06897239883855621, 
                    -0.007795051419215437, 
                    -0.4220875513956981, 
                    0.6201936230345564, 
                    -0.5155897227772518, 
                    0.5577996562042775, 
                    -0.30534328004968364, 
                    0.10342289298500584, 
                    -0.12481785140899443, 
                    -0.32972382250616467, 
                    0.28331576793760815, 
                    -0.28839717321368774, 
                    -0.5274047224989222, 
                    -0.3563551449031521, 
                    -0.49241171588035026, 
                    -0.41947275996327055, 
                    -0.4629865709962898, 
                    -0.3209370143449015, 
                    -0.379191979783852, 
                    -0.09931184643084878, 
                    -0.005902473708481959, 
                    -0.20393760308667558, 
                    -0.5021301821456297, 
                    0.11041046005869737, 
                    -0.030430119488330964, 
                    -0.23946169309918885, 
                    -0.06284289749433014, 
                    0.07024990827559785, 
                    0.45500372132309064, 
                    -0.33497418149818453, 
                    -0.19688200856836824, 
                    -0.20539527967030163, 
                    -0.4870282256417532, 
                    0.43730100733375776, 
                    0.3282141194933239, 
                    -0.41295612883850497, 
                    -0.5075019220528068, 
                    0.3511298343948803, 
                    -0.13707576968156687, 
                    -0.0550414434679245, 
                    0.7265288076497085, 
                    -0.22375566877791425, 
                    0.2224740114509265, 
                    -0.5955015657673801, 
                    0.5594629831920275, 
                    0.5046302916399337, 
                    0.7118266978117673, 
                    0.4536510908727116, 
                    -0.5381404210325615, 
                    -0.2930870195411064, 
                    -0.12136507451740841, 
                    0.6069368194386575, 
                    -0.08996153474144142, 
                    -0.3904362720088162, 
                    -0.1889556729034631, 
                    -0.4041100596877838, 
                    0.14166643848398652, 
                    -0.1546692334379698, 
                    -0.5552187685235903, 
                    0.801780026594707, 
                    0.6534471385848148, 
                    -0.24713406338312088, 
                    -0.024805840220693764, 
                    0.5576648188245843, 
                    0.4815884774772252, 
                    -0.1485996457297849, 
                    -0.5142611426325372, 
                    -0.5733168672222069, 
                    0.03656151110783956, 
                    -0.15971429933583092, 
                    -0.4034726255872381, 
                    0.7659480908063263, 
                    -0.28027135827236094, 
                    -0.5868587856343208, 
                    0.2773858078420489, 
                    -0.14286527503973562, 
                    -0.4480865738214719, 
                    0.31505024233243917, 
                    0.17012740088872447, 
                    -0.2023658784429439, 
                    -0.5066564813063498, 
                    -0.4827364497022474, 
                    0.322039861012982, 
                    0.41052793339478266, 
                    -0.2761900967792926, 
                    -0.34797850480062437, 
                    0.8211737890292063, 
                    0.08459386703147886, 
                    0.12187586393355299, 
                    0.30788598478612716, 
                    0.10496781521858989, 
                    0.5826932075960405, 
                    -0.3497682525177055, 
                    0.46991871183296174, 
                    -0.38623629812183563, 
                    -0.04859720591049255, 
                    -0.11305050617751, 
                    0.6717163357230294, 
                    -0.4649527366166426, 
                    -0.5972207306841298, 
                    -0.5193786778416876, 
                    0.3638888582813208, 
                    0.4913037860590961, 
                    -0.031657914797295295, 
                    -0.35658026801375386, 
                    0.11340585663144565, 
                    0.3021410727020156, 
                    -0.24151619545758063, 
                    0.011218710911347074, 
                    -0.5811900549377311, 
                    -0.12590468838060637, 
                    0.5098039735687272, 
                    0.1167747406219174, 
                    -0.07935840058119747, 
                    0.3919077180135486, 
                    -0.17740411081648433, 
                    -0.22620282076301873, 
                    -0.496679806720425, 
                    -0.04273891296679222, 
                    -0.35826462747632903, 
                    0.12449345428185754, 
                    -0.09668315557917062, 
                    0.324995649484092, 
                    0.5201004551852131, 
                    -0.4832922307712767, 
                    -0.4433036454772873, 
                    -0.5750974308859833, 
                    0.7299474948987243, 
                    -0.6247993183540597, 
                    -0.4581498109990186, 
                    0.39489044286631514, 
                    -0.39733419498569567, 
                    0.22830435051333886, 
                    0.40951375844017, 
                    -0.5857018449622277, 
                    0.3930430404275813, 
                    0.15906982829979543, 
                    0.22292259418177474, 
                    -0.48601188559888486, 
                    0.31196406285955347, 
                    -0.2754474318686914, 
                    0.42275678725166044, 
                    0.7272968188314699, 
                    -0.6022152340168752, 
                    0.44021334678838997, 
                    0.5320744281561751, 
                    -0.17811848445599232, 
                    0.5675696242164163, 
                    0.49067935939583274, 
                    -0.2336017570843214, 
                    -0.6162072844095418, 
                    0.3793642063246585, 
                    0.4353657876205448, 
                    0.24075396581223873, 
                    0.25692544491939007, 
                    -0.558161891532518, 
                    0.01406754018294143, 
                    0.19810432988519067, 
                    -0.6001379097424692, 
                    -0.6040196790823287, 
                    0.3714590813994759, 
                    -0.360656809476906, 
                    -0.18549337719417175, 
                    0.016426188287716137, 
                    -0.16849459395183042, 
                    0.028040462709452485, 
                    -0.5357086763107132, 
                    -0.42720074883456566, 
                    -0.43558624339601, 
                    0.6989799512237787, 
                    0.08872594044325588, 
                    0.5615015813888944, 
                    0.5824403370039459, 
                    0.3102633288140958, 
                    0.35505894643542923, 
                    -0.17898513796288262, 
                    -0.49374218447489904, 
                    0.6045954773529119, 
                    0.12473604177781861, 
                    0.01791421853323827, 
                    -0.5434629267320623, 
                    -0.4181120645614832, 
                    -0.03889306108238655, 
                    0.1700066775297393, 
                    0.1492911480827117, 
                    -0.04033617737411588, 
                    -0.31140200411197666, 
                    -0.1570098147523754, 
                    -0.16438329927705592, 
                    0.696573481830348, 
                    -0.32718118906193416, 
                    -0.16419493421724124, 
                    -0.12470248905808701, 
                    0.5230328907011557, 
                    -0.17519309366429192, 
                    0.3767291111257558, 
                    -0.1448951065562517, 
                    -0.18882099578689598, 
                    -0.04864303154437788, 
                    0.3603232219186566, 
                    -0.23738546398848487, 
                    -0.042176233313660716, 
                    0.7812168963002228, 
                    0.5452318112103487, 
                    -0.2598528817134999, 
                    0.18171238732441586, 
                    0.2321996246713689, 
                    0.2594085555892771, 
                    0.25396987342983524, 
                    -0.13431012121462926, 
                    -0.5306613328682351, 
                    0.776560480810083, 
                    -0.5752397629012934, 
                    -0.061005456525042634, 
                    -0.4381671258327013, 
                    -0.3091717188226092, 
                    0.6754482551006309, 
                    -0.3978907486327701, 
                    -0.4326368119699089, 
                    -0.5652342135210395, 
                    -0.34003568833061365, 
                    -0.44577309795820064, 
                    -0.3164694526246505, 
                    0.1438514490818964, 
                    -0.16409486695445175, 
                    0.05043393372226013, 
                    0.4478078163104511, 
                    -0.4502153722353743, 
                    0.3956840918320208, 
                    0.14685199321760278, 
                    -0.09702867936761772, 
                    0.1635044165535896, 
                    -0.24784939242726783, 
                    0.25938057879835086, 
                    0.22926317116487438, 
                    0.6262698435687883, 
                    -0.4578595444501811, 
                    -0.13873836450510413, 
                    -0.304300496426138, 
                    0.2119360862719123, 
                    -0.23273871025136078, 
                    0.45741465335945786, 
                    0.06303578607778604, 
                    -0.5345671567192378, 
                    -0.43215947231836077, 
                    -0.49538223529250336, 
                    0.33447742299634076, 
                    -0.5107553000862755, 
                    -0.35147950305312703, 
                    0.296897976598684, 
                    0.20596018157563512, 
                    -0.5562874884442983, 
                    0.1320957135789661, 
                    -0.2657868706961006, 
                    -0.5623931927301196, 
                    0.16890026595843555, 
                    -0.5656104177567159, 
                    -0.10652737615536556, 
                    0.6539478895941861, 
                    0.04906162801403324, 
                    -0.29917027210659175, 
                    0.3285901768650593, 
                    -0.4399813939057323, 
                    -0.2934973332903962, 
                    -0.5281425269175751, 
                    0.24095257705845552, 
                    -0.3430134946101409, 
                    -0.4879625792613001, 
                    -0.5374381405903744, 
                    -0.48980948012708225, 
                    -0.5220699779145298, 
                    -0.48178291386299427, 
                    0.171818684251964, 
                    0.2588143729758059, 
                    0.7122710300508395, 
                    0.5529725937982337, 
                    -0.5022122479953178, 
                    -0.2511430050260071, 
                    -0.09989351936873359, 
                    -0.2555344086114711, 
                    0.29671917926735625, 
                    -0.0010078159294290012, 
                    0.2638601547832893, 
                    -0.43251735102597044, 
                    0.38921248061032476, 
                    0.4801939388870775, 
                    0.22958558458661538, 
                    0.23348753570869063, 
                    0.058444827557222134, 
                    -0.3489269068387315, 
                    0.22336604994915243, 
                    0.2627436151318282, 
                    -0.022243681011591354, 
                    0.5905414482822455, 
                    0.3721118024012068, 
                    -0.5868587856343208, 
                    -0.07878931510205545, 
                    0.09334607293367803, 
                    0.5460281687450577, 
                    -0.2022822033458006 
)
)

