model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.165664, 1);
tau[2,2] ~ dlnorm(-0.26496, 1);
tau[3,2] ~ dlnorm(-0.374423, 1);
tau[4,2] ~ dlnorm(-0.24821, 1);
tau[5,2] ~ dlnorm(-0.243271, 1);
tau[6,2] ~ dlnorm(-0.149977, 1);
tau[7,2] ~ dlnorm(-0.211927, 1);
tau[8,2] ~ dlnorm(-0.151984, 1);
tau[9,2] ~ dlnorm(-0.165667, 1);
tau[10,2] ~ dlnorm(-0.531582, 1);
tau[11,2] ~ dlnorm(-0.173528, 1);
tau[12,2] ~ dlnorm(-0.329611, 1);
tau[13,2] ~ dlnorm(-0.586518, 1);
tau[14,2] ~ dlnorm(-0.560426, 1);
tau[15,2] ~ dlnorm(-0.493017, 1);
tau[16,2] ~ dlnorm(-0.459926, 1);
tau[17,2] ~ dlnorm(-0.41913, 1);
tau[18,2] ~ dlnorm(-0.604537, 1);
tau[19,2] ~ dlnorm(-0.361869, 1);
tau[20,2] ~ dlnorm(-0.378392, 1);
tau[21,2] ~ dlnorm(-0.329423, 1);
tau[22,2] ~ dlnorm(-0.197178, 1);
tau[23,2] ~ dlnorm(-0.208007, 1);
tau[24,2] ~ dlnorm(-0.327871, 1);
tau[25,2] ~ dlnorm(-0.176576, 1);
tau[26,2] ~ dlnorm(-0.249366, 1);
tau[27,2] ~ dlnorm(-0.246372, 1);
tau[28,2] ~ dlnorm(-0.091411, 1);
tau[29,2] ~ dlnorm(-0.154223, 1);
tau[30,2] ~ dlnorm(-0.118331, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.294013859983929, 
                    -0.999908943590785, 
                    -0.7078012622699426, 
                    -1.0474960648670182, 
                    -1.0616820563057914, 
                    -1.34320776016699, 
                    -1.1533498261175286, 
                    -1.3368694009223572, 
                    -1.294004665287048, 
                    -0.340559855270615, 
                    -1.2696429166320091, 
                    -0.8235314825018926, 
                    -0.22520988739762354, 
                    -0.27920501251066177, 
                    -0.4254052105568521, 
                    -0.5008630075244621, 
                    -0.5973948002912974, 
                    -0.1887342426055103, 
                    0.7397025641753313, 
                    0.697798616823354, 
                    0.824028700672342, 
                    1.1974900636457866, 
                    1.1650197145507448, 
                    0.8281304427414734, 
                    1.2602482351836497, 
                    1.0441861557000456, 
                    1.052767819574901, 
                    1.5338379754461378, 
                    1.3298165090381704, 
                    1.4448279167373146 ),
tau=matrix(c( NA,1.3970122231327842, 
                    NA,1.2649591156722626, 
                    NA,1.1338027667592043, 
                    NA,1.2863257331252913, 
                    NA,1.2926952432813004, 
                    NA,1.4191002843149785, 
                    NA,1.3338540719267704, 
                    NA,1.4162543610141385, 
                    NA,1.3970080947138848, 
                    NA,0.9689113750165061, 
                    NA,1.3860696695677723, 
                    NA,1.18576563564335, 
                    NA,0.9171192394415331, 
                    NA,0.9413630506172872, 
                    NA,1.0070069395400267, 
                    NA,1.0408874903784835, 
                    NA,1.0842302653307927, 
                    NA,0.9007416749298742, 
                    NA,1.1481264513147238, 
                    NA,1.129311578953686, 
                    NA,1.1859888866018817, 
                    NA,1.3536730385769582, 
                    NA,1.3390938518332844, 
                    NA,1.1878305687909216, 
                    NA,1.3818514575974588, 
                    NA,1.2848395839093205, 
                    NA,1.2886927509891306, 
                    NA,1.504693250975316, 
                    NA,1.4130876125581384, 
                    NA,1.4647277346150545 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 0.1554771943627693, 
                    0.22466075141400255, 
                    -0.23674135553462888, 
                    -0.3006899814010348, 
                    -0.2678623054641843, 
                    0.2175095278190352, 
                    -0.17065545582967973, 
                    0.24754485634464385, 
                    -0.202077730177025, 
                    -0.05935904178717555, 
                    0.1908492003366975, 
                    -0.08196261803956961, 
                    -0.14349233358922225, 
                    0.03323023569739614, 
                    0.10776226327112737, 
                    0.05233714313596144, 
                    0.08799856038977938, 
                    -0.14644099793820603, 
                    -0.0506577382780648, 
                    -0.10916005600042011, 
                    0.09407015166080557, 
                    -0.23568806972202186, 
                    -0.02343868821492401, 
                    0.23569822255549788, 
                    0.0782666592439995, 
                    0.10650130270694963, 
                    0.10421437079171614, 
                    0.05352648043298974, 
                    -0.07110565754120574, 
                    0.20639619866902637, 
                    -0.27842936631662357, 
                    -0.11115901722460295, 
                    -0.07604189971514586, 
                    -0.10282199212117293, 
                    0.07494665930795974, 
                    -0.22044632764446928, 
                    -0.19817413572563403, 
                    -0.09465555140757942, 
                    -0.28549434967826004, 
                    -0.27154381965951346, 
                    -0.2351281652877612, 
                    -0.060758818237986345, 
                    0.07707836123715878, 
                    -0.10987004273766032, 
                    0.20464754745325586, 
                    -0.17435594128763168, 
                    0.02635800891087353, 
                    0.10935365268958724, 
                    -0.15289282182887423, 
                    0.2198461924528814, 
                    -0.27778958164559364, 
                    0.09919648593723701, 
                    0.25595975159315276, 
                    0.07384842609622644, 
                    0.06792087015829706, 
                    0.12193986569441201, 
                    -0.24897892631633334, 
                    -0.02516702261325826, 
                    -0.22622857731866627, 
                    -0.13037616074849545, 
                    -0.05527656966494987, 
                    0.2071926228140447, 
                    -0.2102836567497607, 
                    -0.2828096620115644, 
                    0.24447490417148454, 
                    0.23569822255549788, 
                    -0.049141876433618836, 
                    -0.18768152075829522, 
                    -0.11886651750981386, 
                    0.10936128893054431, 
                    -0.19745194859321732, 
                    0.20662535205977306, 
                    -0.21184389695077874, 
                    0.02125929232285878, 
                    0.14151630894259087, 
                    0.14757934344746199, 
                    -0.3454149060586921, 
                    -0.22937215560836227, 
                    -0.1807077209420313, 
                    0.25595975159315276, 
                    -0.08693536002010066, 
                    0.19470399972853447, 
                    0.09845266729911178, 
                    0.11266423972278672, 
                    0.16465146834487832, 
                    0.06889040150710041, 
                    -0.00832256872619036, 
                    0.002263725635039293, 
                    0.22881170949260765, 
                    0.2083204693548758, 
                    0.13844905522754825, 
                    0.1540043721485888, 
                    -0.1122462944641825, 
                    -0.05625733143466455, 
                    -0.1780093947859834, 
                    0.12575616385888172, 
                    0.1035579928315058, 
                    0.09675920940997546, 
                    0.03408567216837338, 
                    0.17646142880099203, 
                    0.24502407797972603, 
                    0.17444156693134505, 
                    0.25595975159315276, 
                    -0.2365448222376093, 
                    -0.15504496660610784, 
                    -0.29927602917435775, 
                    0.1697543933796689, 
                    -0.18641117461884893, 
                    -0.10885308007222136, 
                    -0.19194410243854546, 
                    0.21735889972260358, 
                    0.19906851837593897, 
                    -0.04362547809190431, 
                    -0.11996998317815724, 
                    -0.1925456350521445, 
                    0.06667476662105015, 
                    -0.08151862826769019, 
                    -0.32876896177458537, 
                    -0.03448728092706038, 
                    0.23750667429319838, 
                    0.22229687190837888, 
                    -0.3098821868217785, 
                    0.06511513580225609, 
                    -0.023340223235135404, 
                    -0.04666941291937304, 
                    -0.3251484624143321, 
                    -0.040835104069672334, 
                    0.07362956416506661, 
                    0.23500319280046988, 
                    -0.17318168142018864, 
                    -0.14558836790603805, 
                    0.1374729280512666, 
                    0.04751459849908035, 
                    0.1543795881107094, 
                    -0.09245667894070086, 
                    0.27016259937562337, 
                    0.14803113168587234, 
                    0.030595389523322247, 
                    -0.2026178609702615, 
                    0.15531115761335124, 
                    -0.06146445345282603, 
                    -0.18609694358179224, 
                    0.06677474349319079, 
                    -0.21166966031075674, 
                    0.21370714785042288, 
                    -0.04096431477882978, 
                    0.02185945943756118, 
                    -0.03278034601338148, 
                    0.07405052384724259, 
                    0.17244646497274196, 
                    0.15581730326758725, 
                    0.17641199379651207, 
                    0.11352952951246681, 
                    0.14713556191942312, 
                    -0.11750512003595023, 
                    -0.16435040786901772, 
                    0.22218481242093946, 
                    -0.05806192621067913, 
                    0.25949057979466683, 
                    -0.1398144604874775, 
                    0.2122918181759912, 
                    -0.31491845167488464, 
                    0.15914211076604368, 
                    -0.015230469088320653, 
                    -0.18828459305245654, 
                    -0.10217374484872074, 
                    -0.04911786297172527, 
                    -0.05995879807304122, 
                    0.19184530527719257, 
                    0.22844861323348087, 
                    0.18505794020113786, 
                    0.19812997329971738, 
                    0.24552250285528399, 
                    -0.2879034757527902, 
                    0.06840630394725017, 
                    0.15895172729447715, 
                    0.07010119507253615, 
                    0.23039173355874765, 
                    -0.2552899044882484, 
                    -0.05485655938605066, 
                    0.022216065331723434, 
                    0.19189587906399663, 
                    -0.18197490047400167, 
                    0.1507978813270452, 
                    -0.14626081502535304, 
                    -0.07329346686275401, 
                    0.11863002966747083, 
                    0.10353982030095527, 
                    0.1788758073489103, 
                    -0.1788539473360295, 
                    0.22368934147619446, 
                    0.1685498076194577, 
                    -0.20459211750467626, 
                    0.02820357244348287, 
                    0.14334386532754495, 
                    -0.231220207652434, 
                    0.15111416111428083, 
                    0.09156979231506235, 
                    0.17936184299614721, 
                    -0.017538351019535103, 
                    0.1559434239595615, 
                    0.09360789513152479, 
                    0.1528128706918811, 
                    -0.1686630644635641, 
                    0.2058452371670495, 
                    0.21870898245670833, 
                    -0.11329308672714042, 
                    0.19163824082165015, 
                    -0.24507163494366455, 
                    0.1927372438610312, 
                    -0.28034172499068327, 
                    0.08920312206074266, 
                    0.06849721731046332, 
                    -0.273226605549784, 
                    -0.04391582623031953, 
                    -0.2942693789700816, 
                    0.18807804371157655, 
                    0.1118233119587656, 
                    -0.159773382984553, 
                    -0.18192023576157237, 
                    -0.08310770791704547, 
                    -0.02574720066217545, 
                    -0.2742510963846645, 
                    0.220240409616143, 
                    0.17371400040133633, 
                    -0.007546579066485537, 
                    0.22633575576451248, 
                    0.0581915020115748, 
                    -0.24739210054875194, 
                    -0.02542462074507018, 
                    -0.053518365510714705, 
                    0.2009633957262058, 
                    -0.055963029272992404, 
                    0.22972205554991354, 
                    -0.007027705205645884, 
                    -0.29930349199828077, 
                    -0.10495727783508157, 
                    0.12499781789279035, 
                    0.21798936015089143, 
                    -0.0833917084947215, 
                    -0.032470108219487814, 
                    0.19507368531628, 
                    -0.008443003448139641, 
                    0.2565536275862125, 
                    -0.20040491020780715, 
                    0.19057665333615492, 
                    -0.2060327737259672, 
                    -0.05614769672900283, 
                    0.21961503541678584, 
                    0.13586729692594796, 
                    0.025738207789434142, 
                    -0.03179557968612573, 
                    -0.153328962386427, 
                    0.044496001177601, 
                    0.17786737068903302, 
                    0.06810458617872028, 
                    -0.22856749462222864, 
                    -0.16211678937112559, 
                    0.23750667429319838, 
                    0.04797774819639028, 
                    -0.24040582965557666, 
                    0.0024646086826162206, 
                    -0.2046812157856535, 
                    -0.06707434187028849, 
                    -0.23755772664162145, 
                    0.21816946960687278, 
                    0.12423379173862042, 
                    -0.007050873634154631, 
                    -0.11069292443479256, 
                    0.1293769323533725, 
                    0.20387212972923396, 
                    0.18306239107018019, 
                    0.11776312320506499, 
                    0.23337454263549517, 
                    -0.08741292155181829, 
                    -0.26590386609974453, 
                    -0.25878070243776263, 
                    -0.1939941499243829, 
                    -0.05358708677823398, 
                    0.1357451040295652, 
                    0.02287843517847793, 
                    0.25595975159315276, 
                    -0.15671346723896679, 
                    0.05070382490352637, 
                    0.22208896874218143, 
                    -0.14308457357925597, 
                    0.0497372346993053, 
                    0.22205082414691646, 
                    0.06118881523858455, 
                    0.1692104731972086, 
                    0.22392998846336454, 
                    -0.2841107985793942, 
                    0.18248545489749068, 
                    -0.1721862906542881, 
                    -0.045740979792505077, 
                    0.27016259937562337, 
                    -0.09067814395712892, 
                    0.05365444240910794, 
                    -0.029320696536097812, 
                    0.018975944590768845, 
                    0.27016259937562337, 
                    -0.09100966438296676, 
                    -0.23139796895976497, 
                    -0.14609962252574296, 
                    0.15864189654024585, 
                    0.07160457026096634, 
                    0.10559693665192343, 
                    0.07664612716105601, 
                    0.2051951165735849, 
                    0.20586142010308706, 
                    0.08049966838154776, 
                    -0.11499062410537267, 
                    0.044679638012643685, 
                    0.12072999394248723, 
                    0.18550542881329457, 
                    -0.2511656439085018, 
                    -0.20937875898666342, 
                    0.10950568091149948, 
                    -0.14060330712316024, 
                    0.13290909187847916, 
                    -0.04865513584889236, 
                    0.27016259937562337, 
                    0.25949057979466683, 
                    -0.05883348239756164, 
                    0.16484416762227405, 
                    -0.0036363878300078034, 
                    0.20962334324468834, 
                    0.24392476637758687, 
                    -0.23994981491186335, 
                    0.122137374106557, 
                    -0.10310715752649449, 
                    -0.2273146699124562, 
                    -0.06581142485301456, 
                    0.21821800103030076, 
                    0.12818148764014908, 
                    0.16507391078557054, 
                    -0.023643971629844884, 
                    -0.21107704721164758, 
                    0.033263026123518113, 
                    0.22068635501472555, 
                    -0.29089747705536195, 
                    -0.0881740760772926, 
                    0.1832418053971292, 
                    0.21209265802997246, 
                    0.21615404225088042, 
                    -0.24996232037858773, 
                    0.25949057979466683, 
                    0.13062056097409752, 
                    -0.2619876800159162, 
                    -0.10186785087124736, 
                    -0.18258062736581918, 
                    -0.17233103766382832, 
                    0.0855574914298981, 
                    0.15993231550860865, 
                    -0.12483346268104059, 
                    0.21003650416849173, 
                    -0.23092015471927363, 
                    0.15624982565882028, 
                    -0.09920302453425411, 
                    -0.25229265657161803, 
                    0.2226895442641711, 
                    -0.06605222975360497, 
                    0.20283279377014563, 
                    -0.10147393930519344, 
                    0.2324071250052957, 
                    -0.10365545441293655, 
                    -0.28419063231679687, 
                    -0.06434107099993358, 
                    0.06173584641114416, 
                    0.06218396015533045, 
                    -0.311405262616792, 
                    -0.13684135475637219, 
                    0.013182749760656975, 
                    -0.2040235907445872, 
                    -0.16155585145515955, 
                    -0.06366456629681988, 
                    0.19501537561015592, 
                    0.09608377787030031, 
                    0.24236675075905922, 
                    -0.05117694346319457, 
                    0.23093621922984908, 
                    0.20010901256516167, 
                    -0.04372936505715236, 
                    -0.004277225588206979, 
                    0.19045067924301784, 
                    0.20002645198995994, 
                    0.13554746173630267, 
                    0.017414279532303845, 
                    0.16185468762927324, 
                    0.24754485634464385, 
                    -0.18963896297117375, 
                    -0.2426283074790015, 
                    -0.01580044315633622, 
                    0.08096950295954192, 
                    0.16699302216069156, 
                    0.25864230898554796, 
                    0.014418835886333692, 
                    -0.1344073990009721, 
                    -0.31822389101672344, 
                    0.07494535901448107, 
                    -0.24813102789371702, 
                    -0.054359109253450166, 
                    0.25949057979466683, 
                    0.14432595916139002, 
                    -0.1712610867078367, 
                    0.1740985988744611, 
                    -0.2570659790193828, 
                    0.001368025763876013, 
                    0.24151222578143583, 
                    0.01716154321943003, 
                    0.20667050333300185, 
                    -0.11022121135766696, 
                    0.17308542880942868, 
                    -0.25576434655488595, 
                    -0.26812633267093017, 
                    -0.05358732377731473, 
                    0.27016259937562337, 
                    -0.21939420834004858, 
                    -0.07062802149521297, 
                    0.14261978377957096, 
                    -0.1594876198135441, 
                    -0.05347254528808876, 
                    0.20391610434860385, 
                    -0.26281412262512377, 
                    0.06866301400169567, 
                    0.14592004271377612, 
                    0.18991136940011688, 
                    0.074661451116658, 
                    0.10897395864354881, 
                    0.061911708901108864, 
                    -0.03177415076531309, 
                    0.12208906139010639, 
                    -0.12409245092147927, 
                    -0.13902963016872247, 
                    -0.22797217247036394, 
                    -0.06408254332258545, 
                    0.19346797501369462, 
                    -0.04972152454978945, 
                    0.2370576592478757, 
                    -0.17492881420418777, 
                    0.21370714785042288, 
                    -0.260399548599938, 
                    -0.21012923564077143, 
                    -0.11770383488231481, 
                    0.1115148127777032, 
                    0.15911709014671693, 
                    0.1445394365606037, 
                    -0.008853666858342213, 
                    -0.08657258867804313, 
                    0.17520005246513048, 
                    0.17889870561535293, 
                    0.1518297438984329, 
                    -0.3218546464508614, 
                    0.14213167349630046, 
                    -0.1253891840157218, 
                    -0.060762497070788846, 
                    -0.1395028775145458, 
                    -0.2884960435486737, 
                    -0.11556479005013323, 
                    0.11230014165019697, 
                    0.25949057979466683, 
                    0.24724749815136382, 
                    -0.22253840351027843, 
                    -0.06992391820274252, 
                    0.019762951816749086, 
                    0.1439402542642521, 
                    0.14840609284240935, 
                    -0.1568604529148931, 
                    -0.15810697523754227, 
                    0.23538500418894304, 
                    0.04537714297802686, 
                    -0.1428774351281044, 
                    0.17739328026393286, 
                    0.05344426774674005, 
                    -0.22174615785635615, 
                    -0.16098998609867315, 
                    0.20314421305383024, 
                    0.16598672507805, 
                    -0.08435329255035684, 
                    0.24236675075905922, 
                    0.03146688274139653, 
                    -0.25294421844194237, 
                    -0.20500655471579002, 
                    -0.09621365992397155, 
                    -0.22977013189043488, 
                    0.07131144204034123, 
                    0.27016259937562337, 
                    0.12817535998393048, 
                    0.13587695257828158, 
                    -0.030660913118296496, 
                    -0.1608427458320916, 
                    -0.15989494034780372, 
                    0.13685931347478086, 
                    -0.3321844427299287, 
                    0.15079720883952452, 
                    -0.2173942499075893, 
                    -0.12747849247268275, 
                    -0.09695071265054123, 
                    -0.08704827383595887, 
                    -0.19656809803521094 
)
)

