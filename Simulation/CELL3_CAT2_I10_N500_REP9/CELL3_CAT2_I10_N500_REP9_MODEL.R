model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.122689, 1);
tau[2,2] ~ dlnorm(-0.137087, 1);
tau[3,2] ~ dlnorm(-0.215504, 1);
tau[4,2] ~ dlnorm(-0.478743, 1);
tau[5,2] ~ dlnorm(-0.687728, 1);
tau[6,2] ~ dlnorm(-0.636469, 1);
tau[7,2] ~ dlnorm(-0.232248, 1);
tau[8,2] ~ dlnorm(-0.417489, 1);
tau[9,2] ~ dlnorm(-0.258841, 1);
tau[10,2] ~ dlnorm(-0.183248, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.4306413688329271, 
                    1.3842102626441146, 
                    1.142743773897812, 
                    0.45765017264316477, 
                    0.0285979914933219, 
                    0.1256870204723268, 
                    -1.09359310509514, 
                    -0.6013590348996402, 
                    -1.0172006411556909, 
                    -1.2397827424261492 ),
tau=matrix(c( NA,1.4583579746059843, 
                    NA,1.4375104079272076, 
                    NA,1.3290919544801176, 
                    NA,1.021484927516781, 
                    NA,0.8288404981805015, 
                    NA,0.8724334721920748, 
                    NA,1.307023304187718, 
                    NA,1.0860102066699384, 
                    NA,1.2727230878789053, 
                    NA,1.372662451349341 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.2381671755121124, 
                    0.35948861745893335, 
                    -0.2381671755121124, 
                    -0.1780057683145679, 
                    -0.1780057683145679, 
                    0.05852985003940506, 
                    -0.03185195837155305, 
                    0.2527648746726684, 
                    0.12126659691547095, 
                    -0.09266390813341316, 
                    -0.019992868013929382, 
                    -0.16014148662122116, 
                    0.16896897732180868, 
                    0.0538808813983411, 
                    -0.09266390813341316, 
                    -0.2203828310450834, 
                    -0.02859225844516522, 
                    -0.07550583171526387, 
                    -0.17193770400338013, 
                    0.060597922922007136, 
                    0.13590971576371788, 
                    -0.019992868013929382, 
                    -0.12935151351851834, 
                    -0.02909786104432041, 
                    0.27875497506367164, 
                    -0.02909786104432041, 
                    0.07401272785235732, 
                    -0.019992868013929382, 
                    -0.1917793523017606, 
                    -0.1917793523017606, 
                    -0.14756855166072158, 
                    0.25352769291643984, 
                    0.28482303937485953, 
                    -0.2203828310450834, 
                    -0.003057715370687303, 
                    -0.21391022911314977, 
                    -0.2381671755121124, 
                    -0.1917793523017606, 
                    0.12778806924532846, 
                    -0.10722063670712917, 
                    0.04233261780743067, 
                    0.28482303937485953, 
                    -0.031028125931928024, 
                    -0.21391022911314977, 
                    -0.17193770400338013, 
                    -0.2381671755121124, 
                    -0.11719381855270775, 
                    0.2992382208097889, 
                    -0.1780057683145679, 
                    0.025199264766684187, 
                    0.23885349334326475, 
                    0.2992382208097889, 
                    -0.1780057683145679, 
                    0.20009727242793493, 
                    -0.16014148662122116, 
                    0.35948861745893335, 
                    -0.2203828310450834, 
                    -0.10031461877266326, 
                    -0.04222206496080333, 
                    -0.2203828310450834, 
                    0.33742924239455907, 
                    -0.10074803477519553, 
                    -0.007843164727895813, 
                    0.35948861745893335, 
                    -0.07434416721759143, 
                    0.12389226457996824, 
                    0.2868417064999701, 
                    0.12866679357618385, 
                    -0.09266390813341316, 
                    0.35948861745893335, 
                    -0.005788956911205678, 
                    -0.13518741823615246, 
                    0.27875497506367164, 
                    0.12849151280536872, 
                    -0.16014148662122116, 
                    -0.08611070766993958, 
                    0.26975097773476897, 
                    -0.2381671755121124, 
                    -0.1917793523017606, 
                    0.3357769637324448, 
                    0.04565274472982542, 
                    -0.21022934017461026, 
                    -0.16014148662122116, 
                    -0.02909786104432041, 
                    0.32419535352441964, 
                    -0.1169219672928757, 
                    -0.16014148662122116, 
                    0.04233261780743067, 
                    -0.014006205497676477, 
                    -0.1780057683145679, 
                    0.33742924239455907, 
                    -0.1917793523017606, 
                    -0.1780057683145679, 
                    -0.1780057683145679, 
                    0.12576027126485037, 
                    0.07401272785235732, 
                    -0.17193770400338013, 
                    0.017522791633667795, 
                    -0.09634079711612992, 
                    0.27875497506367164, 
                    -0.13282068881219417, 
                    -0.04984555805499777, 
                    -0.2381671755121124, 
                    0.0024311360870238607, 
                    0.016342517416427532, 
                    -0.1780057683145679, 
                    -0.10837165691428738, 
                    0.2082334111083565, 
                    0.35948861745893335, 
                    -0.0877589721479416, 
                    -0.21022934017461026, 
                    -0.17193770400338013, 
                    0.12399783845598936, 
                    -0.21391022911314977, 
                    0.18588799328138464, 
                    0.19825366557418786, 
                    0.32419535352441964, 
                    -0.17193770400338013, 
                    0.05801841702262864, 
                    0.2115305578235759, 
                    -0.1461064455514508, 
                    -0.003057715370687303, 
                    -0.1917793523017606, 
                    -0.019992868013929382, 
                    0.34390184432649273, 
                    -0.10722063670712917, 
                    0.19948117919370476, 
                    0.2626165026219951, 
                    0.2992382208097889, 
                    0.12389226457996824, 
                    0.016342517416427532, 
                    -0.1780057683145679, 
                    -0.1169219672928757, 
                    -0.09460349942095714, 
                    -0.11984186301800667, 
                    0.2992382208097889, 
                    -0.2381671755121124, 
                    -0.21391022911314977, 
                    0.12849151280536872, 
                    -0.011104261360875695, 
                    -0.003057715370687303, 
                    -0.1917793523017606, 
                    0.060597922922007136, 
                    -0.09266390813341316, 
                    0.13026173027580215, 
                    -0.0877589721479416, 
                    0.35948861745893335, 
                    -0.11696661252919643, 
                    0.27875497506367164, 
                    0.05801841702262864, 
                    -0.12935151351851834, 
                    -0.0018467034197802434, 
                    0.26975097773476897, 
                    0.060597922922007136, 
                    0.060597922922007136, 
                    -0.02302979673313263, 
                    -0.10722063670712917, 
                    -0.07192503683623552, 
                    -0.2381671755121124, 
                    -0.2203828310450834, 
                    0.20520687352654035, 
                    0.194009639799774, 
                    -0.05507512802488573, 
                    -0.04984555805499777, 
                    -0.1780057683145679, 
                    0.2025222917566503, 
                    0.2626165026219951, 
                    0.05974903028905856, 
                    -0.2381671755121124, 
                    0.10673456830505182, 
                    -0.019992868013929382, 
                    0.07668418293230064, 
                    -0.2203828310450834, 
                    0.12399783845598936, 
                    -0.019992868013929382, 
                    -0.17193770400338013, 
                    0.2992382208097889, 
                    0.35948861745893335, 
                    -0.21391022911314977, 
                    -0.2381671755121124, 
                    0.12126659691547095, 
                    -0.12691327255577642, 
                    -0.09266390813341316, 
                    -0.07434416721759143, 
                    -0.1917793523017606, 
                    -0.2381671755121124, 
                    -0.1917793523017606, 
                    0.05801841702262864, 
                    0.27875497506367164, 
                    -0.1917793523017606, 
                    -0.21391022911314977, 
                    0.060597922922007136, 
                    -0.10722063670712917, 
                    0.27875497506367164, 
                    -0.06154772995681934, 
                    0.35193772859860784, 
                    -0.2381671755121124, 
                    -0.2381671755121124, 
                    -0.14978221720889642, 
                    -0.10722063670712917, 
                    0.05801841702262864, 
                    0.33742924239455907, 
                    -0.10563795191528297, 
                    -0.1169219672928757, 
                    0.32419535352441964, 
                    0.1372541723299431, 
                    -0.019992868013929382, 
                    0.03724190823252729, 
                    0.2527648746726684, 
                    0.16429311503540475, 
                    -0.019992868013929382, 
                    0.14269542390809245, 
                    -0.010286907158885944, 
                    -0.2381671755121124, 
                    -0.12935151351851834, 
                    -0.1917793523017606, 
                    0.24528970677853076, 
                    0.2407960324291514, 
                    -0.10722063670712917, 
                    -0.10563795191528297, 
                    -0.1780057683145679, 
                    0.2389475157931024, 
                    0.06237367314935857, 
                    0.33742924239455907, 
                    -0.16014148662122116, 
                    -0.019992868013929382, 
                    0.2992382208097889, 
                    0.09033822558386537, 
                    -0.21022934017461026, 
                    0.194009639799774, 
                    0.33742924239455907, 
                    0.2588329389838563, 
                    -0.16014148662122116, 
                    -0.1406336210193641, 
                    -0.007843164727895813, 
                    0.2025222917566503, 
                    -0.07176466131821296, 
                    0.13651105078085854, 
                    0.2527648746726684, 
                    0.12256753883732804, 
                    0.2860372248236742, 
                    0.27875497506367164, 
                    -0.031028125931928024, 
                    -0.2381671755121124, 
                    0.19825366557418786, 
                    -0.16014148662122116, 
                    0.21766223906295082, 
                    0.12849151280536872, 
                    -0.21391022911314977, 
                    -0.0877589721479416, 
                    0.1271498090398239, 
                    0.2677093335512917, 
                    -0.16014148662122116, 
                    -0.1780057683145679, 
                    -0.034753902508353834, 
                    0.2992382208097889, 
                    0.13026173027580215, 
                    -0.10722063670712917, 
                    -0.06798671006040091, 
                    0.055968830625445304, 
                    0.19802861740727093, 
                    0.19948117919370476, 
                    -0.1917793523017606, 
                    -0.003057715370687303, 
                    -0.1780057683145679, 
                    -0.1300086796350306, 
                    -0.09266390813341316, 
                    -0.12935151351851834, 
                    -0.09266390813341316, 
                    0.12399783845598936, 
                    -0.2203828310450834, 
                    0.060597922922007136, 
                    -0.10722063670712917, 
                    -0.01165710580192314, 
                    0.2082334111083565, 
                    0.19825366557418786, 
                    -0.1917793523017606, 
                    -0.10722063670712917, 
                    -0.1169219672928757, 
                    -0.09266390813341316, 
                    -0.07176466131821296, 
                    0.23490984540197243, 
                    -0.007843164727895813, 
                    0.060597922922007136, 
                    -0.007843164727895813, 
                    -0.10722063670712917, 
                    0.33742924239455907, 
                    0.295432107301695, 
                    -0.10031461877266326, 
                    0.06175950664070459, 
                    -0.2203828310450834, 
                    -0.10722063670712917, 
                    -0.019992868013929382, 
                    -0.2203828310450834, 
                    0.04233261780743067, 
                    0.18834011712836227, 
                    0.11539844802475349, 
                    -0.17193770400338013, 
                    0.12996032889115613, 
                    0.04367608769725548, 
                    -0.2381671755121124, 
                    -0.10074803477519553, 
                    -0.1169219672928757, 
                    -0.08337946612942118, 
                    0.17991181482991922, 
                    -0.0877589721479416, 
                    0.04665596550844334, 
                    0.18942922697603512, 
                    -0.2203828310450834, 
                    -0.21022934017461026, 
                    -0.13661569309789945, 
                    0.23490984540197243, 
                    -0.1169219672928757, 
                    0.2992382208097889, 
                    -0.04984555805499777, 
                    -0.17236518092880257, 
                    -0.21391022911314977, 
                    0.04710714680364628, 
                    -0.2381671755121124, 
                    -0.05875089968233135, 
                    -0.19875346532524527, 
                    -0.2381671755121124, 
                    -0.02909786104432041, 
                    0.13026173027580215, 
                    -0.10031461877266326, 
                    -0.1461064455514508, 
                    0.055968830625445304, 
                    0.06248027182957691, 
                    0.024925936092723505, 
                    -0.003057715370687303, 
                    -0.043079842526206585, 
                    -0.13661569309789945, 
                    0.2527648746726684, 
                    -0.09037805723084266, 
                    -0.1780057683145679, 
                    0.06175950664070459, 
                    0.34390184432649273, 
                    -0.1780057683145679, 
                    -0.2381671755121124, 
                    -0.11696661252919643, 
                    0.20196254881238798, 
                    0.12778806924532846, 
                    -0.1917793523017606, 
                    -0.007843164727895813, 
                    0.1180609993342687, 
                    -0.09266390813341316, 
                    0.194009639799774, 
                    0.12399783845598936, 
                    0.04710714680364628, 
                    -0.21022934017461026, 
                    -0.1917793523017606, 
                    -0.1780057683145679, 
                    -0.16014148662122116, 
                    0.1079190965655065, 
                    0.049387207048961684, 
                    -0.007843164727895813, 
                    -0.11984186301800667, 
                    -0.16014148662122116, 
                    -0.1780057683145679, 
                    -0.07176466131821296, 
                    0.24528970677853076, 
                    -0.1780057683145679, 
                    0.35948861745893335, 
                    -0.2381671755121124, 
                    -0.1917793523017606, 
                    -0.07842882701261583, 
                    -0.019992868013929382, 
                    0.060597922922007136, 
                    -0.1917793523017606, 
                    -0.1780057683145679, 
                    -0.10722063670712917, 
                    0.12849151280536872, 
                    -0.16111982421103266, 
                    -0.1917793523017606, 
                    0.27875497506367164, 
                    -0.19875346532524527, 
                    -0.04222206496080333, 
                    -0.09266390813341316, 
                    0.0540379109373523, 
                    0.13026173027580215, 
                    0.2662342068751854, 
                    -0.019992868013929382, 
                    -0.0877589721479416, 
                    -0.16014148662122116, 
                    0.295432107301695, 
                    -0.07176466131821296, 
                    -0.0877589721479416, 
                    -0.1917793523017606, 
                    0.33742924239455907, 
                    0.20882388399026144, 
                    -0.2381671755121124, 
                    -0.01615078015130253, 
                    0.2504322858371857, 
                    -0.1917793523017606, 
                    -0.1406336210193641, 
                    -0.10722063670712917, 
                    -0.16014148662122116, 
                    -0.2381671755121124, 
                    -0.14756855166072158, 
                    0.12576027126485037, 
                    0.1180609993342687, 
                    -0.09037805723084266, 
                    0.2992382208097889, 
                    -0.1780057683145679, 
                    0.19825366557418786, 
                    0.052476276403617766, 
                    0.04823225062920386, 
                    0.21434573147803562, 
                    -0.16014148662122116, 
                    -0.0362834115923332, 
                    0.025129939170534382, 
                    -0.17193770400338013, 
                    -0.10657528946281683, 
                    0.19514034632774133, 
                    0.35948861745893335, 
                    -0.019992868013929382, 
                    -0.003057715370687303, 
                    0.2082334111083565, 
                    -0.013751078217822232, 
                    -0.09266390813341316, 
                    0.295432107301695, 
                    0.12126659691547095, 
                    -0.019992868013929382, 
                    0.27875497506367164, 
                    -0.10722063670712917, 
                    0.20009727242793493, 
                    -0.10031461877266326, 
                    0.055968830625445304, 
                    -0.2381671755121124, 
                    -0.10722063670712917, 
                    0.04816976204663484, 
                    -0.16014148662122116, 
                    -0.12009576268950853, 
                    0.35948861745893335, 
                    -0.16014148662122116, 
                    0.35193772859860784, 
                    0.2677093335512917, 
                    0.13590971576371788, 
                    -0.003057715370687303, 
                    -0.07176466131821296, 
                    0.17224235121194212, 
                    0.2992382208097889, 
                    -0.16014148662122116, 
                    -0.13518741823615246, 
                    -0.019992868013929382, 
                    -0.08337946612942118, 
                    -0.1917793523017606, 
                    -0.12205944345849305, 
                    -0.09266390813341316, 
                    -0.015261508350130432, 
                    0.35948861745893335, 
                    -0.2381671755121124, 
                    -0.1917793523017606, 
                    -0.014006205497676477, 
                    0.295432107301695, 
                    0.014644780818381747, 
                    -0.09266390813341316, 
                    -0.19875346532524527, 
                    -0.2203828310450834, 
                    -0.019992868013929382, 
                    0.27875497506367164, 
                    0.26975097773476897, 
                    -0.19875346532524527, 
                    -0.2203828310450834, 
                    -0.2203828310450834, 
                    -0.17193770400338013, 
                    -0.13518741823615246, 
                    0.06248027182957691, 
                    -0.1917793523017606, 
                    0.194009639799774, 
                    0.04281638120662082, 
                    -0.003057715370687303, 
                    0.13651105078085854, 
                    -0.04222206496080333, 
                    0.06032621749087538, 
                    -0.1917793523017606, 
                    -0.16014148662122116, 
                    -0.034753902508353834, 
                    0.13820174955871303, 
                    -0.1780057683145679, 
                    -0.09460349942095714, 
                    -0.16014148662122116, 
                    0.2082334111083565, 
                    -0.10074803477519553, 
                    -0.1406336210193641, 
                    -0.10657528946281683, 
                    0.25352769291643984, 
                    0.295432107301695, 
                    0.11823622311593482, 
                    -0.09460349942095714, 
                    -0.17193770400338013, 
                    0.2321966419979156, 
                    0.03433611709987225, 
                    -0.1169219672928757, 
                    -0.16014148662122116, 
                    -0.1917793523017606, 
                    -0.10722063670712917, 
                    0.20009727242793493, 
                    -0.1780057683145679, 
                    0.060597922922007136 
)
)

