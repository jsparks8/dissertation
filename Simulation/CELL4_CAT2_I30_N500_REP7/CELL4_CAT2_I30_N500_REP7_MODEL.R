model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.140593, 1);
tau[2,2] ~ dlnorm(-0.289001, 1);
tau[3,2] ~ dlnorm(-0.165848, 1);
tau[4,2] ~ dlnorm(-0.164988, 1);
tau[5,2] ~ dlnorm(-0.33469, 1);
tau[6,2] ~ dlnorm(-0.084058, 1);
tau[7,2] ~ dlnorm(-0.450718, 1);
tau[8,2] ~ dlnorm(-0.180855, 1);
tau[9,2] ~ dlnorm(-0.432065, 1);
tau[10,2] ~ dlnorm(-0.410946, 1);
tau[11,2] ~ dlnorm(-0.415409, 1);
tau[12,2] ~ dlnorm(-0.233297, 1);
tau[13,2] ~ dlnorm(-0.556348, 1);
tau[14,2] ~ dlnorm(-0.469902, 1);
tau[15,2] ~ dlnorm(-0.493409, 1);
tau[16,2] ~ dlnorm(-0.448532, 1);
tau[17,2] ~ dlnorm(-0.418619, 1);
tau[18,2] ~ dlnorm(-0.470162, 1);
tau[19,2] ~ dlnorm(-0.232999, 1);
tau[20,2] ~ dlnorm(-0.400753, 1);
tau[21,2] ~ dlnorm(-0.361607, 1);
tau[22,2] ~ dlnorm(-0.278594, 1);
tau[23,2] ~ dlnorm(-0.336279, 1);
tau[24,2] ~ dlnorm(-0.267288, 1);
tau[25,2] ~ dlnorm(-0.136373, 1);
tau[26,2] ~ dlnorm(-0.038743, 1);
tau[27,2] ~ dlnorm(-0.286135, 1);
tau[28,2] ~ dlnorm(-0.108858, 1);
tau[29,2] ~ dlnorm(-0.047255, 1);
tau[30,2] ~ dlnorm(-0.271066, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.3730060981685117, 
                    -0.9329870121757905, 
                    -1.2934419375650652, 
                    -1.2961189603018668, 
                    -0.8101537556899089, 
                    -1.558569357208229, 
                    -0.5223080244486044, 
                    -1.2471053064151214, 
                    -0.56635947329826, 
                    -0.6172365798598805, 
                    -0.6063972263738424, 
                    -1.0905408124283795, 
                    -0.2877736550019558, 
                    -0.4778524139845543, 
                    -0.42452761659174687, 
                    -0.5274285234967088, 
                    -0.5986273956898902, 
                    -0.47725541210731914, 
                    1.0914074118973471, 
                    0.6421797284451574, 
                    0.7403720040118887, 
                    0.9617602677896565, 
                    0.8059816288271967, 
                    0.9933576458380452, 
                    1.38649750258064, 
                    1.7150695082723462, 
                    0.9408820516884137, 
                    1.4758755463438291, 
                    1.6851308322150298, 
                    0.9827608350908411 ),
tau=matrix(c( NA,1.432479738077662, 
                    NA,1.23491116846693, 
                    NA,1.3967554299667144, 
                    NA,1.3979574131755381, 
                    NA,1.1797590363047692, 
                    NA,1.515797641386495, 
                    NA,1.0505163029774234, 
                    NA,1.3759502825803895, 
                    NA,1.0702954035109187, 
                    NA,1.0931392243570863, 
                    NA,1.0882723546418553, 
                    NA,1.3056528247803425, 
                    NA,0.9452103710958781, 
                    NA,1.030555733879065, 
                    NA,1.0066128998496944, 
                    NA,1.0528154070500224, 
                    NA,1.0847837006647607, 
                    NA,1.0302876800361864, 
                    NA,1.3060419279419089, 
                    NA,1.1043386980718757, 
                    NA,1.1484270298013382, 
                    NA,1.2478303602375558, 
                    NA,1.1778857513434113, 
                    NA,1.2620175829812823, 
                    NA,1.4385373786587075, 
                    NA,1.5860662092142834, 
                    NA,1.2384560412080978, 
                    NA,1.4786681203083794, 
                    NA,1.5726237436645485, 
                    NA,1.2572596149557878 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 0.026476022742874306, 
                    0.24889237072811377, 
                    0.0408459984318153, 
                    0.18425951377654604, 
                    0.21353389263509903, 
                    -0.17727337499361995, 
                    0.2317157907665539, 
                    -0.15568937959857107, 
                    0.18940876147524865, 
                    -0.1025494166462769, 
                    0.12142389039768248, 
                    0.03310427765605234, 
                    -0.027242401508347613, 
                    0.1864606700658753, 
                    -0.12941434176110297, 
                    -0.1536262007266041, 
                    -0.13516205219815414, 
                    0.10491186117730056, 
                    0.10221068230120994, 
                    -0.0817947312019171, 
                    -0.1890518049814853, 
                    0.11162779068298423, 
                    0.26994027538833565, 
                    -0.15758856283344058, 
                    0.2717439687648072, 
                    -0.1149777880831225, 
                    0.19916737937453632, 
                    -0.15557539256406175, 
                    0.00336569695941652, 
                    0.13113096536616914, 
                    -0.2026371700632326, 
                    -0.1543260361661215, 
                    -0.0744700596479052, 
                    -0.04915751888336678, 
                    0.07940713030963426, 
                    -0.09076253184427496, 
                    -0.0837472953993895, 
                    0.11280647698666929, 
                    -0.2715748255723802, 
                    -0.19006893610346373, 
                    -0.09874133045992761, 
                    -0.1670987406407105, 
                    0.25547021554134874, 
                    0.004839258868043594, 
                    -0.07400742494126955, 
                    0.12476124778927805, 
                    0.17542703560773099, 
                    -0.29145970215060824, 
                    -0.17007464279196877, 
                    0.003675396251515417, 
                    0.20524385360798525, 
                    -0.2364638447976238, 
                    0.1605265676498282, 
                    -0.19476287167368833, 
                    0.051208633977494866, 
                    -0.2230768713386581, 
                    -0.041451933865082835, 
                    -0.0792699335150262, 
                    -0.2397778342443908, 
                    0.1325480246808307, 
                    -0.278395658671647, 
                    0.05610040802690275, 
                    -0.006105407078212832, 
                    -0.054614079940331794, 
                    -0.21194812241687816, 
                    0.02756047615503987, 
                    0.23748101160945478, 
                    -0.227337591690897, 
                    0.08422189690942933, 
                    -0.1326856484289682, 
                    -0.1367437322047635, 
                    0.20062119217592655, 
                    -0.12190162703755555, 
                    -0.1956404888497464, 
                    -0.06175488922132244, 
                    -0.03020252695086767, 
                    -0.19068430914439813, 
                    -0.26455380520724114, 
                    -0.21922742423795288, 
                    0.26785171593802937, 
                    0.15970158855500544, 
                    0.21353389263509903, 
                    -0.25978593745334577, 
                    -0.27720286929024796, 
                    -0.09409882747839327, 
                    -0.21198350900842203, 
                    0.1202090845611124, 
                    -0.22182956804473547, 
                    0.15702283480421148, 
                    0.10838694220921202, 
                    -0.131988860511927, 
                    0.018157060604436392, 
                    0.19051130522481952, 
                    -0.009985056492107569, 
                    0.10994401475965326, 
                    -0.015488787075504107, 
                    -0.15589255982456862, 
                    0.04321746367099705, 
                    -0.17090588667027612, 
                    0.006879523274910093, 
                    0.014308947168935882, 
                    -0.09499253740952737, 
                    -0.08767902413960621, 
                    0.26785171593802937, 
                    0.05306108447673996, 
                    0.050430758931013064, 
                    0.1231236529238286, 
                    0.042397893769344164, 
                    0.180449216088167, 
                    -0.189487362331269, 
                    0.01106790077956532, 
                    -0.27304568097298026, 
                    -0.053686077275943045, 
                    -0.024747165219485945, 
                    0.20269151126676044, 
                    -0.028913193954609617, 
                    -0.2690558231609915, 
                    -0.04317100100481053, 
                    0.22267308892339266, 
                    -0.15481799736772076, 
                    0.13380002791000406, 
                    0.04194988124783777, 
                    -0.14873966842848885, 
                    -0.14202225805080182, 
                    -0.2516909936928396, 
                    0.15006022728966956, 
                    -0.25333106531163485, 
                    0.2498935400201513, 
                    0.17513748200012724, 
                    0.0022262654712313368, 
                    0.007047753775337229, 
                    -0.2580020989453162, 
                    0.015118084845031021, 
                    0.018776762290661164, 
                    -0.1983728600743669, 
                    0.24080627560557977, 
                    0.2206961301320104, 
                    -0.15977777442687355, 
                    -0.3266899903583926, 
                    0.23690213779240177, 
                    -0.09555367804439274, 
                    -0.2601243660112048, 
                    -0.2642171934444744, 
                    0.1274420333052167, 
                    -0.11423824449611666, 
                    -0.09439941220370626, 
                    -0.06624313520525399, 
                    -0.2223935928689999, 
                    -0.12733366700858548, 
                    -0.18577067777243336, 
                    -0.24634467261117696, 
                    0.22423619148565221, 
                    0.25236217095976266, 
                    -0.12161744364618221, 
                    0.0067123543246147555, 
                    -0.15364510797138559, 
                    0.058940321465206, 
                    0.17080115827925124, 
                    -0.06898107414962273, 
                    -0.022426051321129847, 
                    -0.21241956605613221, 
                    0.2302624488013384, 
                    0.2345252364359427, 
                    -0.22196406106591396, 
                    -0.12701252159471482, 
                    0.25781259256869027, 
                    0.22526064378448152, 
                    0.028962223273135523, 
                    0.25660123288865166, 
                    -0.19155035764219225, 
                    -0.21889361056758494, 
                    0.24080627560557977, 
                    0.11616257533016, 
                    0.03314192959051199, 
                    0.25013988896301587, 
                    -0.06568015579293651, 
                    0.04949718968492939, 
                    0.19781335687040424, 
                    -0.08581550547093966, 
                    0.010132840633443219, 
                    0.07225334685274382, 
                    0.1608090082901098, 
                    0.15869213158881468, 
                    -0.11410415200394658, 
                    -0.2371629361544409, 
                    -0.033936527206407774, 
                    0.13203813486305332, 
                    0.13924290136564427, 
                    0.14322498541198564, 
                    -0.2172322203653951, 
                    -0.12785093990260138, 
                    -0.15956555917614204, 
                    0.1795918245459749, 
                    0.11878621045626081, 
                    -0.13467032274536953, 
                    -0.0468926325522277, 
                    0.07316619158158177, 
                    0.11556630100854337, 
                    -0.09228422835579458, 
                    0.09910424148172181, 
                    -0.12068022137907661, 
                    0.05913762418867102, 
                    -0.252711012911106, 
                    0.2541569142069702, 
                    -0.15692425826371714, 
                    -0.17447862788953034, 
                    -0.10231732406016192, 
                    -0.021391142314397482, 
                    0.023340455151175, 
                    0.19882354568574478, 
                    0.17741224926420762, 
                    -0.2689521522831423, 
                    -0.19315447427870377, 
                    0.20814844296525725, 
                    -0.037424970070716046, 
                    0.23967025263805564, 
                    -0.18238503605561393, 
                    -0.07668330265229156, 
                    0.15652658361885957, 
                    -0.2730277410924707, 
                    0.2688077158184524, 
                    0.24798242179457763, 
                    -0.21649390722888867, 
                    0.21559719607381322, 
                    0.008256958815539783, 
                    0.1076631091376658, 
                    -0.12864280308297463, 
                    -0.03811662372488739, 
                    0.025422475133022204, 
                    0.1279177021777752, 
                    -0.02192302919770528, 
                    -0.2651457691909386, 
                    -0.2438780366851389, 
                    -0.03834557240224612, 
                    0.24824324698661704, 
                    0.24945460666665564, 
                    0.08671869104367963, 
                    0.1726253278793255, 
                    0.03014694135099949, 
                    0.11502088739936966, 
                    0.1488841712071926, 
                    0.2216625564464464, 
                    -0.16385825623364425, 
                    0.2542732891853362, 
                    -0.3278049483892679, 
                    0.03400112729054999, 
                    -0.1452604765113953, 
                    -0.08203044150833977, 
                    0.03216603149016656, 
                    -0.04056282165580183, 
                    0.2889252467903606, 
                    0.17353457583972798, 
                    0.23593680658627447, 
                    0.25919722405657486, 
                    0.21359635217979422, 
                    0.04420081083442812, 
                    -0.07017457206278488, 
                    0.2542732891853362, 
                    -0.12992652980467173, 
                    0.2889252467903606, 
                    0.07099385871276603, 
                    0.160943165119588, 
                    -0.06026716789946496, 
                    0.1493638645409674, 
                    0.08025248085902836, 
                    -0.07007524091188305, 
                    0.25158816359599157, 
                    0.05188207887367391, 
                    0.0729526110062087, 
                    -0.06534501855407604, 
                    0.2076491574182594, 
                    -0.1289599975375221, 
                    0.27005935676154735, 
                    0.26785171593802937, 
                    0.08276392999281373, 
                    0.09203306759794405, 
                    -0.1774697077998743, 
                    -0.11296850790057711, 
                    -0.08639327181871095, 
                    -0.15719471627442555, 
                    -0.05506618585656614, 
                    -0.20739581012796038, 
                    0.1443637691273179, 
                    -0.11156806595960161, 
                    -0.2654179096784855, 
                    -0.03271614670296419, 
                    -0.021825334868585455, 
                    0.023291491806065878, 
                    -0.053078698063243834, 
                    0.0880741300877858, 
                    0.2236073055269081, 
                    0.02860993579485166, 
                    0.1079864232948396, 
                    0.22241618197690416, 
                    0.27791435027276223, 
                    -0.09698243753444924, 
                    0.1798467606895363, 
                    -0.004857070529645402, 
                    0.2330364488190373, 
                    -0.08874315804199781, 
                    -0.1059582274427674, 
                    -0.02417245020016945, 
                    0.10186677590975896, 
                    0.05110621783327096, 
                    0.11558173375658165, 
                    -0.07465587526856526, 
                    -0.13237814163267267, 
                    -0.013445465572390014, 
                    0.20476360568943708, 
                    0.019181139543820003, 
                    -0.0118121777980571, 
                    -0.24158229979790397, 
                    -0.18686478761590927, 
                    0.19681603779521228, 
                    0.0170047560210555, 
                    0.16898754845681024, 
                    -0.22895408479393609, 
                    0.25704430870222306, 
                    -0.23736567356350957, 
                    -0.21320566642342595, 
                    -0.02359275262764593, 
                    -0.1515943385615171, 
                    0.07641576401847339, 
                    0.027952612373753738, 
                    -0.20661315538569747, 
                    0.25158816359599157, 
                    0.0953620449813603, 
                    0.13079823530437695, 
                    0.21370280199779368, 
                    -0.020729109640534316, 
                    0.11806164871823205, 
                    0.09378946974815433, 
                    -0.2631433668777824, 
                    0.14040682821700545, 
                    0.011329164201836606, 
                    0.06558312468151928, 
                    0.1516738505877755, 
                    -0.24635354608526155, 
                    0.10659804418746838, 
                    0.23157922479532456, 
                    -0.30271062438210294, 
                    -0.2057102338730894, 
                    -0.11320843945996145, 
                    0.13776062612798545, 
                    2.8034439357504937e-5, 
                    -0.24542316982268525, 
                    0.22181510229564694, 
                    -0.16763227652109358, 
                    0.06652506558071153, 
                    0.08982467342450928, 
                    0.09056941403049917, 
                    0.1523199387408194, 
                    -0.11633545397234976, 
                    -0.06520227562125419, 
                    -0.017618784729035053, 
                    0.050530347607295134, 
                    -0.10043101982646155, 
                    -0.24916381562364903, 
                    0.061985479197228355, 
                    0.0923066847711127, 
                    0.047142449805337105, 
                    -0.0625667382533951, 
                    -0.01589811326951074, 
                    -0.0954205156193293, 
                    0.11939106184618098, 
                    -0.17849310113973238, 
                    0.15662542805681196, 
                    -0.1293603057757119, 
                    0.16059079180971791, 
                    -0.08182221222120639, 
                    0.16128367950464279, 
                    -0.09614540396174415, 
                    0.12646921240218323, 
                    -0.016329196379567312, 
                    -0.04612767355907621, 
                    -0.14025209148906145, 
                    -0.08409852185260194, 
                    0.09621316663207097, 
                    0.1264222970413682, 
                    0.06680494876939386, 
                    0.1891247889006088, 
                    0.13216345181139888, 
                    -0.1629680550012238, 
                    0.18846920379944887, 
                    -0.0311618446348928, 
                    0.06767888159457985, 
                    0.14230575098921883, 
                    0.2066697528021445, 
                    -0.16305627500023412, 
                    0.26903490446271827, 
                    0.1689137282918063, 
                    -0.1432736136212575, 
                    0.00879253546271086, 
                    0.18859186448035792, 
                    -0.06683623713761361, 
                    -0.13337204771313335, 
                    -0.1615212771476832, 
                    0.03886803419521523, 
                    -0.004991477579074699, 
                    0.15006022728966956, 
                    0.10115585268987581, 
                    -0.2517105261495233, 
                    0.09067260396356885, 
                    -0.20475518811566096, 
                    0.03147899741010529, 
                    0.24455289033646888, 
                    0.20256915882202253, 
                    -0.20194666972505024, 
                    0.028322710344952984, 
                    0.06010727946558553, 
                    -0.11610829885422702, 
                    0.026188183781971686, 
                    0.07146517488912696, 
                    0.17003691560500023, 
                    -0.24701750127932962, 
                    0.16208613021128976, 
                    -0.06456607402971515, 
                    0.24889237072811377, 
                    -0.12269309017649441, 
                    -0.2629370179617072, 
                    0.1813761241283398, 
                    -0.08795744261249339, 
                    0.11981308462404128, 
                    0.2889252467903606, 
                    0.2540852849796198, 
                    0.27791435027276223, 
                    -0.2778151596680955, 
                    0.06873828651969227, 
                    -0.13386068640613788, 
                    0.15688080431065837, 
                    -0.08803801628214286, 
                    0.15779710492228727, 
                    0.22526064378448152, 
                    0.056303083071834625, 
                    0.14853239180001288, 
                    0.2334512917008814, 
                    0.13135709200287926, 
                    -0.1413496054551566, 
                    -0.16837092218853672, 
                    -0.03084559020482258, 
                    -0.06957275492624643, 
                    -0.27373482178355796, 
                    0.24222678744015202, 
                    0.22761096100294487, 
                    -0.18552958696429903, 
                    0.1349386327838713, 
                    -0.22046663975919184, 
                    -0.23382647306589366, 
                    0.06066646192036662, 
                    -0.23615130070782497, 
                    -0.2650933664756586, 
                    -0.16092024783536457, 
                    -0.15220336341761517, 
                    -0.17810298846303405, 
                    0.1436354667268992, 
                    -0.08237470650297662, 
                    0.0958134958480078, 
                    0.04262935618404423, 
                    -0.14135213532249694, 
                    -0.09703658527036643, 
                    -0.08693788998761745, 
                    0.1034196344251927, 
                    0.1760552205178283, 
                    0.23416835664291769, 
                    0.1721719247453663, 
                    0.23175458416863104, 
                    -0.08423661757038328, 
                    -0.004359036517073311, 
                    -0.2632023790550113, 
                    0.27005935676154735, 
                    -0.041574874920615845, 
                    0.1832142406226004, 
                    -0.22626479010632766, 
                    -0.23895509494520412, 
                    0.17542069298109808, 
                    -0.2600506323417199, 
                    -0.043095889643280816, 
                    -0.03424807648380773, 
                    0.21839181939178998, 
                    0.11577575151106656, 
                    0.04319530758149004, 
                    -0.0451323497863928, 
                    -0.1672487264299063, 
                    -0.063071675110750125, 
                    -0.16549653564925204, 
                    -0.027975890281881632, 
                    -0.07397437602529722, 
                    -0.158408107079653, 
                    -0.20181422840345373, 
                    -0.19598668078046091, 
                    -0.07400849448122943, 
                    -0.2654179096784855, 
                    0.23907598249880724, 
                    0.06271910425511124, 
                    -0.23272829905895848, 
                    -0.21024902685198715, 
                    0.21700286881804487, 
                    -0.25071938318859993, 
                    0.2203578782719342, 
                    -0.10343442570972525 
)
)

