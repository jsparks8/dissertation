model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.026532, 1);
tau[1,3] ~ dlnorm(-0.15662, 1);
tau[1,4] ~ dlnorm(-0.306199, 1);
tau[1,5] ~ dlnorm(-0.482154, 1);
tau[1,6] ~ dlnorm(-0.695823, 1);
tau[2,2] ~ dlnorm(0.210985, 1);
tau[2,3] ~ dlnorm(0.089722, 1);
tau[2,4] ~ dlnorm(-0.048302, 1);
tau[2,5] ~ dlnorm(-0.208474, 1);
tau[2,6] ~ dlnorm(-0.399287, 1);
tau[3,2] ~ dlnorm(0.144265, 1);
tau[3,3] ~ dlnorm(0.020738, 1);
tau[3,4] ~ dlnorm(-0.120227, 1);
tau[3,5] ~ dlnorm(-0.284376, 1);
tau[3,6] ~ dlnorm(-0.480866, 1);
tau[4,2] ~ dlnorm(0.143675, 1);
tau[4,3] ~ dlnorm(0.020127, 1);
tau[4,4] ~ dlnorm(-0.120865, 1);
tau[4,5] ~ dlnorm(-0.285051, 1);
tau[4,6] ~ dlnorm(-0.481593, 1);
tau[5,2] ~ dlnorm(-0.422289, 1);
tau[5,3] ~ dlnorm(-0.572944, 1);
tau[5,4] ~ dlnorm(-0.750392, 1);
tau[5,5] ~ dlnorm(-0.966269, 1);
tau[5,6] ~ dlnorm(-1.241956, 1);
tau[6,2] ~ dlnorm(-0.324414, 1);
tau[6,3] ~ dlnorm(-0.469159, 1);
tau[6,4] ~ dlnorm(-0.638458, 1);
tau[6,5] ~ dlnorm(-0.842381, 1);
tau[6,6] ~ dlnorm(-1.098828, 1);
tau[7,2] ~ dlnorm(-0.000616, 1);
tau[7,3] ~ dlnorm(-0.129632, 1);
tau[7,4] ~ dlnorm(-0.277794, 1);
tau[7,5] ~ dlnorm(-0.451791, 1);
tau[7,6] ~ dlnorm(-0.662577, 1);
tau[8,2] ~ dlnorm(0.060406, 1);
tau[8,3] ~ dlnorm(-0.066198, 1);
tau[8,4] ~ dlnorm(-0.211185, 1);
tau[8,5] ~ dlnorm(-0.380817, 1);
tau[8,6] ~ dlnorm(-0.585224, 1);
tau[9,2] ~ dlnorm(0.079103, 1);
tau[9,3] ~ dlnorm(-0.046791, 1);
tau[9,4] ~ dlnorm(-0.190849, 1);
tau[9,5] ~ dlnorm(-0.359209, 1);
tau[9,6] ~ dlnorm(-0.561769, 1);
tau[10,2] ~ dlnorm(0.043824, 1);
tau[10,3] ~ dlnorm(-0.08342, 1);
tau[10,4] ~ dlnorm(-0.229248, 1);
tau[10,5] ~ dlnorm(-0.400034, 1);
tau[10,6] ~ dlnorm(-0.606119, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 0.8422217671847512, 
                    1.4742976835122963, 
                    1.2813321119372734, 
                    1.2796818597691708, 
                    0.07167411151026915, 
                    0.23486649081767308, 
                    -0.9041214067327985, 
                    -1.0563622312277445, 
                    -1.1048995560408315, 
                    -1.0140699481031419 ),
tau=matrix(c( NA,1.6055530234528157,1.4097041609561,1.2138552984593844,1.0180064359626688,0.8221575734659532, 
                    NA,2.0359967224718734,1.8034874568281605,1.5709781911844474,1.3384689255407343,1.1059596598970212, 
                    NA,1.904587168229283,1.6832699057369211,1.4619526432445593,1.2406353807521975,1.0193181182598356, 
                    NA,1.9034633465028057,1.6822417986361937,1.4610202507695818,1.2397987029029698,1.0185771550363578, 
                    NA,1.0808100699384933,0.9296529714708976,0.778495873003302,0.6273387745357064,0.4761816760681108, 
                    NA,1.1919440802468353,1.0313218237794102,0.8706995673119853,0.7100773108445603,0.5494550543771353, 
                    NA,1.6477066779850358,1.4482676363945335,1.2488285948040312,1.049389553213529,0.8499505116230266, 
                    NA,1.751382679466094,1.5431136700548849,1.3348446606436757,1.1265756512324665,0.9183066418212573, 
                    NA,1.7844365976638066,1.5733524234134384,1.36226824916307,1.1511840749127016,0.9400999006623334, 
                    NA,1.7225816346582399,1.5167655776682576,1.3109495206782753,1.105133463688293,0.8993174066983107 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.6147670431315482, 
                    -0.453466802681838, 
                    -0.008299520528716853, 
                    0.5017519391405554, 
                    -0.43738859352570036, 
                    0.0872315326031986, 
                    -0.2537107170449268, 
                    -0.0746269738087677, 
                    -0.12823506551457042, 
                    0.738398228621119, 
                    -0.2765964759912259, 
                    -0.049036213884950386, 
                    0.4025646180625575, 
                    0.6287794028698306, 
                    -0.4879881256986604, 
                    0.23928009438703646, 
                    0.006286375128706778, 
                    0.5598466969020235, 
                    -0.5090695145786316, 
                    -0.04073255167841905, 
                    -0.37050064298582636, 
                    -0.28906044269096937, 
                    -0.07221009400304224, 
                    0.18278050629550469, 
                    -0.4452722678604774, 
                    -0.0254986068835118, 
                    -0.10991411285082842, 
                    -0.40774043755985706, 
                    -0.44970054873360743, 
                    0.15948347633635995, 
                    -0.466381812821618, 
                    -0.4118121471852642, 
                    -0.04323394439081085, 
                    0.29435050954771147, 
                    -0.12401044232531466, 
                    -0.3043542042052078, 
                    0.18482871531210587, 
                    -0.4232938031682595, 
                    -0.4390674750958905, 
                    -0.05150050048380084, 
                    -0.27842150375708746, 
                    0.3954519236633396, 
                    0.5431310513554497, 
                    0.046220312626840565, 
                    0.154549005898857, 
                    -0.17038966826894042, 
                    0.505900307615418, 
                    -0.5181535481645901, 
                    -0.12030328928324407, 
                    -0.0982327427728854, 
                    0.2742057100957058, 
                    0.5677133287159217, 
                    -0.2193803678175641, 
                    0.06117736659779949, 
                    0.4024754172586775, 
                    0.08108760781171831, 
                    -0.4445987634855335, 
                    0.4827302590303333, 
                    0.15555984631826436, 
                    0.34448433435216974, 
                    0.23378124213955587, 
                    0.5798975017885155, 
                    -0.34787883064288627, 
                    -0.11672749160703189, 
                    0.03547899549378364, 
                    0.4140506026375017, 
                    0.5831023877281067, 
                    -0.27339364692281093, 
                    -0.2252115035932845, 
                    0.09469007605846991, 
                    -0.549483770423928, 
                    -0.3990417686983482, 
                    -0.45945071426886364, 
                    -0.14934824798638902, 
                    -0.18464941799119727, 
                    0.25860322604742525, 
                    0.04270013379238835, 
                    -0.5198236872497327, 
                    0.6372203896271256, 
                    0.031105825286657396, 
                    -0.0056482510708697475, 
                    0.11004438386052995, 
                    0.684266951759112, 
                    0.36870037541286105, 
                    -0.09248231230800563, 
                    -0.11772486473261823, 
                    -0.12641803286835218, 
                    0.1266897972391039, 
                    0.08840221044959362, 
                    -0.1927603228389323, 
                    0.40129458727315304, 
                    -0.5410127829797554, 
                    -0.2721599002118111, 
                    0.1308318260288025, 
                    0.6906743463988274, 
                    -0.189911410770626, 
                    0.20814165965094522, 
                    0.5523765431182355, 
                    -0.15981918690558594, 
                    0.5136255560986362, 
                    -0.22849698383705525, 
                    -0.4678643351177431, 
                    0.47967328463477066, 
                    0.7243374442189419, 
                    0.051999455885226475, 
                    -0.2433334978922298, 
                    -0.014447001845501295, 
                    -0.3503270750712009, 
                    0.4345997501254115, 
                    0.37892387832856667, 
                    -0.39725881055179896, 
                    0.281907037359559, 
                    0.5277991474012615, 
                    -0.3792264129326682, 
                    -0.0672200815981221, 
                    0.09588513771093721, 
                    0.39999336219784776, 
                    0.2305504079670183, 
                    -0.027466854929940943, 
                    0.12437400238200336, 
                    0.3120148332567262, 
                    -0.13847395594203316, 
                    0.1439076968640184, 
                    0.753433669697616, 
                    -0.1571069893142289, 
                    0.7514927632421102, 
                    0.6334850042773053, 
                    0.538450797396715, 
                    -0.5638075245883524, 
                    -0.2965953681325261, 
                    -0.15401418560198799, 
                    -0.4538280465345898, 
                    0.2655686619442441, 
                    0.06663238541236394, 
                    -0.24685437000068877, 
                    0.6611939749346176, 
                    -0.6430881609298555, 
                    -0.24721295924059822, 
                    -0.5051866757579819, 
                    -0.12133280143465475, 
                    -0.15285792744811172, 
                    -0.421931162260402, 
                    -0.31608915305712576, 
                    -0.38006471510018924, 
                    0.3065754689406123, 
                    0.6336952561297406, 
                    -0.17205697402100467, 
                    -0.016974252570881143, 
                    -0.394617898698996, 
                    0.6333336549203674, 
                    -0.5202029651984095, 
                    -0.023760064871909403, 
                    -0.07230102422269435, 
                    -0.23564196348474237, 
                    -0.02945092121387982, 
                    0.004388438406760842, 
                    -0.09162445849337364, 
                    -0.27387180320059656, 
                    -0.5895930891495357, 
                    -0.3247994592282669, 
                    -0.17060958889536343, 
                    -0.24060280724670347, 
                    0.2443339666344766, 
                    0.12840988491141792, 
                    -0.32492082173051473, 
                    -0.6244429290867882, 
                    -0.5430315505190512, 
                    0.3033521008782809, 
                    -0.5463910177057142, 
                    -0.0022557845876826077, 
                    0.24801232473009382, 
                    -0.42948842034431367, 
                    -0.3339429674885338, 
                    -0.4216140781132277, 
                    -0.14231765813212727, 
                    -0.6147670431315482, 
                    -0.5595431868548637, 
                    -0.3252055613725253, 
                    -0.023141028276054798, 
                    -0.5394993901494635, 
                    0.2582140101295287, 
                    0.5285604243800197, 
                    -0.3288636760340049, 
                    0.4466356911186442, 
                    -0.4675286839605336, 
                    -0.5316539860494146, 
                    -0.6430881609298555, 
                    -0.1804077136188379, 
                    0.12238565741300211, 
                    0.7908869833882273, 
                    -0.5057412532433379, 
                    -0.3755885054091601, 
                    -0.5747853917543023, 
                    0.13725404523060547, 
                    -0.38695649451006453, 
                    0.1770990200629997, 
                    0.1299392081365497, 
                    -0.3314448194563821, 
                    0.33724898629266553, 
                    -0.2837505291827066, 
                    -0.026327908490538454, 
                    0.5656008896635387, 
                    0.5085163653260061, 
                    0.028711052933707792, 
                    0.40333258865344823, 
                    -0.37198217797404354, 
                    -0.16666107291668125, 
                    0.2752540152590479, 
                    0.42837038804941563, 
                    -0.6430881609298555, 
                    0.20639202396620682, 
                    0.1109989612712029, 
                    0.630821799235042, 
                    -0.41221316821119003, 
                    0.11243146735713094, 
                    0.34538393361403197, 
                    -0.26058466216276316, 
                    0.06249884981969134, 
                    0.10173022286406497, 
                    -0.0363870045900071, 
                    -0.5781097725262079, 
                    0.7001379408753006, 
                    -0.194210884657335, 
                    -0.46522749933806473, 
                    -0.0897225501275184, 
                    -0.04409430873190978, 
                    -0.36086193761909086, 
                    -0.4311542385731806, 
                    0.09645001967327038, 
                    0.01657601473907455, 
                    -0.3027449089987963, 
                    -0.4206257107537391, 
                    -0.1057367805702053, 
                    -0.47437410950956194, 
                    -0.2581480655822631, 
                    -0.11438125387515308, 
                    -0.036324447239646895, 
                    -0.4612493317865357, 
                    -0.09858216871915448, 
                    0.6818709876628815, 
                    0.5242403601436438, 
                    -0.47227079228878055, 
                    0.30301611325340183, 
                    -0.6147670431315482, 
                    -0.0513110695156449, 
                    -0.49021457249570655, 
                    -0.3637652596636354, 
                    0.22802175737737118, 
                    0.6073573670706094, 
                    -0.35451902196880747, 
                    0.6787811702870106, 
                    -0.47908716427286013, 
                    0.21943047749284605, 
                    -0.17801247295263833, 
                    -0.06576053373226809, 
                    0.6750382815831995, 
                    0.0510175590310431, 
                    0.5905909967831326, 
                    0.2686447945653402, 
                    0.6907695242892049, 
                    -0.6172722808972155, 
                    -0.017183939704342066, 
                    0.5289465979010315, 
                    0.644748022538514, 
                    0.643458583254412, 
                    0.4359773412498156, 
                    -0.4858263827527679, 
                    -0.15120524948297753, 
                    -0.10433463791175157, 
                    -0.34526797146822147, 
                    0.14234505698915456, 
                    0.44539718357731006, 
                    0.6086868796390694, 
                    -0.39321674506907345, 
                    0.7988893367559899, 
                    0.004578789194810029, 
                    -0.07436033406957265, 
                    0.7109212574644861, 
                    0.41455318119596285, 
                    0.07374382112186884, 
                    -0.20828233832775195, 
                    -0.14319513199543576, 
                    0.6928219162357279, 
                    -0.3684816682640236, 
                    -0.4506825675887721, 
                    -0.22176530272267903, 
                    -0.20721573261350817, 
                    -0.056779227638153906, 
                    -0.012306041105492826, 
                    0.23501720580628993, 
                    -0.039925719290761164, 
                    0.03415940681348684, 
                    -0.16634454484554373, 
                    0.46850758890984356, 
                    0.360177623422675, 
                    0.5653712907257422, 
                    0.08728860292722618, 
                    0.5371030981466607, 
                    -0.40648873138032926, 
                    0.3961483312082619, 
                    0.2500192388025728, 
                    -0.5213953908200731, 
                    -0.08071670004341924, 
                    0.045442341813604514, 
                    -0.434857363751967, 
                    -0.2577234270647036, 
                    -0.20912658389764033, 
                    -0.22538754672632005, 
                    -0.1001566240660774, 
                    -0.33773839849289244, 
                    -0.37264214946748725, 
                    -0.5055960854577675, 
                    0.6994791071049817, 
                    0.505098685496242, 
                    0.08813823816174327, 
                    -0.18771524955676522, 
                    -0.5780254980492748, 
                    -0.18984649811511795, 
                    -0.2755333317167147, 
                    0.7287662081085442, 
                    0.5958191156015675, 
                    -0.4434676806802563, 
                    -0.4719031006188119, 
                    0.1094312732115027, 
                    0.10915839197247035, 
                    -0.3327323220001721, 
                    -0.12382288795446583, 
                    -0.2618937432837661, 
                    0.20393622236463405, 
                    0.0019377049372216737, 
                    0.15189440331739612, 
                    -0.4906754976332375, 
                    -0.288976275413148, 
                    0.5915242609924036, 
                    -0.4612693299353573, 
                    0.5192674802453534, 
                    -0.07257504437631268, 
                    0.5089671563106797, 
                    -0.36420638635762353, 
                    -0.5272236900810517, 
                    -0.023343374082656076, 
                    0.07613947968670043, 
                    -0.1066338429084599, 
                    -0.21239762380663074, 
                    -0.5547432492122834, 
                    0.1403688098492748, 
                    0.7815413624875083, 
                    0.5233566724934866, 
                    0.29441937217073966, 
                    0.7569458607248774, 
                    -0.33850625298808557, 
                    0.7909402173291338, 
                    -0.35886261579347895, 
                    -0.5287593169058235, 
                    0.23391144705004008, 
                    0.19766814546271672, 
                    -0.401183651515286, 
                    -0.03797207810511172, 
                    0.367797584036917, 
                    -0.3668016002053492, 
                    0.5945466729000881, 
                    0.05852567464074587, 
                    0.6109196603146356, 
                    -0.03105087992335953, 
                    -0.5069535770271033, 
                    -0.28545697995716635, 
                    0.6011346631050067, 
                    -0.25461226645024665, 
                    -0.062100106814053646, 
                    0.4590818997355002, 
                    0.602053997977609, 
                    -0.3198981663700761, 
                    -0.28942712499872353, 
                    0.12627209819824547, 
                    0.24177784313806205, 
                    0.04063058299403732, 
                    0.6561134361537229, 
                    -0.32519630490929874, 
                    0.47271330183486215, 
                    0.20117348704254912, 
                    -0.11550124407814322, 
                    -0.3436151369836412, 
                    0.38410627340304626, 
                    0.2822971045137279, 
                    -0.02300711625263685, 
                    -0.48620920692716885, 
                    -0.1254370880347616, 
                    -0.5305039180374569, 
                    -0.12933264999278216, 
                    -0.37265144425040125, 
                    -0.6140844669517508, 
                    0.6187997824993459, 
                    -0.4113777258588452, 
                    -0.3460887037250395, 
                    -0.16095332439419607, 
                    -0.28665535614190585, 
                    -0.13944886895941688, 
                    -0.4304378025453266, 
                    0.4312033846398533, 
                    0.6853789510925428, 
                    0.48978649187391565, 
                    -0.2863810805430574, 
                    0.013029922889433943, 
                    0.48974531611061356, 
                    -0.3891484922849474, 
                    -0.09354141624973122, 
                    -0.00718308444744542, 
                    0.7065622777652887, 
                    -0.07532484066313971, 
                    0.10974141498789747, 
                    0.3926654441328328, 
                    -0.5638075245883524, 
                    0.49222668458200314, 
                    -0.4490282706726073, 
                    0.6420107038795377, 
                    -0.15330998772710525, 
                    -0.31224867988654154, 
                    -0.47709582738584444, 
                    -0.2978611744750249, 
                    -0.20127230326601842, 
                    0.5508478573964679, 
                    0.04953795444149489, 
                    -0.009805741903928356, 
                    -0.2618787676493509, 
                    -0.5848767217992705, 
                    0.6474238665886518, 
                    -0.18774400156722149, 
                    -0.35409844870269797, 
                    -0.5322203878782187, 
                    0.2797681487050637, 
                    -0.24740608434550648, 
                    -0.178712469747546, 
                    0.6344768574859387, 
                    -0.0847249791863236, 
                    0.2546539714720818, 
                    0.3868003209458146, 
                    0.3834913094500296, 
                    0.7040400397142794, 
                    -0.09793357874897102, 
                    0.016309999796105257, 
                    0.11201464661309002, 
                    -0.5499833095857605, 
                    0.2247444056608091, 
                    0.1352476051054189, 
                    0.14238211947390556, 
                    -0.30171513007014056, 
                    0.17349034413546371, 
                    -0.46359524808770947, 
                    -0.3985732134865469, 
                    0.7281122539583751, 
                    -0.6340870145228575, 
                    0.03839680581365068, 
                    0.47957664840329084, 
                    -0.2205708594627061, 
                    -0.3405796272873933, 
                    -0.38471875441879866, 
                    0.1336565731097239, 
                    0.32364869518235984, 
                    0.06412379592106598, 
                    0.02033890710834052, 
                    -0.01617869211605849, 
                    -0.5197626804775968, 
                    0.42635458626906186, 
                    -0.1701200980789413, 
                    0.21538688921396987, 
                    -0.41063083720441396, 
                    -0.3615802148007805, 
                    -0.3404390452824095, 
                    0.24774973047778748, 
                    0.30315682473502104, 
                    0.4575423155068217, 
                    -0.21744316922398843, 
                    0.4288179859983141, 
                    -0.14509366718855105, 
                    -0.35925598194030994, 
                    0.6451840447900656, 
                    0.1614776712012589, 
                    0.6269613097343252, 
                    0.4560211910714953, 
                    -0.41363078158804495, 
                    -0.13669579534372578, 
                    -0.04693748410951526, 
                    -0.0360176481365968, 
                    -0.20537134126915269, 
                    0.42264422112633127, 
                    0.2764552433204115, 
                    -0.12243823628222239, 
                    0.26057954588824306, 
                    -0.07778454146276859, 
                    0.006671907386150311, 
                    -0.2597709458514472, 
                    0.37745248864950476, 
                    -0.2456090309932063, 
                    0.17010171444550581, 
                    0.18648020271254184, 
                    0.34987815170669856, 
                    0.12043244690727073, 
                    0.3097143523852923, 
                    -0.29068384389609075, 
                    -0.4391731443826931 
)
)

