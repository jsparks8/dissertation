model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.416083, 1);
tau[2,2] ~ dlnorm(-0.254568, 1);
tau[3,2] ~ dlnorm(-0.271831, 1);
tau[4,2] ~ dlnorm(-0.149467, 1);
tau[5,2] ~ dlnorm(-0.47487, 1);
tau[6,2] ~ dlnorm(-0.485682, 1);
tau[7,2] ~ dlnorm(-0.259671, 1);
tau[8,2] ~ dlnorm(-0.411783, 1);
tau[9,2] ~ dlnorm(-0.172844, 1);
tau[10,2] ~ dlnorm(-0.161581, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -0.6047635898299006, 
                    -1.029338402088211, 
                    -0.9806181689686924, 
                    -1.3448200036782678, 
                    -0.466477413833, 
                    -0.44191696619423537, 
                    1.0148489121151063, 
                    0.6152001173472488, 
                    1.2717547109348142, 
                    1.3067452835435538 ),
tau=matrix(c( NA,1.0875388518336255, 
                    NA,1.2781729425376067, 
                    NA,1.2562975578669429, 
                    NA,1.4198241816515424, 
                    NA,1.025448358811017, 
                    NA,1.0144207178212117, 
                    NA,1.2716671615396828, 
                    NA,1.092224852688915, 
                    NA,1.3870178652097316, 
                    NA,1.4027286323110557 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.08550339165964882, 
                    -0.07570231749377287, 
                    -0.191123959380808, 
                    -0.1284364673852022, 
                    -0.19367690858539033, 
                    0.13291427300788816, 
                    -0.014785759945896648, 
                    -0.10345841771221112, 
                    -0.12173046514208546, 
                    0.01904283985188371, 
                    0.20714976913966027, 
                    0.253511678806367, 
                    0.0035496810885057295, 
                    -0.030621646655429435, 
                    -0.2185345303985688, 
                    0.253511678806367, 
                    -0.09571080672722582, 
                    -0.05831849017227125, 
                    0.20714976913966027, 
                    -0.19367690858539033, 
                    -0.09142796006963655, 
                    0.04973845641766489, 
                    -0.3281704316942661, 
                    -0.26691503785796045, 
                    0.17518529171956337, 
                    -0.05831849017227125, 
                    0.16798834008006186, 
                    -0.11226404083426786, 
                    0.16504807020386897, 
                    0.253511678806367, 
                    0.04977349358829164, 
                    -0.14144806524146408, 
                    0.1298692584379183, 
                    0.01904283985188371, 
                    -0.1668343054714588, 
                    0.1298692584379183, 
                    0.051410856764209256, 
                    0.253511678806367, 
                    0.20714976913966027, 
                    0.08893492264788999, 
                    0.16504807020386897, 
                    -0.12173046514208546, 
                    -0.06447128488697834, 
                    -0.03770247992528314, 
                    -0.21593624277862247, 
                    -0.05831849017227125, 
                    0.12833423046049552, 
                    -0.1246648207192472, 
                    -0.07570231749377287, 
                    0.20714976913966027, 
                    -0.22598819949190233, 
                    0.17249370921119883, 
                    0.253511678806367, 
                    -0.3454575040777432, 
                    0.16504807020386897, 
                    -0.279869808942151, 
                    -0.02070097864780729, 
                    0.253511678806367, 
                    0.08088862573423089, 
                    0.004447794913109704, 
                    -0.2692097723791714, 
                    -0.1454312263027773, 
                    0.1086166303611169, 
                    -0.21228829004307842, 
                    0.1298692584379183, 
                    -0.20325612174042945, 
                    0.12860723239652494, 
                    0.05566992638938456, 
                    -0.1284364673852022, 
                    0.16798834008006186, 
                    0.01904283985188371, 
                    -0.22939097197427977, 
                    0.08893492264788999, 
                    -0.26691503785796045, 
                    0.07623230115197854, 
                    -0.09011359287986953, 
                    0.08893492264788999, 
                    0.08893492264788999, 
                    0.01904283985188371, 
                    0.253511678806367, 
                    -0.05912611726114053, 
                    0.07623230115197854, 
                    -0.18602644685160102, 
                    -0.28894823222921423, 
                    -0.3281704316942661, 
                    0.17249370921119883, 
                    -0.2527953272015052, 
                    -0.14144806524146408, 
                    0.08664855840409819, 
                    0.1086166303611169, 
                    -0.14449307981143394, 
                    0.07623230115197854, 
                    0.07623230115197854, 
                    -6.747602474949099e-4, 
                    -0.11226404083426786, 
                    0.01904283985188371, 
                    -0.08550339165964882, 
                    -0.19513929295534613, 
                    0.13604464170383423, 
                    -0.03976074890226783, 
                    -0.2185345303985688, 
                    0.12685291470804178, 
                    -0.2427829984313933, 
                    -0.3182913615414993, 
                    0.05134455159793583, 
                    0.1086166303611169, 
                    0.04598872732046727, 
                    0.17249370921119883, 
                    -0.2310527064736433, 
                    0.017518386145274567, 
                    0.01904283985188371, 
                    0.09479004242198197, 
                    -0.20257864212744972, 
                    0.08893492264788999, 
                    0.253511678806367, 
                    0.08664855840409819, 
                    -0.03976074890226783, 
                    0.11015165833853968, 
                    0.17249370921119883, 
                    0.1022974423025399, 
                    -0.11032012013378234, 
                    0.12685291470804178, 
                    0.253511678806367, 
                    -0.15894087106162666, 
                    0.13291427300788816, 
                    0.04977349358829164, 
                    0.17518529171956337, 
                    0.22568949122629928, 
                    0.253511678806367, 
                    -0.1501441783590158, 
                    -6.747602474949099e-4, 
                    -0.03520168920282213, 
                    -0.11226404083426786, 
                    -0.03770247992528314, 
                    9.183785210442053e-4, 
                    0.051410856764209256, 
                    -0.014625985321519874, 
                    -0.3454575040777432, 
                    -0.32992326322976107, 
                    -0.27938768635640043, 
                    -0.06118438623812522, 
                    0.253511678806367, 
                    0.253511678806367, 
                    0.030378749991538723, 
                    0.051410856764209256, 
                    0.11015165833853968, 
                    0.09765593848783594, 
                    0.2055124059637426, 
                    0.12685291470804178, 
                    -0.03976074890226783, 
                    -0.06447128488697834, 
                    0.16798834008006186, 
                    0.04557876561802804, 
                    -0.20181138952638444, 
                    0.02208785442185357, 
                    -0.2427829984313933, 
                    -0.2931989235772117, 
                    0.1356015085331947, 
                    0.08893492264788999, 
                    0.2055124059637426, 
                    -0.07859483089499092, 
                    -0.3454575040777432, 
                    -0.032276544739439805, 
                    0.01904283985188371, 
                    0.12833423046049552, 
                    0.2055124059637426, 
                    0.08664855840409819, 
                    -0.03585357201344552, 
                    0.253511678806367, 
                    0.11097831587180995, 
                    -0.17816190498483753, 
                    -0.20430434109036064, 
                    0.01904283985188371, 
                    -0.28894823222921423, 
                    0.17249370921119883, 
                    0.014811706527523616, 
                    0.08928774527425665, 
                    0.253511678806367, 
                    0.021229750639929934, 
                    -0.2692324107885433, 
                    -0.11032012013378234, 
                    -0.17244545168331216, 
                    0.12860723239652494, 
                    0.16798834008006186, 
                    0.253511678806367, 
                    -0.03976074890226783, 
                    -0.21593624277862247, 
                    -0.2442317227061803, 
                    -0.28894823222921423, 
                    0.253511678806367, 
                    0.08893492264788999, 
                    0.17123635562136302, 
                    -0.06118438623812522, 
                    -0.19367690858539033, 
                    -0.15149789953045578, 
                    0.004447794913109704, 
                    -0.19367690858539033, 
                    -0.03616629740309102, 
                    -0.10428975192329881, 
                    -0.22178254593986996, 
                    -0.013090957344097098, 
                    -0.05912611726114053, 
                    0.16798834008006186, 
                    -0.18227873661163813, 
                    0.22568949122629928, 
                    -0.2457188611829969, 
                    0.17249370921119883, 
                    0.02208785442185357, 
                    0.08893492264788999, 
                    0.2055124059637426, 
                    -0.17856480277246634, 
                    0.09479004242198197, 
                    0.19494727624415636, 
                    0.16798834008006186, 
                    0.253511678806367, 
                    0.253511678806367, 
                    0.12860723239652494, 
                    0.16798834008006186, 
                    0.12685291470804178, 
                    0.09479004242198197, 
                    0.04454399510642221, 
                    0.09126762748847261, 
                    0.16798834008006186, 
                    -0.11032012013378234, 
                    0.09479004242198197, 
                    0.030378749991538723, 
                    0.030378749991538723, 
                    -0.10041340314224126, 
                    -0.15568188544262365, 
                    0.16504807020386897, 
                    0.09479004242198197, 
                    0.20714976913966027, 
                    0.253511678806367, 
                    -0.19750242362589823, 
                    -0.12282210281148812, 
                    0.17249370921119883, 
                    0.2055124059637426, 
                    -0.11517056482245563, 
                    -0.03434358542089849, 
                    0.014811706527523616, 
                    -0.2518542831952606, 
                    0.08893492264788999, 
                    -0.22178254593986996, 
                    0.253511678806367, 
                    -0.28894823222921423, 
                    -0.3281704316942661, 
                    -0.32992326322976107, 
                    -0.1059004042886823, 
                    0.20714976913966027, 
                    0.03504514178916668, 
                    0.051410856764209256, 
                    -0.18723131810049232, 
                    0.09479004242198197, 
                    0.2055124059637426, 
                    0.08664855840409819, 
                    0.12685291470804178, 
                    -0.03757933955122461, 
                    0.08893492264788999, 
                    0.253511678806367, 
                    -0.279869808942151, 
                    -0.27938768635640043, 
                    0.03504514178916668, 
                    -0.03757933955122461, 
                    -0.2457188611829969, 
                    -0.19367690858539033, 
                    0.053743561604791934, 
                    0.2055124059637426, 
                    0.253511678806367, 
                    -6.747602474949099e-4, 
                    0.02208785442185357, 
                    0.16798834008006186, 
                    -0.3373895100940594, 
                    0.12685291470804178, 
                    0.253511678806367, 
                    -0.09142796006963655, 
                    0.09765593848783594, 
                    0.253511678806367, 
                    -0.17856480277246634, 
                    -0.11226404083426786, 
                    0.08893492264788999, 
                    0.20714976913966027, 
                    0.20714976913966027, 
                    -0.05831849017227125, 
                    -0.17856480277246634, 
                    0.16504807020386897, 
                    0.08664855840409819, 
                    -0.191123959380808, 
                    -0.03976074890226783, 
                    -0.11226404083426786, 
                    -0.13634346064410433, 
                    -0.01836827380722461, 
                    -0.25769595945816715, 
                    0.17249370921119883, 
                    -0.1566625754791078, 
                    0.253511678806367, 
                    0.04977349358829164, 
                    0.09765593848783594, 
                    -0.2914446058887285, 
                    0.20714976913966027, 
                    0.253511678806367, 
                    0.253511678806367, 
                    -0.10265238874738111, 
                    -0.08189922129542854, 
                    0.005764671881097694, 
                    0.12685291470804178, 
                    -0.11032012013378234, 
                    -0.11032012013378234, 
                    0.16798834008006186, 
                    -0.056260221195286564, 
                    0.253511678806367, 
                    0.02279820911451741, 
                    -0.23100162433966334, 
                    -0.19367690858539033, 
                    -0.06447128488697834, 
                    -0.19367690858539033, 
                    0.053743561604791934, 
                    0.08893492264788999, 
                    0.20714976913966027, 
                    0.01904283985188371, 
                    0.16504807020386897, 
                    -0.06447128488697834, 
                    0.08893492264788999, 
                    -0.14144806524146408, 
                    -0.25287460870598655, 
                    0.253511678806367, 
                    0.253511678806367, 
                    0.253511678806367, 
                    -0.191123959380808, 
                    0.22568949122629928, 
                    0.17249370921119883, 
                    -0.1501441783590158, 
                    0.2055124059637426, 
                    -0.019145076776590386, 
                    -0.04298647142070472, 
                    0.19494727624415636, 
                    -0.19367690858539033, 
                    -0.12173046514208546, 
                    -6.747602474949099e-4, 
                    0.2055124059637426, 
                    -0.14272944775504642, 
                    0.08664855840409819, 
                    -0.059797393208928684, 
                    -0.2527953272015052, 
                    0.22568949122629928, 
                    -0.22178254593986996, 
                    -0.2457188611829969, 
                    0.04067281097050274, 
                    -0.21651505754341865, 
                    -0.22817511027994855, 
                    0.12860723239652494, 
                    0.253511678806367, 
                    -0.19367690858539033, 
                    -0.22178254593986996, 
                    -0.047344231632331146, 
                    -0.08936969109265186, 
                    0.253511678806367, 
                    0.03504514178916668, 
                    -0.14144806524146408, 
                    0.22568949122629928, 
                    0.253511678806367, 
                    -0.22817511027994855, 
                    0.12833423046049552, 
                    0.12860723239652494, 
                    0.16504807020386897, 
                    0.07648283316513615, 
                    -0.09604757575490969, 
                    0.253511678806367, 
                    0.2055124059637426, 
                    0.17249370921119883, 
                    -0.2931989235772117, 
                    -0.06118438623812522, 
                    -0.2692097723791714, 
                    -0.191123959380808, 
                    -0.06118438623812522, 
                    -0.202242513164546, 
                    0.16504807020386897, 
                    0.08088862573423089, 
                    -0.3281704316942661, 
                    -0.037388599990868354, 
                    -0.06118438623812522, 
                    0.17518529171956337, 
                    0.2055124059637426, 
                    -0.03757933955122461, 
                    -0.06837633840500168, 
                    0.024274765209899796, 
                    0.16504807020386897, 
                    0.16504807020386897, 
                    0.08664855840409819, 
                    0.09479004242198197, 
                    -0.279869808942151, 
                    0.16504807020386897, 
                    0.09126762748847261, 
                    -0.11301924218942314, 
                    -0.20257864212744972, 
                    0.02208785442185357, 
                    -0.27808700523755575, 
                    0.004447794913109704, 
                    0.051410856764209256, 
                    0.02208785442185357, 
                    -0.1284364673852022, 
                    0.12685291470804178, 
                    0.047765676406074264, 
                    -0.279869808942151, 
                    -0.22178254593986996, 
                    0.04977349358829164, 
                    -0.0167065393078612, 
                    -0.05912611726114053, 
                    -0.14449307981143394, 
                    -0.19367690858539033, 
                    0.09479004242198197, 
                    0.22568949122629928, 
                    -0.191123959380808, 
                    0.253511678806367, 
                    0.09479004242198197, 
                    0.19494727624415636, 
                    0.12860723239652494, 
                    -0.3454575040777432, 
                    0.20714976913966027, 
                    0.1022974423025399, 
                    0.253511678806367, 
                    0.16798834008006186, 
                    0.138517389583923, 
                    0.08893492264788999, 
                    -0.06447128488697834, 
                    0.04977349358829164, 
                    -6.747602474949099e-4, 
                    -0.21159294837841347, 
                    0.17249370921119883, 
                    -0.13808556802144736, 
                    -0.12539145281523234, 
                    -0.016100062206620525, 
                    -0.14449307981143394, 
                    0.12833423046049552, 
                    -0.12173046514208546, 
                    -0.056260221195286564, 
                    -0.3454575040777432, 
                    0.253511678806367, 
                    0.06454646859047058, 
                    0.12860723239652494, 
                    -0.0867326305638762, 
                    0.17624899800777788, 
                    -0.1591619020940178, 
                    -0.06118438623812522, 
                    0.253511678806367, 
                    0.17249370921119883, 
                    0.2055124059637426, 
                    -0.13948111296639681, 
                    0.253511678806367, 
                    0.08893492264788999, 
                    -0.12173046514208546, 
                    -0.04401401144821654, 
                    0.22568949122629928, 
                    -0.06118438623812522, 
                    0.16798834008006186, 
                    0.19494727624415636, 
                    -0.17085917064137443, 
                    0.253511678806367, 
                    0.09479004242198197, 
                    -0.1796001113810662, 
                    -0.11226404083426786, 
                    0.16504807020386897, 
                    -0.12173046514208546, 
                    0.20714976913966027, 
                    0.08893492264788999, 
                    0.19494727624415636, 
                    -0.03757933955122461, 
                    0.16504807020386897, 
                    0.253511678806367, 
                    0.253511678806367, 
                    0.2055124059637426, 
                    0.253511678806367, 
                    0.253511678806367, 
                    -0.06118438623812522, 
                    -0.16409998478641707, 
                    -0.3454575040777432, 
                    -0.2673431455855614, 
                    0.253511678806367, 
                    0.08664855840409819, 
                    -0.1230274575433295, 
                    0.16504807020386897, 
                    -0.07425758527972787, 
                    -0.05831849017227125, 
                    -0.16057026458118295, 
                    0.17249370921119883, 
                    -0.14974358184197262, 
                    -0.22598819949190233, 
                    -0.16409998478641707, 
                    -0.14144806524146408, 
                    -0.06447128488697834, 
                    0.13291427300788816, 
                    -0.03585357201344552, 
                    -0.15139941254614458, 
                    -6.747602474949099e-4, 
                    -0.2527953272015052, 
                    -0.17650653379548167, 
                    0.253511678806367, 
                    0.12685291470804178, 
                    -0.04114811538236257, 
                    -0.22178254593986996, 
                    0.08893492264788999 
)
)

