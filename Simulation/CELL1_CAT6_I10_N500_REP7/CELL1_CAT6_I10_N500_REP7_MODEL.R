model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.185596, 1);
tau[1,3] ~ dlnorm(0.063489, 1);
tau[1,4] ~ dlnorm(-0.075628, 1);
tau[1,5] ~ dlnorm(-0.237276, 1);
tau[1,6] ~ dlnorm(-0.430189, 1);
tau[2,2] ~ dlnorm(0.109438, 1);
tau[2,3] ~ dlnorm(-0.015334, 1);
tau[2,4] ~ dlnorm(-0.157924, 1);
tau[2,5] ~ dlnorm(-0.324282, 1);
tau[2,6] ~ dlnorm(-0.523948, 1);
tau[3,2] ~ dlnorm(0.045152, 1);
tau[3,3] ~ dlnorm(-0.08204, 1);
tau[3,4] ~ dlnorm(-0.2278, 1);
tau[3,5] ~ dlnorm(-0.398493, 1);
tau[3,6] ~ dlnorm(-0.604442, 1);
tau[4,2] ~ dlnorm(0.099102, 1);
tau[4,3] ~ dlnorm(-0.026049, 1);
tau[4,4] ~ dlnorm(-0.169133, 1);
tau[4,5] ~ dlnorm(-0.336165, 1);
tau[4,6] ~ dlnorm(-0.536803, 1);
tau[5,2] ~ dlnorm(-0.405088, 1);
tau[5,3] ~ dlnorm(-0.554659, 1);
tau[5,4] ~ dlnorm(-0.730604, 1);
tau[5,5] ~ dlnorm(-0.944259, 1);
tau[5,6] ~ dlnorm(-1.216323, 1);
tau[6,2] ~ dlnorm(-0.370199, 1);
tau[6,3] ~ dlnorm(-0.517632, 1);
tau[6,4] ~ dlnorm(-0.690624, 1);
tau[6,5] ~ dlnorm(-0.899934, 1);
tau[6,6] ~ dlnorm(-1.164977, 1);
tau[7,2] ~ dlnorm(-0.100248, 1);
tau[7,3] ~ dlnorm(-0.233549, 1);
tau[7,4] ~ dlnorm(-0.387393, 1);
tau[7,5] ~ dlnorm(-0.569285, 1);
tau[7,6] ~ dlnorm(-0.791785, 1);
tau[8,2] ~ dlnorm(-0.073447, 1);
tau[8,3] ~ dlnorm(-0.205552, 1);
tau[8,4] ~ dlnorm(-0.357803, 1);
tau[8,5] ~ dlnorm(-0.537471, 1);
tau[8,6] ~ dlnorm(-0.756648, 1);
tau[9,2] ~ dlnorm(0.164804, 1);
tau[9,3] ~ dlnorm(0.04199, 1);
tau[9,4] ~ dlnorm(-0.098046, 1);
tau[9,5] ~ dlnorm(-0.260937, 1);
tau[9,6] ~ dlnorm(-0.455624, 1);
tau[10,2] ~ dlnorm(0.164503, 1);
tau[10,3] ~ dlnorm(0.041679, 1);
tau[10,4] ~ dlnorm(-0.098371, 1);
tau[10,5] ~ dlnorm(-0.26128, 1);
tau[10,6] ~ dlnorm(-0.455993, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.3993451614889487, 
                    1.1856051816365099, 
                    1.0174321726279705, 
                    1.1578303291330758, 
                    0.09920998727242014, 
                    0.15653748751152163, 
                    -0.6746758029366234, 
                    -0.734165906368712, 
                    -1.3393669255815035, 
                    -1.3385072220330152 ),
tau=matrix(c( NA,1.9849540549739737,1.7567920356076148,1.5286300162412558,1.300467996874897,1.072305977508538, 
                    NA,1.8393971286944633,1.6236320281595455,1.407866927624628,1.1921018270897106,0.9763367265547929, 
                    NA,1.7248713095596482,1.5188602435472258,1.3128491775348035,1.106838111522381,0.9008270455099587, 
                    NA,1.820482454139625,1.6063282950499065,1.392174135960188,1.1780199768704696,0.9638658177807511, 
                    NA,1.099562001332518,0.9468078220707177,0.7940536428089173,0.641299463547117,0.48854528428531663, 
                    NA,1.1386020289953465,0.9825228547196782,0.8264436804440098,0.6703645061683415,0.5142853318926732, 
                    NA,1.4914542217998406,1.3053230252295163,1.1191918286591922,0.933060632088868,0.7469294355185438, 
                    NA,1.5319669822370932,1.3423853596677078,1.1528037370983224,0.963222114528937,0.7736404919595516, 
                    NA,1.944108876321004,1.7194255946372767,1.4947423129535495,1.2700590312698223,1.0453757495860951, 
                    NA,1.9435234182044832,1.7188899993265683,1.4942565804486534,1.2696231615707385,1.0449897426928236 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 0.34256829349204065, 
                    -0.5164816149179736, 
                    -0.2039247187155021, 
                    0.06830762542079627, 
                    -0.2398585107087725, 
                    -0.5963516983619583, 
                    0.026438282821586, 
                    0.43936550584663947, 
                    0.47939972783462714, 
                    -0.0851419969847812, 
                    -0.42645039043454214, 
                    0.5778377291698151, 
                    -0.5186875646419167, 
                    -0.20630857303640565, 
                    0.2718899979081142, 
                    -0.19119034189955353, 
                    0.10170824947313872, 
                    -0.03601663299307245, 
                    0.3785858951820009, 
                    0.028756018902398983, 
                    0.5553252870778314, 
                    0.5825788881676062, 
                    0.08336866552524491, 
                    0.13899886710732312, 
                    -0.2539363739520486, 
                    -0.27551477361440785, 
                    0.2937094170540625, 
                    0.24124564380211544, 
                    -0.35887086543501534, 
                    0.24563978260491104, 
                    -0.13710050697722698, 
                    0.16100563974534743, 
                    -0.0798577886717704, 
                    -0.08764643475806944, 
                    0.4496538266075396, 
                    0.25743175208773583, 
                    -0.07275751526191243, 
                    0.10689862665512007, 
                    -0.13446901857656235, 
                    0.6335143114233786, 
                    0.3439281496674774, 
                    -0.36965810978450425, 
                    0.1840995127175824, 
                    -0.49381849309829273, 
                    -0.033781280641818956, 
                    0.04486992428192449, 
                    -0.4595913054893829, 
                    0.04413011382235554, 
                    -0.020861204304126857, 
                    -0.5814407638991979, 
                    0.2937037970335007, 
                    -0.45271611613032114, 
                    -0.27912213421461507, 
                    0.43316201935054477, 
                    -0.0629900593762267, 
                    -0.4575959878437148, 
                    -0.442555352712256, 
                    0.03268065909741602, 
                    -0.22017036587743133, 
                    0.6638075644476042, 
                    -0.2434416552722749, 
                    0.4751167887212324, 
                    0.3980701777326314, 
                    0.25932116893933765, 
                    -0.3680744203565478, 
                    0.289576873647881, 
                    0.03081013700732016, 
                    -0.33648584314444085, 
                    -0.5928731572499574, 
                    -0.5020150443391311, 
                    -0.4790180207226032, 
                    0.1723992058701851, 
                    0.0864684987011628, 
                    0.12846199137921321, 
                    -0.5018294468394798, 
                    -0.17493386812142947, 
                    -0.3393422220529772, 
                    0.23809675474144176, 
                    0.3561526463827599, 
                    0.30600015332288044, 
                    -0.45658536540236266, 
                    -0.5189464335683693, 
                    -0.3744608061255323, 
                    -0.44478762944476036, 
                    0.08578853301603884, 
                    -0.286146941447666, 
                    -0.23717075004759852, 
                    0.18734014128765064, 
                    -0.06652710257571814, 
                    -0.518561657734485, 
                    -0.021847014663565645, 
                    0.046291405800753194, 
                    0.20467468784397735, 
                    0.17842140939422124, 
                    -0.3242816761188577, 
                    -0.16373241032740754, 
                    -0.522739080292099, 
                    0.5151185968454348, 
                    -0.11038761290136867, 
                    -0.06876554176409966, 
                    -0.44169259232897345, 
                    0.02281433873247396, 
                    -0.5819536511215107, 
                    -0.3339697616778434, 
                    0.11133332825830267, 
                    -0.040201469554158376, 
                    -0.0772105971442203, 
                    0.2546863669190197, 
                    0.1529198705825332, 
                    -1.7418653481771074e-4, 
                    -0.5058790538009259, 
                    -0.4084729030105715, 
                    0.14307364842865822, 
                    -0.43535563201357785, 
                    0.2914239251095859, 
                    -0.4032777459770248, 
                    0.10313409722969213, 
                    -0.24795841710741845, 
                    -0.4867408163143108, 
                    -0.10588756713779135, 
                    -0.3636365155427526, 
                    0.44371742872155484, 
                    -0.32715334930927137, 
                    -0.339882546504122, 
                    0.04572453265770815, 
                    0.5271404804981499, 
                    -0.2763244153784, 
                    0.5261160142615535, 
                    -0.5517298113310073, 
                    -0.1164472130066746, 
                    0.22496006863970752, 
                    -0.4661267438137274, 
                    0.30069951745745316, 
                    -0.4607210349637637, 
                    -0.1727747486888368, 
                    0.6502460090165942, 
                    -0.38413599940986465, 
                    -0.5927472712506766, 
                    0.5623434249280586, 
                    0.07560785904651124, 
                    -0.3930212563459764, 
                    -0.19697852788418702, 
                    -0.023707616530229014, 
                    -0.49536822818150095, 
                    -0.3223516685272295, 
                    0.005575579839955935, 
                    -0.5727947049894716, 
                    0.021286949315138526, 
                    -0.3812929685564928, 
                    -0.20366358538329982, 
                    0.13370558048059178, 
                    0.07193576679911307, 
                    -0.15950300375128118, 
                    0.10352505498224296, 
                    -0.294159627212376, 
                    0.6035495817752774, 
                    -0.521408576091726, 
                    0.478038282842264, 
                    0.30294995228076005, 
                    0.5014789472204417, 
                    -0.39109635905471296, 
                    -0.20671479564978867, 
                    0.5769831002548305, 
                    -0.048471459046838694, 
                    -0.27942564957930244, 
                    -0.4144951415600242, 
                    0.09990907317812248, 
                    0.04129571274174104, 
                    -0.5847481273138597, 
                    -0.12296566251277585, 
                    -0.20654833511819393, 
                    -0.2536164314751883, 
                    -0.32456542084898493, 
                    -0.23658884611428727, 
                    -0.09924815996476044, 
                    -0.6241224946560373, 
                    -0.10267308878025394, 
                    0.4690137493877864, 
                    0.30767878245252867, 
                    -0.040958432729573224, 
                    0.34320661541103514, 
                    0.3508333524403229, 
                    0.5045303869439703, 
                    -0.303359767159442, 
                    0.13826385883684278, 
                    0.27280444265933745, 
                    -0.2025079780499635, 
                    0.4961150911305061, 
                    -0.527868382776727, 
                    -0.5453847302399788, 
                    -0.3623628298307374, 
                    0.7647626852605507, 
                    0.44166409597587064, 
                    -0.3830435736363165, 
                    -0.058942458302021716, 
                    -0.2942461688689834, 
                    0.04663113987209999, 
                    0.44331222983611296, 
                    -0.37510751060327163, 
                    -0.5057891490251827, 
                    -0.2532694321241188, 
                    0.24093041701325868, 
                    -0.35308008558141113, 
                    0.04207951348530803, 
                    0.4095436847442817, 
                    0.7433810992873042, 
                    -0.27937342299668255, 
                    0.603154406681427, 
                    -0.2826835916780683, 
                    0.46035574880651886, 
                    0.11986390471283548, 
                    -0.33790728391928304, 
                    -0.36207977503013195, 
                    -0.2575486615241687, 
                    0.5656919783311156, 
                    0.07150924354848287, 
                    -0.3820871757874668, 
                    0.4494034194976273, 
                    0.12068392170160946, 
                    -0.26380842704814345, 
                    0.394495962223701, 
                    -0.26219122248766485, 
                    0.13240328857492178, 
                    0.1358612313403288, 
                    0.5646249833525772, 
                    -0.30743109927913603, 
                    0.29631287710549004, 
                    0.2442399989419114, 
                    -0.3203716650032412, 
                    -0.20602074849328988, 
                    -0.09183977582836633, 
                    -0.32269076071922553, 
                    -0.4333161640762374, 
                    0.20184488490588914, 
                    -0.10444722459424383, 
                    0.03941416047006907, 
                    0.1949484789711906, 
                    0.19537705989324106, 
                    -0.2560925624280183, 
                    -0.37819646214436065, 
                    -0.2516433121867216, 
                    0.49600759495782976, 
                    0.33417164120531695, 
                    0.15256506671997383, 
                    0.40655523062826915, 
                    0.5332025152271105, 
                    -0.21269315849651943, 
                    0.12588793851548252, 
                    -0.5332425803032933, 
                    0.5333784793280416, 
                    0.5646224147944501, 
                    -0.1595630033965456, 
                    -0.14308529731852065, 
                    0.4599732277804607, 
                    -0.24977533725037654, 
                    0.5116342392366422, 
                    -0.07421305305884063, 
                    0.43203303536649806, 
                    -0.4447532413028208, 
                    0.26962713474040867, 
                    0.15431517987307175, 
                    0.19471757535174972, 
                    0.04511524753181251, 
                    0.14383353671196253, 
                    0.2239782950665864, 
                    0.36849682844752074, 
                    -0.622559346194534, 
                    -0.2249968194247043, 
                    -0.4649177332981961, 
                    0.337711976206992, 
                    0.2212248371715002, 
                    -0.21619834931718984, 
                    -0.4469345982095123, 
                    0.14588434717374266, 
                    -0.18110475878748922, 
                    -0.5413735804842079, 
                    0.39906693070672783, 
                    0.6335143114233786, 
                    0.2596837310431682, 
                    0.1509615305861528, 
                    -0.26257407827795615, 
                    -1.6289144474213035e-4, 
                    0.10531856798904926, 
                    0.14219101158356207, 
                    -0.05739856747582084, 
                    -0.4257229925309065, 
                    0.7000622693656744, 
                    -0.447594448601381, 
                    -0.37177957843018034, 
                    -0.26029127162595017, 
                    -0.3438529050684372, 
                    -0.4515116652544839, 
                    -0.3255526776633147, 
                    0.41645055220885485, 
                    0.24035555193734537, 
                    0.2864912622968332, 
                    0.18823086599715944, 
                    0.30185802476640555, 
                    -0.2689988842998313, 
                    0.1737982388722269, 
                    -0.5233013165767789, 
                    0.45376882797012463, 
                    0.30972939418389256, 
                    0.03691536802417894, 
                    0.21177687660278788, 
                    -0.38479001989049433, 
                    -0.3404072369594249, 
                    0.02931775971620454, 
                    0.39665574779568025, 
                    -0.596647669478373, 
                    -0.08586798180047672, 
                    -0.1723672112107339, 
                    0.5264639480926021, 
                    0.5774594221332585, 
                    0.6020764797872302, 
                    0.3203245559827148, 
                    -0.31967398554722887, 
                    -0.49084381100571706, 
                    0.2761374080428838, 
                    0.18810481033691995, 
                    0.4115655147779915, 
                    -0.554296680107927, 
                    0.1050957775508734, 
                    -0.01861394803705385, 
                    -0.20223814868214895, 
                    0.4841615623484705, 
                    0.6476295657883269, 
                    0.7914607779179836, 
                    0.2708810014672042, 
                    -0.07259755766354536, 
                    0.0997105187711137, 
                    -0.5487172843962018, 
                    -0.5751415212631457, 
                    -0.13679260358392797, 
                    -0.4112926207779385, 
                    0.5211584260519222, 
                    -0.41543733380982706, 
                    0.5734035370379222, 
                    0.04290124393772399, 
                    -0.5633843301216751, 
                    -0.1791020574209365, 
                    -0.45130094323607445, 
                    0.34935573901054584, 
                    0.2745792983513068, 
                    -0.07675807624432984, 
                    0.5644263462076871, 
                    0.7710043512660283, 
                    0.17546074333932837, 
                    -0.4550433370342907, 
                    -0.11878075592947035, 
                    0.006134308107551334, 
                    -0.34256367282290906, 
                    -0.24614965315356185, 
                    -0.24424806154588052, 
                    -0.036644917294763935, 
                    0.3811486827793815, 
                    -0.5416937018183112, 
                    0.5828847295722139, 
                    0.03644655497482385, 
                    -0.3190231152750375, 
                    -0.25841408114532366, 
                    0.02145413278307462, 
                    0.25586237630852227, 
                    -0.625466765631363, 
                    -0.5153293059330245, 
                    0.2991507403807562, 
                    0.11178185615430225, 
                    0.14259961295720303, 
                    0.11626813103850042, 
                    -0.14704745142208636, 
                    0.01273198739671988, 
                    0.4374484284052038, 
                    -0.43894052116133286, 
                    -0.5504098754838207, 
                    0.1718624440914961, 
                    -0.3721265287037242, 
                    -0.02268112227316088, 
                    -0.1209274483192041, 
                    -0.5095037818239563, 
                    0.4062813948262536, 
                    -0.5063154595611798, 
                    -0.35156166042018683, 
                    -0.13291701788064003, 
                    0.3078950839595568, 
                    0.5001872891020904, 
                    0.01432974601392012, 
                    0.15850266920300382, 
                    0.08411186484479838, 
                    0.32153165366331693, 
                    0.5664512035579934, 
                    -0.6206291070559381, 
                    -0.11280599357824994, 
                    0.44464482123610116, 
                    -0.6415329125332021, 
                    -0.4052919777832795, 
                    -0.07299848829398392, 
                    0.5662644744353758, 
                    -0.5082020628268517, 
                    0.16889352686063164, 
                    0.00092048404435651765, 
                    0.5635378057209455, 
                    0.23871914764524704, 
                    -0.48877397721051846, 
                    -0.4699995238703192, 
                    -0.32111156321374085, 
                    0.05504756244290876, 
                    0.3320659821877786, 
                    0.35525215108884567, 
                    -0.5926751844775772, 
                    -0.5479409332463211, 
                    -0.1183536378673119, 
                    -0.36290521094474676, 
                    -0.12768466973377468, 
                    0.37869864442175905, 
                    0.4134414959763799, 
                    0.20127247770801238, 
                    0.11410168750489735, 
                    -0.6224373843800177, 
                    -0.13464106126077013, 
                    0.42236982091647546, 
                    -0.027692639621985204, 
                    -0.3007102809298559, 
                    0.04277417148189655, 
                    -0.38929933481970036, 
                    -0.3953546861989742, 
                    0.21712996796223605, 
                    -0.07199828470163394, 
                    0.13126224344129478, 
                    0.6555891593438847, 
                    -0.039816623638972204, 
                    -0.381841482843872, 
                    0.21599083699617916, 
                    -0.28192853146897495, 
                    0.48880984789489546, 
                    0.6932247803461555, 
                    0.13835802180897394, 
                    0.02203858799613545, 
                    0.5845320890502612, 
                    0.4300256066090671, 
                    0.05193440459927612, 
                    -0.2379943945834816, 
                    -0.42483988219726615, 
                    0.5315539827160234, 
                    0.027328907252401224, 
                    0.38524849112264903, 
                    0.41589145153656126, 
                    -0.03569314142900615, 
                    0.5622318215603848, 
                    -0.5461174826424137, 
                    -0.48306982178999036, 
                    -0.5659627048388105, 
                    -0.33854303241905126, 
                    -0.1339708717509167, 
                    0.6426028383925975, 
                    0.6243591659341221, 
                    -0.38455818259430524, 
                    -0.3402364689464346, 
                    -0.5569268344718146, 
                    -0.3600965619670785, 
                    -0.413650780196148, 
                    0.32027697230351615, 
                    0.4568962293810417, 
                    0.20464316069516564, 
                    -0.3100642505720958, 
                    0.04341535152896492, 
                    -0.6323323385897374, 
                    -0.5349786084530426, 
                    -0.005345184943120862, 
                    0.041869802802114386, 
                    0.35941220236563676, 
                    -0.4306905817842271, 
                    0.2963769379769964, 
                    0.22753986166210116, 
                    -0.36342712929897286, 
                    -0.20244580490341213, 
                    0.06305925032591608, 
                    -0.4956733250630754, 
                    0.47477842444365725, 
                    0.34376806542216976, 
                    -0.16381410050656875, 
                    0.029754631544879784, 
                    -0.3964943470050334, 
                    -0.2325388833809066, 
                    -0.43719106641420724, 
                    -0.308829428642254, 
                    -0.27505699298086717, 
                    -0.07316683186950046, 
                    -0.3859059464523183, 
                    0.06097684782631485, 
                    0.07395202121666034, 
                    -0.18572540297695833, 
                    0.22602685808751322, 
                    -0.06682264947344474, 
                    0.013012584186160914, 
                    0.6490804640279906, 
                    0.12070241802872983, 
                    0.4216510329616514, 
                    0.14357350064039343, 
                    0.1872505233677888, 
                    0.20859357043651439 
)
)

