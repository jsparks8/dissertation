model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.353597, 1);
tau[2,2] ~ dlnorm(-0.228027, 1);
tau[3,2] ~ dlnorm(-0.299921, 1);
tau[4,2] ~ dlnorm(-0.154976, 1);
tau[5,2] ~ dlnorm(-0.417363, 1);
tau[6,2] ~ dlnorm(-0.517406, 1);
tau[7,2] ~ dlnorm(-0.284729, 1);
tau[8,2] ~ dlnorm(-0.289086, 1);
tau[9,2] ~ dlnorm(-0.301344, 1);
tau[10,2] ~ dlnorm(-0.116545, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -0.7609419437056613, 
                    -1.1059051654762544, 
                    -0.9031165495778176, 
                    -1.3274480228474832, 
                    -0.6016658029550429, 
                    -0.37136870314481485, 
                    0.9447620977110196, 
                    0.9327527039411077, 
                    0.899246532332679, 
                    1.4506586133263721 ),
tau=matrix(c( NA,1.157662932723842, 
                    NA,1.3125514192988383, 
                    NA,1.2214993307604403, 
                    NA,1.4120241622585201, 
                    NA,1.0861479455268144, 
                    NA,0.982744547712022, 
                    NA,1.2401981818722478, 
                    NA,1.2348059640695574, 
                    NA,1.219761693017373, 
                    NA,1.4673457173835411 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 0.2008683335846979, 
                    0.24174240763680588, 
                    -0.11493120160212317, 
                    -0.12952821729844444, 
                    0.06375948105693774, 
                    0.24174240763680588, 
                    0.14075519125405045, 
                    -0.18625572049890904, 
                    0.13186927838704066, 
                    -0.1869621554265509, 
                    -0.06633466935671128, 
                    0.24174240763680588, 
                    -0.30042153283369083, 
                    0.13186927838704066, 
                    0.05342829644922903, 
                    0.14075519125405045, 
                    0.10534856130768655, 
                    0.10752095085198776, 
                    0.24174240763680588, 
                    -0.041373994458495655, 
                    0.14075519125405045, 
                    0.003599002369452209, 
                    -0.24857994569851657, 
                    -0.16509005758516648, 
                    -0.22582277913148427, 
                    0.18551519359734925, 
                    -0.053302736570168374, 
                    0.18551519359734925, 
                    -0.1869621554265509, 
                    0.2008683335846979, 
                    0.14874885335299315, 
                    0.06404670583260358, 
                    0.11919498989338839, 
                    -0.053302736570168374, 
                    0.08100023377263366, 
                    0.2008683335846979, 
                    0.05342829644922903, 
                    0.13712971227118664, 
                    0.14075519125405045, 
                    -0.12877763018782495, 
                    -0.24142532280723095, 
                    0.14075519125405045, 
                    0.0510092198547244, 
                    0.09018910184880852, 
                    0.14075519125405045, 
                    -0.14836888896236783, 
                    0.12636162251591115, 
                    -0.184284769227825, 
                    0.24174240763680588, 
                    0.14075519125405045, 
                    -0.262518459692741, 
                    0.24174240763680588, 
                    0.1748967842139748, 
                    0.05342829644922903, 
                    0.2008683335846979, 
                    -0.06633466935671128, 
                    -0.11493120160212317, 
                    -0.11282255159121712, 
                    -0.08439959784607393, 
                    -0.046632525903285815, 
                    0.1507099500509641, 
                    0.05342829644922903, 
                    0.1748967842139748, 
                    -0.23430353185462652, 
                    0.2008683335846979, 
                    -0.21556405431211928, 
                    0.2008683335846979, 
                    -0.04727004224495479, 
                    0.05342829644922903, 
                    0.030430748331189472, 
                    0.11159759931743546, 
                    -0.041373994458495655, 
                    0.24174240763680588, 
                    0.07935097120511703, 
                    0.1507099500509641, 
                    -0.022864846003842143, 
                    -0.12408858580779702, 
                    0.012484915236462002, 
                    -0.1408358495090622, 
                    0.14075519125405045, 
                    -0.001221888194906262, 
                    0.2008683335846979, 
                    0.1507099500509641, 
                    -0.11282255159121712, 
                    0.03025067175741719, 
                    0.08377093927737495, 
                    -0.32506176296016176, 
                    -0.17235602711615222, 
                    0.059130709150904015, 
                    -0.17432697838723626, 
                    0.15189923609593525, 
                    0.06375948105693774, 
                    0.1507099500509641, 
                    0.1748967842139748, 
                    -0.1953253675366777, 
                    -0.053302736570168374, 
                    0.2008683335846979, 
                    -0.3340237252350101, 
                    0.15189923609593525, 
                    0.02859684940373669, 
                    -0.09501800722944848, 
                    0.012484915236462002, 
                    0.24174240763680588, 
                    0.2008683335846979, 
                    -0.08663334261996919, 
                    0.09095499256954731, 
                    0.05523930663004334, 
                    -0.20469455228671407, 
                    -0.04869002826769098, 
                    -0.24427004564337723, 
                    0.1885877694595519, 
                    0.2008683335846979, 
                    0.24174240763680588, 
                    0.2008683335846979, 
                    0.09708336806528023, 
                    -0.12408858580779702, 
                    -0.3541204416765284, 
                    0.24174240763680588, 
                    0.11159759931743546, 
                    0.18766396993878942, 
                    0.16541847715583102, 
                    -0.06633466935671128, 
                    -0.12408858580779702, 
                    -0.35288842300022233, 
                    -0.030534069227133476, 
                    0.08377093927737495, 
                    -0.09506496223633865, 
                    0.24174240763680588, 
                    -0.009075286124200055, 
                    -0.2242198681361579, 
                    -0.18625572049890904, 
                    0.24174240763680588, 
                    0.0433062193386734, 
                    -0.35288842300022233, 
                    0.08872015595515337, 
                    0.2008683335846979, 
                    0.24174240763680588, 
                    -0.11282255159121712, 
                    0.16541847715583102, 
                    0.03807515646188042, 
                    0.1748967842139748, 
                    -0.20469455228671407, 
                    -0.17432697838723626, 
                    -0.21182024719901613, 
                    -0.3541204416765284, 
                    0.18766396993878942, 
                    0.04151670597399698, 
                    0.24174240763680588, 
                    0.08377093927737495, 
                    0.1507099500509641, 
                    0.05342829644922903, 
                    -0.22582277913148427, 
                    0.1748967842139748, 
                    -0.08406706621687443, 
                    0.24174240763680588, 
                    -0.10435902043867401, 
                    -0.06633466935671128, 
                    0.01846464968785705, 
                    0.24174240763680588, 
                    -0.3168713256772786, 
                    0.24174240763680588, 
                    0.09708336806528023, 
                    -0.006355756427461445, 
                    -0.10051461507059334, 
                    0.18551519359734925, 
                    -0.2694127593113622, 
                    -0.027915957788123502, 
                    -0.09599580832854726, 
                    0.025262775798498116, 
                    0.10752095085198776, 
                    0.10534856130768655, 
                    0.14075519125405045, 
                    0.1748967842139748, 
                    -0.041373994458495655, 
                    0.012484915236462002, 
                    0.2008683335846979, 
                    -0.1771755823520136, 
                    0.14075519125405045, 
                    0.06742222909344431, 
                    -0.22582277913148427, 
                    -0.2242198681361579, 
                    -0.046632525903285815, 
                    0.05342829644922903, 
                    0.07679141384348065, 
                    0.2008683335846979, 
                    -0.1771755823520136, 
                    0.24174240763680588, 
                    -0.19461893260903584, 
                    0.09708336806528023, 
                    -0.3541204416765284, 
                    0.2008683335846979, 
                    -0.006355756427461445, 
                    -0.053302736570168374, 
                    -0.07469788146683803, 
                    -0.19202135758925368, 
                    0.1748967842139748, 
                    -0.36959202675643554, 
                    0.1748967842139748, 
                    0.18551519359734925, 
                    -0.06633466935671128, 
                    0.013503408056151911, 
                    0.06375948105693774, 
                    0.07679141384348065, 
                    -0.03287647350681555, 
                    -0.22608132211440393, 
                    -0.198113200607186, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    0.012484915236462002, 
                    0.24174240763680588, 
                    -0.17503341331487812, 
                    -0.12408858580779702, 
                    0.08872015595515337, 
                    -0.2949544644570759, 
                    0.24174240763680588, 
                    -0.2694127593113622, 
                    0.2008683335846979, 
                    0.1231575164912102, 
                    0.24174240763680588, 
                    -0.12456770157975239, 
                    -0.11282255159121712, 
                    0.14075519125405045, 
                    -0.3105631824942534, 
                    -0.29227707825835, 
                    -0.001221888194906262, 
                    -0.04984530973889251, 
                    -0.23396290288249533, 
                    -0.20982525243922495, 
                    0.1748967842139748, 
                    -0.03389866459237639, 
                    -0.12408858580779702, 
                    0.14075519125405045, 
                    0.012484915236462002, 
                    -0.08328285442992261, 
                    -0.2949544644570759, 
                    -0.21824144051084524, 
                    -0.08430262403958955, 
                    0.14874885335299315, 
                    -0.011598811787262353, 
                    0.14075519125405045, 
                    -0.041373994458495655, 
                    0.012484915236462002, 
                    -0.198113200607186, 
                    0.2008683335846979, 
                    -0.12408858580779702, 
                    -0.3541204416765284, 
                    -0.11282255159121712, 
                    -0.3105631824942534, 
                    0.06404670583260358, 
                    0.24174240763680588, 
                    0.030430748331189472, 
                    0.0543902963069014, 
                    0.03025067175741719, 
                    0.24174240763680588, 
                    0.059130709150904015, 
                    0.012484915236462002, 
                    -0.2929835131859918, 
                    -0.17235602711615222, 
                    -0.006355756427461445, 
                    -0.12668349446229815, 
                    -0.046632525903285815, 
                    -0.01887391883917411, 
                    0.24174240763680588, 
                    -0.31490643396929346, 
                    -0.12408858580779702, 
                    -0.12657992239391433, 
                    0.24174240763680588, 
                    0.012484915236462002, 
                    0.13712971227118664, 
                    0.24174240763680588, 
                    -0.36947358166387706, 
                    0.14075519125405045, 
                    -0.04727004224495479, 
                    0.24174240763680588, 
                    -0.006355756427461445, 
                    -0.17503341331487812, 
                    0.14075519125405045, 
                    -0.2267485106571768, 
                    0.14874885335299315, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    0.1748967842139748, 
                    0.10534856130768655, 
                    -0.16509005758516648, 
                    0.059130709150904015, 
                    0.09484666235833544, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    0.09708336806528023, 
                    -0.2203101224738981, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    0.18551519359734925, 
                    -0.30042153283369083, 
                    -0.18625572049890904, 
                    0.04151670597399698, 
                    0.2008683335846979, 
                    -0.06633466935671128, 
                    -0.08218854709156753, 
                    0.11159759931743546, 
                    -0.14836888896236783, 
                    0.05342829644922903, 
                    -0.18625572049890904, 
                    0.1748967842139748, 
                    0.24174240763680588, 
                    -0.1102018450094126, 
                    0.05944003241197149, 
                    0.24174240763680588, 
                    0.2008683335846979, 
                    -0.23396290288249533, 
                    -0.2317291581086001, 
                    0.05342829644922903, 
                    0.14874885335299315, 
                    0.05342829644922903, 
                    0.015433210140992082, 
                    -0.31490643396929346, 
                    -0.2204436618225995, 
                    0.012484915236462002, 
                    0.2008683335846979, 
                    -0.18254305053110995, 
                    0.09708336806528023, 
                    0.24174240763680588, 
                    0.14075519125405045, 
                    0.16541847715583102, 
                    0.24174240763680588, 
                    0.1748967842139748, 
                    0.08377093927737495, 
                    0.0543902963069014, 
                    0.08377093927737495, 
                    0.07935097120511703, 
                    0.2008683335846979, 
                    0.08100023377263366, 
                    0.1748967842139748, 
                    0.24174240763680588, 
                    -0.35288842300022233, 
                    -0.006355756427461445, 
                    -0.06633466935671128, 
                    0.012484915236462002, 
                    -0.15632074420125855, 
                    0.24174240763680588, 
                    0.11919498989338839, 
                    0.2008683335846979, 
                    0.01794273523679335, 
                    -0.198113200607186, 
                    -0.06633466935671128, 
                    0.19116516727558497, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    -0.3541204416765284, 
                    0.0543902963069014, 
                    -0.36959202675643554, 
                    0.01794273523679335, 
                    0.2008683335846979, 
                    -0.24132175073884712, 
                    0.09708336806528023, 
                    -0.2949544644570759, 
                    -0.041373994458495655, 
                    0.12636162251591115, 
                    0.1748967842139748, 
                    0.14075519125405045, 
                    -0.09345458130814738, 
                    0.05342829644922903, 
                    -0.06633466935671128, 
                    0.1748967842139748, 
                    -0.17422949879346322, 
                    -0.2983111716672828, 
                    -0.06633466935671128, 
                    0.24174240763680588, 
                    0.18551519359734925, 
                    -0.3105631824942534, 
                    0.14075519125405045, 
                    0.012484915236462002, 
                    0.24174240763680588, 
                    -0.36959202675643554, 
                    0.09708336806528023, 
                    -0.2327624307847254, 
                    -0.12668349446229815, 
                    -0.22582277913148427, 
                    -0.12408858580779702, 
                    -0.046632525903285815, 
                    -0.17432697838723626, 
                    0.24174240763680588, 
                    0.14075519125405045, 
                    -0.08218854709156753, 
                    -0.31490643396929346, 
                    -0.04423282797358724, 
                    0.1748967842139748, 
                    0.1048014211552491, 
                    0.08377093927737495, 
                    0.012484915236462002, 
                    -0.03389866459237639, 
                    -0.36959202675643554, 
                    -0.35288842300022233, 
                    0.003599002369452209, 
                    0.06404670583260358, 
                    -0.31490643396929346, 
                    -0.05443667486747761, 
                    -0.36947358166387706, 
                    0.2008683335846979, 
                    -0.07469788146683803, 
                    -0.22175490489172764, 
                    0.24174240763680588, 
                    0.24174240763680588, 
                    -0.2949544644570759, 
                    0.14075519125405045, 
                    0.14075519125405045, 
                    -0.14824369582296026, 
                    0.09708336806528023, 
                    0.14075519125405045, 
                    0.14075519125405045, 
                    -0.31490643396929346, 
                    -0.12668349446229815, 
                    0.06742222909344431, 
                    -0.20469455228671407, 
                    -0.11282255159121712, 
                    0.012484915236462002, 
                    -0.06633466935671128, 
                    -0.2548501984115028, 
                    0.012484915236462002, 
                    -0.15932409432960937, 
                    0.15189923609593525, 
                    -0.11282255159121712, 
                    -0.36959202675643554, 
                    -0.12408858580779702, 
                    -0.03287647350681555, 
                    0.11747570964890142, 
                    0.1748967842139748, 
                    -0.24857994569851657, 
                    0.14874885335299315, 
                    -0.08471718961258645, 
                    0.2008683335846979, 
                    0.07679141384348065, 
                    -0.10051461507059334, 
                    -0.3541204416765284, 
                    -0.041373994458495655, 
                    0.07935097120511703, 
                    0.14075519125405045, 
                    0.012484915236462002, 
                    -0.030534069227133476, 
                    0.04485403457304099, 
                    0.14874885335299315, 
                    0.13712971227118664, 
                    0.24174240763680588, 
                    -0.11282255159121712, 
                    0.09708336806528023, 
                    -0.35288842300022233, 
                    0.24174240763680588, 
                    -0.11282255159121712, 
                    -0.041373994458495655, 
                    -0.3105631824942534, 
                    0.24174240763680588, 
                    -0.08662662357851086, 
                    0.15189923609593525, 
                    0.1748967842139748, 
                    -0.30573496035036574, 
                    0.2008683335846979, 
                    0.2008683335846979, 
                    0.012484915236462002, 
                    -0.16509005758516648, 
                    0.012484915236462002, 
                    0.05342829644922903, 
                    0.10080751123218307, 
                    -0.041373994458495655, 
                    0.1748967842139748, 
                    -0.11282255159121712, 
                    0.08872015595515337, 
                    0.1748967842139748, 
                    -0.35288842300022233, 
                    -0.184284769227825, 
                    0.24174240763680588, 
                    0.14075519125405045, 
                    -0.010310324864282239, 
                    -0.3105631824942534, 
                    -0.3340237252350101, 
                    0.24174240763680588, 
                    -0.3541204416765284, 
                    0.24174240763680588, 
                    0.0543902963069014, 
                    0.1507099500509641, 
                    0.13186927838704066, 
                    0.1507099500509641, 
                    -0.14836888896236783, 
                    -0.27294028296480666, 
                    0.24174240763680588, 
                    -0.262518459692741, 
                    0.012484915236462002, 
                    -0.17235602711615222, 
                    -0.11283706587659637, 
                    -0.1408358495090622, 
                    0.24174240763680588, 
                    -0.24132175073884712, 
                    -0.12877763018782495, 
                    -0.05443667486747761, 
                    -0.32050448417511435, 
                    0.2008683335846979, 
                    -0.17468615908353996, 
                    0.2008683335846979, 
                    -0.022921714709901897, 
                    0.09708336806528023 
)
)

