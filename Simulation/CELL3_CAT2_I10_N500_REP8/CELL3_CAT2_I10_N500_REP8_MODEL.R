model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.328591, 1);
tau[2,2] ~ dlnorm(-0.387732, 1);
tau[3,2] ~ dlnorm(-0.1339, 1);
tau[4,2] ~ dlnorm(-0.147185, 1);
tau[5,2] ~ dlnorm(-0.591014, 1);
tau[6,2] ~ dlnorm(-0.509706, 1);
tau[7,2] ~ dlnorm(-0.271093, 1);
tau[8,2] ~ dlnorm(-0.350998, 1);
tau[9,2] ~ dlnorm(-0.248739, 1);
tau[10,2] ~ dlnorm(-0.210309, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 0.8262286385837149, 
                    0.6744166834027585, 
                    1.3944319534281249, 
                    1.3520452324887615, 
                    0.2160472044231806, 
                    0.3882882186111988, 
                    -0.9826826963656297, 
                    -0.767651085104476, 
                    -1.0459812661176988, 
                    -1.1581619776889833 ),
tau=matrix(c( NA,1.186976658724088, 
                    NA,1.1188130908478386, 
                    NA,1.4420999470892282, 
                    NA,1.423068309387454, 
                    NA,0.9130051947860081, 
                    NA,0.9903414101564283, 
                    NA,1.2572245306681678, 
                    NA,1.1606753372119099, 
                    NA,1.285645588486847, 
                    NA,1.3360147279823535 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 0.21779025813024344, 
                    0.11035747014628905, 
                    0.21345414989963446, 
                    -0.03378139908921765, 
                    -0.005586572310339349, 
                    -0.1761419257316431, 
                    0.0544506984187863, 
                    0.2732081431631074, 
                    -0.06227816136196074, 
                    0.0693152806641279, 
                    -0.17794719340030918, 
                    0.2176740545497724, 
                    -0.17794719340030918, 
                    0.20525602375000385, 
                    0.08538108629555369, 
                    -0.21839257997255976, 
                    0.07505877562947405, 
                    0.24265017789780224, 
                    -0.21839257997255976, 
                    -0.09043856011028317, 
                    0.11234399682376411, 
                    0.23252938088573843, 
                    0.07636096671022335, 
                    0.06644939052582588, 
                    -0.049023513183536455, 
                    0.06644939052582588, 
                    0.012096859005529398, 
                    -0.09043856011028317, 
                    -0.15332254353634106, 
                    0.22569377123511514, 
                    0.05408044871729656, 
                    0.2176740545497724, 
                    0.10202168615768448, 
                    -0.1894299276795104, 
                    -0.022082780334327395, 
                    -0.17794719340030918, 
                    -0.17794719340030918, 
                    -0.09308773016899341, 
                    0.2916967831596575, 
                    0.13869559700805545, 
                    -0.1894299276795104, 
                    0.36882610881170064, 
                    0.15609123332138192, 
                    -0.17794719340030918, 
                    0.004545252053661769, 
                    -0.21839257997255976, 
                    0.047851833032240165, 
                    -0.21839257997255976, 
                    -0.09308773016899341, 
                    0.04328122115849414, 
                    -0.04529105844400361, 
                    0.20445692164997387, 
                    0.038518591412816716, 
                    0.0035654070997680476, 
                    -0.15332254353634106, 
                    -0.15332254353634106, 
                    -0.1761419257316431, 
                    -0.09308773016899341, 
                    0.15609123332138192, 
                    -0.017786960912483912, 
                    -0.1894299276795104, 
                    0.34382205616627326, 
                    -0.21839257997255976, 
                    -0.1761419257316431, 
                    -0.15332254353634106, 
                    0.040625383850441454, 
                    0.2541329121770034, 
                    0.11114228747040761, 
                    -0.17794719340030918, 
                    0.11234399682376411, 
                    0.043027246882296755, 
                    -0.09043856011028317, 
                    0.0035654070997680476, 
                    -0.11087094441251409, 
                    -0.06477149788780556, 
                    -0.11369672580847168, 
                    0.0035654070997680476, 
                    0.3346952810417666, 
                    0.15609123332138192, 
                    -0.1761419257316431, 
                    -0.1894299276795104, 
                    0.01629536051863495, 
                    -0.1894299276795104, 
                    -0.14610262630206566, 
                    0.21430111125066326, 
                    -0.14610262630206566, 
                    -0.15332254353634106, 
                    -0.1282476892196398, 
                    -0.12023478125026232, 
                    -0.09308773016899341, 
                    0.3238515699574126, 
                    0.21345414989963446, 
                    -0.1894299276795104, 
                    -0.1761419257316431, 
                    -0.1894299276795104, 
                    0.28843626616432194, 
                    -0.17794719340030918, 
                    0.1316843025348502, 
                    -0.09329207644569476, 
                    0.3238515699574126, 
                    0.2331496589346116, 
                    -0.12023478125026232, 
                    -0.21839257997255976, 
                    0.050326907204589544, 
                    -0.11236730743179868, 
                    0.1289128155471706, 
                    -0.11087094441251409, 
                    0.18078316514810122, 
                    -0.1894299276795104, 
                    0.12772814192534587, 
                    0.09634381269018044, 
                    0.15213507271187765, 
                    0.07636096671022335, 
                    0.05643578796852727, 
                    0.0787822209090075, 
                    -0.12023478125026232, 
                    0.3034138224723012, 
                    -0.11369672580847168, 
                    -0.0863332479261649, 
                    0.04162146750915158, 
                    -0.06227816136196074, 
                    -0.0863332479261649, 
                    0.15213507271187765, 
                    0.33214421346004575, 
                    0.01629536051863495, 
                    -0.1894299276795104, 
                    0.12268893062745562, 
                    0.13869559700805545, 
                    0.24362023512937253, 
                    0.18346250956966426, 
                    0.13869559700805545, 
                    -0.13543951448686864, 
                    0.115342437792465, 
                    -0.11087094441251409, 
                    -0.06227816136196074, 
                    0.18171999678994244, 
                    -0.1894299276795104, 
                    -0.06227816136196074, 
                    0.07505877562947405, 
                    -0.21839257997255976, 
                    -0.12023478125026232, 
                    -0.21839257997255976, 
                    -0.005586572310339349, 
                    0.0035654070997680476, 
                    0.08538108629555369, 
                    0.33214421346004575, 
                    -0.21839257997255976, 
                    -0.09308773016899341, 
                    -0.12023478125026232, 
                    -0.1761419257316431, 
                    -0.017786960912483912, 
                    0.2132045052969927, 
                    0.1955110806897546, 
                    0.07721445391257709, 
                    0.25980345813939926, 
                    0.2535874064197229, 
                    -0.1894299276795104, 
                    0.24687008254794018, 
                    0.15200694264421277, 
                    0.26120552329868385, 
                    -0.21839257997255976, 
                    -0.06477149788780556, 
                    0.06638337830215507, 
                    0.006214577158478174, 
                    -0.1894299276795104, 
                    0.055481935443116304, 
                    -0.14610262630206566, 
                    -0.21839257997255976, 
                    0.02812306125350897, 
                    0.3346952810417666, 
                    -0.09308773016899341, 
                    -0.17794719340030918, 
                    -0.1894299276795104, 
                    -0.1894299276795104, 
                    0.24907171669970873, 
                    -0.21839257997255976, 
                    -0.07043352710763046, 
                    -0.08466330106531594, 
                    0.11187302438088265, 
                    0.3238515699574126, 
                    0.0787822209090075, 
                    -0.15473191180754908, 
                    -0.0863332479261649, 
                    -0.021350669986142934, 
                    0.1451237782386724, 
                    0.24715246187431955, 
                    0.05647620293266886, 
                    0.17020860209009686, 
                    0.26914819175571614, 
                    0.0693152806641279, 
                    0.31013433155300285, 
                    0.36743595811173646, 
                    -0.14610262630206566, 
                    0.29688502276930906, 
                    -0.12023478125026232, 
                    0.1338314598775216, 
                    0.07636096671022335, 
                    -0.12595126728805883, 
                    -0.022082780334327395, 
                    -0.21839257997255976, 
                    0.011300966326935308, 
                    0.0787822209090075, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    0.17913871710074142, 
                    0.1305709428821859, 
                    -0.022082780334327395, 
                    0.3034138224723012, 
                    0.3346952810417666, 
                    -0.09043856011028317, 
                    0.01629536051863495, 
                    -0.02370548781610768, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    -0.1894299276795104, 
                    0.12127411183440862, 
                    0.0035654070997680476, 
                    -0.10365531403280513, 
                    -0.0863332479261649, 
                    -0.1894299276795104, 
                    -0.005586572310339349, 
                    0.2658554943362265, 
                    -0.1894299276795104, 
                    0.1998021856372853, 
                    0.2422643082435798, 
                    -0.21839257997255976, 
                    -0.08232266678224232, 
                    -0.07967349672353197, 
                    0.34382205616627326, 
                    0.0787822209090075, 
                    -0.1894299276795104, 
                    -0.1761419257316431, 
                    -0.017786960912483912, 
                    0.1470807686612154, 
                    -0.03651696018710682, 
                    -0.1894299276795104, 
                    -0.1894299276795104, 
                    -0.14610262630206566, 
                    -0.21839257997255976, 
                    -0.21839257997255976, 
                    -0.06227816136196074, 
                    -0.0863332479261649, 
                    -0.21839257997255976, 
                    -0.007774264659168556, 
                    0.0035654070997680476, 
                    -0.0863332479261649, 
                    0.06644939052582588, 
                    -0.10793185166540387, 
                    -0.15332254353634106, 
                    0.3238515699574126, 
                    -0.14610262630206566, 
                    -0.08232266678224232, 
                    0.07505877562947405, 
                    -0.1894299276795104, 
                    -0.15887196241420526, 
                    -0.12023478125026232, 
                    0.1865809656791101, 
                    0.1955110806897546, 
                    -0.21839257997255976, 
                    0.1305709428821859, 
                    0.36743595811173646, 
                    -0.06227816136196074, 
                    -0.21839257997255976, 
                    -0.09308773016899341, 
                    0.1865809656791101, 
                    -0.15887196241420526, 
                    0.29688502276930906, 
                    -0.1894299276795104, 
                    -0.09308773016899341, 
                    0.07636096671022335, 
                    0.10221217245976305, 
                    0.33826814354639556, 
                    -0.12023478125026232, 
                    -0.15332254353634106, 
                    0.07721445391257709, 
                    0.20096600213452276, 
                    0.11467524644786248, 
                    0.0035654070997680476, 
                    0.13639152965192292, 
                    -0.21839257997255976, 
                    -0.02084152368676362, 
                    0.1998021856372853, 
                    -0.1894299276795104, 
                    -0.06477149788780556, 
                    -0.21839257997255976, 
                    -0.013545487314249788, 
                    0.3573433745324994, 
                    -0.21839257997255976, 
                    -0.21839257997255976, 
                    -0.15332254353634106, 
                    0.14956733158432267, 
                    0.2510847262866201, 
                    -0.12023478125026232, 
                    -0.1894299276795104, 
                    0.30362150763148643, 
                    -0.1894299276795104, 
                    -0.06227816136196074, 
                    -0.11594475963478135, 
                    -0.17794719340030918, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    0.14787426393112424, 
                    0.03349182976365678, 
                    0.040625383850441454, 
                    -0.21839257997255976, 
                    -0.21839257997255976, 
                    0.07020315943937178, 
                    0.36743595811173646, 
                    -0.1894299276795104, 
                    -0.15473191180754908, 
                    0.12909859250474254, 
                    -0.17794719340030918, 
                    -0.21839257997255976, 
                    -0.049023513183536455, 
                    0.2916967831596575, 
                    -0.17794719340030918, 
                    -0.15332254353634106, 
                    0.15213507271187765, 
                    -0.1894299276795104, 
                    0.2176740545497724, 
                    -0.15332254353634106, 
                    0.3346952810417666, 
                    0.15609123332138192, 
                    0.08538108629555369, 
                    -0.09043856011028317, 
                    -0.11087094441251409, 
                    0.26120552329868385, 
                    -0.14610262630206566, 
                    -0.08232266678224232, 
                    0.12653928364489608, 
                    -0.03651696018710682, 
                    0.0035654070997680476, 
                    0.23252938088573843, 
                    -0.14875116540214145, 
                    0.11035747014628905, 
                    -0.1761419257316431, 
                    -0.14610262630206566, 
                    0.0035654070997680476, 
                    0.05195736189294131, 
                    -0.21839257997255976, 
                    0.25965994455690633, 
                    -0.02370548781610768, 
                    -0.06477149788780556, 
                    0.17253985171419528, 
                    -0.21839257997255976, 
                    -0.0863332479261649, 
                    0.07353518531426584, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    0.31013433155300285, 
                    0.12030702189093584, 
                    0.32814734653433175, 
                    0.07505877562947405, 
                    -0.17794719340030918, 
                    -0.17794719340030918, 
                    0.17249505448695468, 
                    -0.06227816136196074, 
                    0.33826814354639556, 
                    -0.1894299276795104, 
                    0.12030702189093584, 
                    -0.15332254353634106, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    -0.21839257997255976, 
                    0.34382205616627326, 
                    0.12184020442549032, 
                    -0.1894299276795104, 
                    -0.12595126728805883, 
                    -0.1894299276795104, 
                    -0.06477149788780556, 
                    -0.022082780334327395, 
                    -0.15332254353634106, 
                    0.006214577158478174, 
                    -0.022082780334327395, 
                    -0.0863332479261649, 
                    -0.21839257997255976, 
                    0.3346952810417666, 
                    -0.0938119620309172, 
                    -0.1894299276795104, 
                    0.08538108629555369, 
                    0.101184373644012, 
                    -0.21839257997255976, 
                    0.22569377123511514, 
                    -0.21839257997255976, 
                    -7.967173147270801e-4, 
                    -0.21839257997255976, 
                    0.06240985731999438, 
                    -0.21839257997255976, 
                    -0.1894299276795104, 
                    0.008973171246119432, 
                    -0.21839257997255976, 
                    -0.15473191180754908, 
                    -0.10365531403280513, 
                    0.1289128155471706, 
                    0.006214577158478174, 
                    0.2176740545497724, 
                    -0.21839257997255976, 
                    -0.038786377218107265, 
                    -0.019256998938369796, 
                    0.0035654070997680476, 
                    0.22084672934975302, 
                    0.26443111750407694, 
                    -0.010600046055126267, 
                    -0.017786960912483912, 
                    -0.1894299276795104, 
                    0.11226024111960703, 
                    -0.15332254353634106, 
                    0.06335575537791466, 
                    -0.1894299276795104, 
                    0.2447597497626935, 
                    0.34382205616627326, 
                    -0.21839257997255976, 
                    0.24362023512937253, 
                    -0.21839257997255976, 
                    0.30362150763148643, 
                    -0.0863332479261649, 
                    -0.15332254353634106, 
                    -0.15332254353634106, 
                    -0.21839257997255976, 
                    -0.017786960912483912, 
                    -0.06227816136196074, 
                    0.1865809656791101, 
                    0.08538108629555369, 
                    -0.1894299276795104, 
                    -0.049023513183536455, 
                    -0.11369672580847168, 
                    -0.005586572310339349, 
                    0.34382205616627326, 
                    0.07636096671022335, 
                    0.08538108629555369, 
                    0.1695915778245396, 
                    -0.15332254353634106, 
                    -0.038786377218107265, 
                    0.05408044871729656, 
                    -0.21839257997255976, 
                    -0.0863332479261649, 
                    0.2916967831596575, 
                    -0.21839257997255976, 
                    0.34382205616627326, 
                    0.34382205616627326, 
                    -0.04529105844400361, 
                    -0.07043352710763046, 
                    -0.1894299276795104, 
                    -7.967173147270801e-4, 
                    0.15665541311315145, 
                    -0.1894299276795104, 
                    -0.21839257997255976, 
                    -0.1894299276795104, 
                    0.08538108629555369, 
                    0.05408044871729656, 
                    -0.21839257997255976, 
                    -0.17794719340030918, 
                    0.23822800561535468, 
                    0.0026507865726274338, 
                    -0.023743733820730195, 
                    -0.023743733820730195, 
                    0.3034138224723012, 
                    0.2194893508603149, 
                    0.29688502276930906, 
                    -0.1894299276795104, 
                    -0.1894299276795104, 
                    0.26120552329868385, 
                    0.23525301377037455, 
                    -0.0863332479261649, 
                    0.26120552329868385, 
                    -0.06227816136196074, 
                    -0.09043856011028317, 
                    0.004545252053661769, 
                    0.01629536051863495, 
                    0.15609123332138192, 
                    -0.21839257997255976, 
                    -0.21839257997255976, 
                    -0.11369672580847168, 
                    -0.029561494439079683, 
                    0.36743595811173646, 
                    0.30362150763148643, 
                    -0.1761419257316431, 
                    -0.21839257997255976, 
                    -0.04710497292924115, 
                    0.1998021856372853, 
                    -0.07967349672353197, 
                    0.15609123332138192, 
                    0.14787426393112424, 
                    0.15609123332138192, 
                    0.13664754183984473, 
                    -0.0034458873734372064, 
                    -0.0863332479261649, 
                    -0.08573601309437576, 
                    -0.14610262630206566, 
                    -0.07967349672353197, 
                    -0.08232266678224232, 
                    0.050326907204589544, 
                    0.10916092895809193, 
                    -0.21839257997255976, 
                    0.31013433155300285, 
                    0.01629536051863495, 
                    0.031172098577826074, 
                    0.23200949530051612, 
                    0.14897931971997264, 
                    -0.15332254353634106 
)
)

