model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.195435, 1);
tau[1,3] ~ dlnorm(0.073658, 1);
tau[1,4] ~ dlnorm(-0.065032, 1);
tau[1,5] ~ dlnorm(-0.226102, 1);
tau[1,6] ~ dlnorm(-0.418193, 1);
tau[2,2] ~ dlnorm(0.259658, 1);
tau[2,3] ~ dlnorm(0.13995, 1);
tau[2,4] ~ dlnorm(0.003939, 1);
tau[2,5] ~ dlnorm(-0.153527, 1);
tau[2,6] ~ dlnorm(-0.34051, 1);
tau[3,2] ~ dlnorm(0.098319, 1);
tau[3,3] ~ dlnorm(-0.02686, 1);
tau[3,4] ~ dlnorm(-0.169982, 1);
tau[3,5] ~ dlnorm(-0.337065, 1);
tau[3,6] ~ dlnorm(-0.537777, 1);
tau[4,2] ~ dlnorm(-0.117416, 1);
tau[4,3] ~ dlnorm(-0.251502, 1);
tau[4,4] ~ dlnorm(-0.406392, 1);
tau[4,5] ~ dlnorm(-0.589749, 1);
tau[4,6] ~ dlnorm(-0.814449, 1);
tau[5,2] ~ dlnorm(-0.24405, 1);
tau[5,3] ~ dlnorm(-0.384379, 1);
tau[5,4] ~ dlnorm(-0.547665, 1);
tau[5,5] ~ dlnorm(-0.742918, 1);
tau[5,6] ~ dlnorm(-0.985778, 1);
tau[6,2] ~ dlnorm(-0.256709, 1);
tau[6,3] ~ dlnorm(-0.397709, 1);
tau[6,4] ~ dlnorm(-0.561904, 1);
tau[6,5] ~ dlnorm(-0.758461, 1);
tau[6,6] ~ dlnorm(-1.003344, 1);
tau[7,2] ~ dlnorm(-0.044249, 1);
tau[7,3] ~ dlnorm(-0.175087, 1);
tau[7,4] ~ dlnorm(-0.325658, 1);
tau[7,5] ~ dlnorm(-0.502989, 1);
tau[7,6] ~ dlnorm(-0.718694, 1);
tau[8,2] ~ dlnorm(0.036466, 1);
tau[8,3] ~ dlnorm(-0.091066, 1);
tau[8,4] ~ dlnorm(-0.237273, 1);
tau[8,5] ~ dlnorm(-0.408578, 1);
tau[8,6] ~ dlnorm(-0.615421, 1);
tau[9,2] ~ dlnorm(0.03862, 1);
tau[9,3] ~ dlnorm(-0.088827, 1);
tau[9,4] ~ dlnorm(-0.234923, 1);
tau[9,5] ~ dlnorm(-0.406075, 1);
tau[9,6] ~ dlnorm(-0.612696, 1);
tau[10,2] ~ dlnorm(0.153859, 1);
tau[10,3] ~ dlnorm(0.030667, 1);
tau[10,4] ~ dlnorm(-0.109861, 1);
tau[10,5] ~ dlnorm(-0.273419, 1);
tau[10,6] ~ dlnorm(-0.46906, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.428165936316696, 
                    1.6234138715488728, 
                    1.1557401702529064, 
                    0.637397157182503, 
                    0.3813331895281542, 
                    0.35747395641677104, 
                    -0.8008185725366292, 
                    -0.995525215141079, 
                    -1.0009411625277596, 
                    -1.308292801376858 ),
tau=matrix(c( NA,2.00458100263167,1.7747473783253014,1.544913754018933,1.3150801297125647,1.0852465054061964, 
                    NA,2.137544846524783,1.896386841974948,1.6552288374251132,1.4140708328752785,1.1729128283254437, 
                    NA,1.8190590559422295,1.605026126067561,1.3909931961928923,1.1769602663182237,0.9629273364435551, 
                    NA,1.4660674640412847,1.2820984289246995,1.0981293938081143,0.914160358691529,0.7301913235749438, 
                    NA,1.2916879020686731,1.1225705770760401,0.9534532520834071,0.7843359270907742,0.6152186020981412, 
                    NA,1.275439764319821,1.1077062748476483,0.9399727853754756,0.7722392959033029,0.6045058064311302, 
                    NA,1.5773574478974446,1.3839099706903202,1.1904624934831955,0.997015016276071,0.8035675390689465, 
                    NA,1.7099526715110747,1.505212209032892,1.3004717465547095,1.095731284076527,0.8909908215983444, 
                    NA,1.7136409316814043,1.5085863442547942,1.3035317568281841,1.098477169401574,0.8934225819749639, 
                    NA,1.9229473977376401,1.7000664152577825,1.4771854327779246,1.2543044502980667,1.031423467818209 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 0.3874751189480272, 
                    -0.4352899654230251, 
                    -0.44100996017222616, 
                    0.4321509195237423, 
                    0.23991968489700666, 
                    -0.4865252055287972, 
                    -0.20085565515563258, 
                    -0.24139665039669495, 
                    0.40805824087805465, 
                    -0.13560828718328732, 
                    -0.18407293827457227, 
                    0.3971710521000258, 
                    -0.48521854986852764, 
                    -0.3060158605068685, 
                    0.7095400123339983, 
                    -0.5755374464405435, 
                    0.434792804380141, 
                    -0.0013348971716865554, 
                    -0.3564046059951573, 
                    -0.13526263712698772, 
                    0.4583151727914849, 
                    0.7061498833572701, 
                    0.4440234479570684, 
                    -0.1808467028012375, 
                    0.4402815615106275, 
                    -0.17810094953342342, 
                    0.0030288732994688816, 
                    0.5303892977312303, 
                    -0.38502108022170123, 
                    0.6668384969958454, 
                    -0.04595452966982383, 
                    0.6820307581371814, 
                    -0.1456458043825387, 
                    0.11239433194985127, 
                    -0.1300383290599636, 
                    -0.4183895245564071, 
                    -0.33905236576024855, 
                    -0.3874232143794931, 
                    -0.5963883233098216, 
                    0.42554224001002283, 
                    -0.2191108691897679, 
                    0.7288142445960248, 
                    0.2597321394164953, 
                    -0.5305180998896868, 
                    -0.3648228392923471, 
                    -0.5701417423229563, 
                    -0.2575612776818371, 
                    0.24021614548698078, 
                    0.3498363781508995, 
                    0.3492335088091125, 
                    0.44465115507728115, 
                    -0.36789243888847445, 
                    -0.22535689281211946, 
                    0.8188802007613589, 
                    -0.32242867768842953, 
                    -0.17612906422108843, 
                    0.5482173793857945, 
                    -0.4384175265504324, 
                    -0.3117983288911058, 
                    -0.32247405239265925, 
                    -0.21118781694823652, 
                    0.6967292758332211, 
                    -0.38656798591523445, 
                    -0.05599244998278885, 
                    -0.11181099476738454, 
                    0.43639976041243855, 
                    -0.3055575523120615, 
                    -0.3965219562933387, 
                    -0.07962391475479769, 
                    0.38875386901854414, 
                    -0.2902732187244004, 
                    0.12313604963147484, 
                    0.6477907573084956, 
                    0.03946895420152974, 
                    -0.15569980848067766, 
                    -0.11221400624827782, 
                    -0.2083046023079106, 
                    0.5126730846816085, 
                    0.4355633929545202, 
                    -0.634998074274935, 
                    -0.0204884603207246, 
                    0.24462931502815155, 
                    -0.4188149976257194, 
                    -0.18461440448922672, 
                    0.7094507176450395, 
                    -0.3425456920192881, 
                    -0.04788678330279328, 
                    0.12889874895441777, 
                    -0.06048183327141199, 
                    0.2242370804328413, 
                    0.7353017583713959, 
                    -0.4430040549940855, 
                    -0.5558191390000247, 
                    0.2273233466574327, 
                    0.3032265197203686, 
                    0.4489765375830359, 
                    0.5357874303095704, 
                    0.29524442510182947, 
                    0.15768562888734672, 
                    0.5976984955754647, 
                    -0.01272651868144492, 
                    0.026344119618196382, 
                    0.5828263532406173, 
                    0.3509788480971655, 
                    0.20452746072679118, 
                    -0.43004509035576066, 
                    0.5183944949586616, 
                    -0.39156245478459306, 
                    -0.4539718007248448, 
                    -0.12288610533015787, 
                    0.4121519145666148, 
                    0.10686075345074231, 
                    -0.24223630699178195, 
                    0.5925957135185322, 
                    -0.4226020873432246, 
                    -0.39759616864180597, 
                    0.5677625797577004, 
                    -0.3008914862566714, 
                    0.022559809878137993, 
                    0.3633545064370497, 
                    0.18434884874018942, 
                    -0.4259058245640691, 
                    -0.37066071638517106, 
                    -0.5446882575279942, 
                    -0.2700604672638903, 
                    -0.015020348577305276, 
                    -0.4325544913387955, 
                    -0.07387052153328688, 
                    0.15240510805148122, 
                    -0.2894916527868429, 
                    0.2113609307561365, 
                    -0.6231537529705283, 
                    0.6882759863548427, 
                    -0.08356215949996271, 
                    0.5306646467373746, 
                    -0.337866554661361, 
                    -0.4256715297296333, 
                    -0.25417807202852705, 
                    -0.12408132894618973, 
                    0.28389828199974043, 
                    -0.36467507603689264, 
                    0.07737485588855497, 
                    0.5488257044199847, 
                    -0.25349744056894347, 
                    -0.403658139803422, 
                    -0.3378633385028149, 
                    -0.4085059769326006, 
                    -0.32986775129603063, 
                    0.7415440364802168, 
                    -0.01649212879993689, 
                    0.7176805687277861, 
                    -0.3853488181815634, 
                    0.3598029619022973, 
                    0.2167390673142181, 
                    -0.1205000767955603, 
                    0.45255934717325674, 
                    -0.2804181408968832, 
                    -0.23115685484026643, 
                    -0.5710171608553934, 
                    -0.46822408661524534, 
                    -0.36107901366322176, 
                    -0.37066071638517106, 
                    0.15991234489112716, 
                    0.17690792905399177, 
                    0.2903719522219156, 
                    0.3672762773688083, 
                    8.918210421815509e-5, 
                    -0.2708254590623891, 
                    -0.4566203004316617, 
                    0.8554507269424694, 
                    -0.38282638487730775, 
                    0.537501849942138, 
                    -0.0530822439512183, 
                    -0.052363125580784264, 
                    0.3596036112588604, 
                    0.07575521101977278, 
                    -0.06842540127648344, 
                    0.6889835886258129, 
                    0.19856486928842, 
                    0.5271673248162945, 
                    0.3938215600177637, 
                    0.7260857432884036, 
                    0.2639579912422634, 
                    -0.4322269323232955, 
                    -0.3555434352325302, 
                    -0.34510549611733743, 
                    0.27298053800449995, 
                    0.40778094623911243, 
                    -0.42223569846842945, 
                    0.4569403322497887, 
                    -0.39901926661212617, 
                    0.4884010529943523, 
                    0.21758076502429602, 
                    0.05577142557019066, 
                    0.48945658125838043, 
                    -0.1231265188289048, 
                    0.7284188654721604, 
                    -0.47988292118781484, 
                    0.12410704553668672, 
                    0.08200064107057403, 
                    0.3302177510912442, 
                    0.7479089119358189, 
                    0.007064640696847202, 
                    0.14343176710004646, 
                    -0.004875584816110057, 
                    0.3585062718462798, 
                    0.3137630461354719, 
                    0.8185303138424718, 
                    0.034317990846167046, 
                    -0.5328175372040618, 
                    -0.17858108769949632, 
                    -0.25275362016842035, 
                    0.07736164198846518, 
                    -0.37895603965574626, 
                    0.3491588049572303, 
                    -0.2925003999685976, 
                    -0.4104769856922571, 
                    0.2800990339194318, 
                    0.15482894250060153, 
                    -0.14829616210858831, 
                    -0.40794797258155463, 
                    0.46661780540981534, 
                    0.2524117201401056, 
                    0.08724116699610629, 
                    -0.4927085281367538, 
                    -0.11654989857339482, 
                    -0.4621054018361767, 
                    -0.33704673436037363, 
                    0.7319025380543656, 
                    -0.4604137181141825, 
                    0.06713180474380953, 
                    0.709830639911228, 
                    0.1456555949254168, 
                    0.7850883603888887, 
                    -0.04061955205304202, 
                    -0.03311954831234676, 
                    0.014952768959115237, 
                    0.5209513792472262, 
                    0.36962346436289617, 
                    -0.29868019602300017, 
                    0.6201584859203009, 
                    0.30453750760433795, 
                    -0.5646416701237332, 
                    -0.055308016322183406, 
                    0.6465507049610797, 
                    -0.1013383741584285, 
                    0.22247606534156494, 
                    -0.23800958284067014, 
                    0.04592784085052193, 
                    -0.11328631532209399, 
                    0.2828810527676683, 
                    0.14444404686330758, 
                    -0.26731764670729774, 
                    -0.3872741227391199, 
                    0.06716262976811138, 
                    -0.05914386061188526, 
                    0.5105846240621454, 
                    0.38796974463779477, 
                    0.7457678780168526, 
                    -0.13803297158058758, 
                    -0.15901388813585726, 
                    -0.1519984702469952, 
                    -0.40853378533562856, 
                    0.6801640143884236, 
                    -0.1064452418003744, 
                    -0.16622917673284943, 
                    -0.5026725600930635, 
                    -0.3927251532568925, 
                    0.5424078400156354, 
                    -0.25887653240719555, 
                    -0.47185953776911443, 
                    0.035221997477463574, 
                    -0.21667785992316219, 
                    -0.34111100572041425, 
                    0.4260079247115438, 
                    -0.5308382686540649, 
                    0.6031321873215187, 
                    0.13834848200760608, 
                    -0.4772207146731826, 
                    0.17735256281701473, 
                    -0.609362217334582, 
                    -0.39032202745679334, 
                    -0.32312587197980774, 
                    -0.09045727240505064, 
                    -0.5554733723088452, 
                    0.7301771180959458, 
                    0.7149701297498483, 
                    0.27212055066306373, 
                    0.7792805471909796, 
                    0.011526798952337991, 
                    0.07555590613483998, 
                    0.14526953496074946, 
                    -0.23321210714512047, 
                    -0.40190634946222537, 
                    0.2789410298676388, 
                    0.5812026234494365, 
                    0.6592434275964942, 
                    -0.45358416709821303, 
                    -0.24390534788431206, 
                    -0.6223793470938032, 
                    0.047350800486061106, 
                    0.22099700414148105, 
                    -0.5355407462776858, 
                    -0.10107985512761031, 
                    -0.41936914929356817, 
                    -0.6090527089492576, 
                    0.4345135790911645, 
                    -0.28809648530941245, 
                    -0.634998074274935, 
                    0.21728197493853185, 
                    0.005687824566056321, 
                    0.11880988767242007, 
                    -0.3224182460576367, 
                    -0.048134284599230415, 
                    -0.23888045490251314, 
                    -0.3889835659703993, 
                    0.06082852776329317, 
                    0.1585663451248941, 
                    0.7270863860394805, 
                    0.6104223915711007, 
                    0.6759047218509631, 
                    -0.4254067265350378, 
                    -0.19226411281884814, 
                    -0.4858130424375266, 
                    -0.1451445074754666, 
                    -0.32547434371926937, 
                    -0.29262727043019987, 
                    -0.5789828908502853, 
                    0.3161412716075259, 
                    -0.1320577373558266, 
                    -0.4082979416208484, 
                    0.3750456732338705, 
                    0.08188443508937038, 
                    -0.47140039995248956, 
                    0.15772116082025045, 
                    -0.4894464861313385, 
                    -0.5543407816923298, 
                    -0.19774131338080625, 
                    0.27163272038084374, 
                    0.1824003391571899, 
                    1.9054603103751955e-4, 
                    0.5453406600895656, 
                    -0.134618736838919, 
                    -0.48664420722793167, 
                    -0.12072075059570964, 
                    0.5909341867505344, 
                    -0.348966804964852, 
                    0.08554677959917356, 
                    0.5159073288030906, 
                    -0.3011063764138639, 
                    0.44139737714765337, 
                    0.22279508430889294, 
                    -0.2499449478026431, 
                    -0.5577785723447084, 
                    -0.5278083017414023, 
                    -0.17655782977252776, 
                    0.2811811846108099, 
                    -0.3447328554803674, 
                    0.1194394784965539, 
                    -0.4023275369217178, 
                    -0.10321781104408456, 
                    0.14148854395819477, 
                    0.06979489366986524, 
                    0.536019725375326, 
                    -0.06868111938707278, 
                    -0.3118043694461618, 
                    -0.6022131947974161, 
                    0.30598059383391607, 
                    -0.030013573727435294, 
                    -0.3837313919454103, 
                    0.0031451431017875953, 
                    0.21811240239237462, 
                    0.6296694930814697, 
                    0.49723899145077266, 
                    0.2961096514452761, 
                    -0.19804441434695785, 
                    -0.12337077035971011, 
                    -0.3490419772875446, 
                    -0.46385753877991603, 
                    0.3467489771690522, 
                    -0.4147102975728557, 
                    0.15129262455369574, 
                    -0.1387781938749028, 
                    -0.24502001196446255, 
                    0.37760604575032564, 
                    -0.09725551301557012, 
                    0.2434914727582015, 
                    -0.5311888745969738, 
                    0.48213760541288164, 
                    -0.09646207989956845, 
                    -0.49576279233143905, 
                    -0.15987595923661696, 
                    0.36004061603334125, 
                    0.325946759302973, 
                    -0.5543407816923298, 
                    -0.27774292853795385, 
                    0.7089416936376216, 
                    -0.0985810730748029, 
                    0.027133948542565678, 
                    0.5869087389880843, 
                    0.4938617960232865, 
                    -0.14725584306416867, 
                    -0.3580406550499507, 
                    0.39671598270358377, 
                    -0.15758716747579193, 
                    0.43409797741683254, 
                    0.721865019370898, 
                    0.5475212008231187, 
                    -0.4604849117433035, 
                    0.4513635377322942, 
                    0.2280001017296881, 
                    0.6909958888672161, 
                    -0.6223793470938032, 
                    -0.16443129234333137, 
                    -0.46905921050062127, 
                    0.01118164955883394, 
                    -0.3940486314395739, 
                    -0.5963883233098216, 
                    -0.12678703965651916, 
                    -0.10229649580959976, 
                    -0.41395644717837854, 
                    -0.3631956319114144, 
                    -0.23701160953070632, 
                    0.2727733283612477, 
                    0.25418607666606374, 
                    0.6644809874008142, 
                    0.057849056676804844, 
                    0.4772490286857094, 
                    0.344219151856636, 
                    0.2550516600530641, 
                    -0.46003612163366686, 
                    0.19173267639988567, 
                    0.012313056117067234, 
                    0.7645351644219975, 
                    -0.24751170959795327, 
                    -0.35421564070957134, 
                    -0.5153487037711645, 
                    -0.22887031189008317, 
                    0.2195375534127747, 
                    0.4355058729966874, 
                    -0.42617865668304267, 
                    0.19768200823424842, 
                    -0.3078595742503131, 
                    -0.11737306560909544, 
                    -0.12413307230871351, 
                    -0.19980389851859215, 
                    -0.45322732692387246, 
                    0.019221435292277045, 
                    -0.31163072257803504, 
                    -0.19245436920653863, 
                    -0.6292801260590145, 
                    -0.20766542299458762, 
                    -0.19446330675902695, 
                    -0.15481342495860656, 
                    0.6412154028026888, 
                    0.73371686107031, 
                    -0.21787139358189234, 
                    0.08843279970483342, 
                    -0.4921265424809078, 
                    -0.5105291307551223, 
                    0.07566853493714931, 
                    -0.14570213866295534, 
                    0.1849435114783543, 
                    -0.22302706127142602, 
                    -0.1797882546033211, 
                    -0.18970640898713342, 
                    -0.26395897273573404, 
                    -0.6292801260590145, 
                    0.1339673730978147, 
                    0.2679476365203858, 
                    -0.5697794495152838, 
                    -0.3302959561121541, 
                    -0.1665673805277912, 
                    -0.22753486534741985, 
                    -0.5586634955610842, 
                    0.7420217166204583, 
                    0.49230473093015004, 
                    -0.5977782326591827, 
                    0.3756603090077566, 
                    0.5587770410299664, 
                    -0.10157527203624173, 
                    -0.26153710177772427, 
                    -0.3075146622284169, 
                    0.2672266716124656, 
                    0.46825427935211583, 
                    -0.26992190841382185, 
                    -0.36247703385654245, 
                    0.14336988291749497, 
                    -0.40077872328947456, 
                    0.3577996213929452, 
                    -0.1544609185194769, 
                    0.41363645851407727, 
                    -0.002345258401173944, 
                    -0.5372996262768279, 
                    0.3894150357957731, 
                    -0.5870575499509639, 
                    -0.3945337982633579, 
                    -0.09781662829013116, 
                    0.37064474808394654, 
                    -0.03789608437806513 
)
)

