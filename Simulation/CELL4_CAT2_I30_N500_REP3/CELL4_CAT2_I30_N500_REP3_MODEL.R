model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.141236, 1);
tau[2,2] ~ dlnorm(-0.204276, 1);
tau[3,2] ~ dlnorm(-0.112381, 1);
tau[4,2] ~ dlnorm(-0.300639, 1);
tau[5,2] ~ dlnorm(-0.102857, 1);
tau[6,2] ~ dlnorm(-0.336439, 1);
tau[7,2] ~ dlnorm(-0.460779, 1);
tau[8,2] ~ dlnorm(-0.405231, 1);
tau[9,2] ~ dlnorm(-0.164695, 1);
tau[10,2] ~ dlnorm(-0.167358, 1);
tau[11,2] ~ dlnorm(-0.136362, 1);
tau[12,2] ~ dlnorm(-0.174464, 1);
tau[13,2] ~ dlnorm(-0.592999, 1);
tau[14,2] ~ dlnorm(-0.563599, 1);
tau[15,2] ~ dlnorm(-0.516814, 1);
tau[16,2] ~ dlnorm(-0.590958, 1);
tau[17,2] ~ dlnorm(-0.537187, 1);
tau[18,2] ~ dlnorm(-0.543711, 1);
tau[19,2] ~ dlnorm(-0.29204, 1);
tau[20,2] ~ dlnorm(-0.275334, 1);
tau[21,2] ~ dlnorm(-0.215632, 1);
tau[22,2] ~ dlnorm(-0.300899, 1);
tau[23,2] ~ dlnorm(-0.251737, 1);
tau[24,2] ~ dlnorm(-0.379577, 1);
tau[25,2] ~ dlnorm(-0.258519, 1);
tau[26,2] ~ dlnorm(-0.140548, 1);
tau[27,2] ~ dlnorm(-0.195346, 1);
tau[28,2] ~ dlnorm(-0.235126, 1);
tau[29,2] ~ dlnorm(-0.217143, 1);
tau[30,2] ~ dlnorm(-0.224185, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.3709548980294843, 
                    1.1761664260366804, 
                    1.4642943158809487, 
                    0.9011641367913406, 
                    1.4956985129114644, 
                    0.8055618023990456, 
                    0.49888753862253693, 
                    0.6311906467754094, 
                    1.2970313038008319, 
                    1.288749262723469, 
                    1.3865328847422378, 
                    1.2667529237190263, 
                    0.21201381747230125, 
                    0.2725638003730035, 
                    -0.3726656194715775, 
                    0.21615975351039052, 
                    0.32849959742675466, 
                    0.3145436604327913, 
                    -0.924642186921115, 
                    -0.9708343372022428, 
                    -1.1423650921365789, 
                    -0.900457280545933, 
                    -1.0374101066452515, 
                    -0.6948184024762165, 
                    -1.0181130736043973, 
                    -1.3731482161246487, 
                    -1.2030193239757756, 
                    -1.0852257830364922, 
                    -1.1378963425771926, 
                    -1.1171595349992198 ),
tau=matrix(c( NA,1.4315587492152386, 
                    NA,1.3440987252904697, 
                    NA,1.473468147830546, 
                    NA,1.220622697419312, 
                    NA,1.4875686322972475, 
                    NA,1.1776972492771716, 
                    NA,1.040000504841519, 
                    NA,1.099404600402159, 
                    NA,1.3983670554065735, 
                    NA,1.3946484189628376, 
                    NA,1.438553265249265, 
                    NA,1.384772062749843, 
                    NA,0.9111942040450633, 
                    NA,0.9383811463674787, 
                    NA,0.9833268631427383, 
                    NA,0.9130557293261654, 
                    NA,0.9634963192446129, 
                    NA,0.9572301035343234, 
                    NA,1.2311643419275806, 
                    NA,1.251904617403807, 
                    NA,1.328921926369324, 
                    NA,1.220305318965124, 
                    NA,1.2817971378837179, 
                    NA,1.1279734627118212, 
                    NA,1.2731327700483743, 
                    NA,1.4325435490399672, 
                    NA,1.3561556764651232, 
                    NA,1.3032663765833852, 
                    NA,1.3269154578171596, 
                    NA,1.3176046312146497 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 0.2651370140725619, 
                    -0.21735068511869055, 
                    -0.07481546213563803, 
                    0.09536248753679172, 
                    -0.17906191840111435, 
                    0.01029136832012334, 
                    -0.17692975355076246, 
                    0.007929794853567929, 
                    0.13207865564935334, 
                    -0.16718676073859245, 
                    -0.15412287584496098, 
                    -0.20823735537302734, 
                    -0.11306931453282063, 
                    0.08136286989283953, 
                    0.09668078574637001, 
                    -0.20677774400866283, 
                    -0.06660432359779125, 
                    0.1462058666654023, 
                    -0.124688756382414, 
                    4.980865785106925e-4, 
                    -0.17776967237863933, 
                    -0.10814042889949049, 
                    0.08108552852116241, 
                    0.06504806199524116, 
                    -0.12518688144685636, 
                    0.02280942967763272, 
                    0.09341149287773409, 
                    0.00685346234562817, 
                    0.02443199335492391, 
                    0.11697492395679743, 
                    0.29886061417037263, 
                    0.0326133383315228, 
                    0.028152680245487283, 
                    -0.10715182953204727, 
                    0.3425075113833808, 
                    0.2717906210356095, 
                    0.04386061775610617, 
                    0.31096966012805943, 
                    -0.15890163892170772, 
                    0.08615914747053277, 
                    0.28583610446097957, 
                    -0.22276265350395633, 
                    -0.022787067969197883, 
                    -0.1314853991490716, 
                    -0.09011681804947905, 
                    -0.20835051025988766, 
                    0.2601281978090519, 
                    -0.20674001199768036, 
                    0.14730509871159292, 
                    -0.07000954136790366, 
                    0.00524112049875336, 
                    -0.12339834450000811, 
                    0.0537489167770413, 
                    0.28831034667537375, 
                    0.260849933514608, 
                    0.1806204057402203, 
                    -0.18558705192648833, 
                    -0.11970614397161805, 
                    0.1400955713729709, 
                    0.14553217438337718, 
                    0.3517853861145051, 
                    -0.1598557629423555, 
                    0.23381533971232182, 
                    -0.24318740273542763, 
                    -0.18742621281253635, 
                    0.3094702089488757, 
                    -2.8990962767427852e-5, 
                    -0.05987777867159197, 
                    0.10704881105782094, 
                    0.07014591338354875, 
                    0.09339034594214418, 
                    0.31804388312757753, 
                    -0.09547032382257703, 
                    0.14537577127460244, 
                    -0.22928542137090513, 
                    -0.12459318771976216, 
                    -0.10912675204469285, 
                    0.31213941903500503, 
                    -0.1307693718609879, 
                    0.025687654263553628, 
                    -0.019787480939847585, 
                    0.08626782089378515, 
                    -0.2564824492508272, 
                    0.027740584293034443, 
                    -0.1606379160750341, 
                    0.2815242553899096, 
                    -0.15564176774240396, 
                    -0.15481113200338792, 
                    -0.19619982077607823, 
                    0.13977729931830324, 
                    -8.463360325323133e-4, 
                    -0.10377771917852865, 
                    0.30342139836469356, 
                    0.047011433667786706, 
                    -0.005325512336928295, 
                    0.3244123111980263, 
                    0.1674507980829817, 
                    0.014684311005470796, 
                    -0.055315139639607325, 
                    0.12636151268538764, 
                    -0.14952195545877928, 
                    -0.15839894750912678, 
                    0.23493045027155018, 
                    -0.2537161832931903, 
                    0.16562450932985956, 
                    -0.10431770609804977, 
                    0.057638334337262065, 
                    -0.18370810179080188, 
                    -0.21690321988807573, 
                    -0.17213687433832442, 
                    0.05055761233902578, 
                    -0.2331369546869438, 
                    -0.054822895388958376, 
                    -0.027159794106374174, 
                    -0.1575503271006497, 
                    -0.2564824492508272, 
                    -0.0886241036116466, 
                    0.07576420966557373, 
                    -0.02627526457240989, 
                    0.001164767311440995, 
                    -0.2198226183992938, 
                    0.010232933108385633, 
                    -0.05970798972023941, 
                    0.26819679894454235, 
                    0.02024125268564614, 
                    -0.16033316658996, 
                    -0.07649701305716847, 
                    0.3240049766979208, 
                    -0.20572804893965613, 
                    0.26337236569879047, 
                    -0.08546639922106095, 
                    -0.18098597772001174, 
                    -0.197316410194733, 
                    -0.15306390412427867, 
                    -0.1885918374175573, 
                    0.1200078400149473, 
                    0.13891133400574662, 
                    -0.21672567608755366, 
                    -0.18875048236611236, 
                    0.1682839023489519, 
                    -0.2564824492508272, 
                    0.17309734170312285, 
                    -0.05361213176257465, 
                    0.267594360501528, 
                    0.21369600808856898, 
                    0.30376772018825665, 
                    -0.1801848800907921, 
                    0.1577204852361601, 
                    -0.1661964979627819, 
                    0.02040885492199268, 
                    -0.17074115806338208, 
                    0.1659677910915749, 
                    0.0653824275662328, 
                    0.07065790426606289, 
                    -0.05018072882127225, 
                    -0.07567796740578209, 
                    0.24823922531760217, 
                    -0.13321185239268193, 
                    -0.1278839600985093, 
                    -0.19376179355143128, 
                    -0.19714397791565033, 
                    0.23011729830248684, 
                    -0.1897471717211202, 
                    0.24542656131764756, 
                    -0.034619344206448355, 
                    0.2846862867831798, 
                    0.1982084797014093, 
                    -0.18112564903271489, 
                    -0.15530049558142905, 
                    0.30515371927705953, 
                    -0.1907489562702529, 
                    0.0011685170372718323, 
                    -0.0686319527801158, 
                    0.021764497379772874, 
                    0.14844757843070988, 
                    -0.029623514426720343, 
                    -0.1969563628475178, 
                    -0.10923790391665153, 
                    0.3082678241779308, 
                    -0.24318740273542763, 
                    -0.1560468459401369, 
                    -0.13399305324012684, 
                    -0.17632249085194165, 
                    0.14477103125362156, 
                    0.016069293348617952, 
                    0.11003204077617013, 
                    0.19892600957548562, 
                    -0.1186265770732512, 
                    0.053327625248389576, 
                    -0.20413377567434, 
                    -0.12320054649144008, 
                    0.2565609780507196, 
                    -0.13875842999203325, 
                    -0.16945286055485653, 
                    -0.14283244548663152, 
                    -0.14996950531151373, 
                    0.19043162905473882, 
                    -0.2023374371172081, 
                    0.309276011192165, 
                    0.23254988996783932, 
                    0.295751532523669, 
                    -0.15386527475136985, 
                    -0.19619982077607823, 
                    -0.13202498185565137, 
                    0.20940936896268147, 
                    0.02981006673651493, 
                    -0.09321887803196258, 
                    -0.1571977402882912, 
                    -0.15848249464546077, 
                    -0.17549761177352952, 
                    0.33522673179814105, 
                    -0.1625679089375815, 
                    -0.04933442338125679, 
                    0.2075009185032644, 
                    -0.18015204701113033, 
                    0.14869761859268077, 
                    -0.19482822265995375, 
                    0.3157698313093292, 
                    -0.04937301258475574, 
                    -0.0505656748360746, 
                    -0.2394740709662697, 
                    -0.1334401239097776, 
                    -0.03700821323344869, 
                    -0.010296365992862072, 
                    -0.010198206437988161, 
                    -0.19612423963017828, 
                    0.04942685099199645, 
                    -0.2359901376853893, 
                    -0.2041558935918317, 
                    0.11783482782872257, 
                    0.17106569172691288, 
                    0.03804685235196459, 
                    0.05258778661310487, 
                    -0.10737512750303119, 
                    0.07086941379508105, 
                    -0.039408288633783956, 
                    0.07538248145923843, 
                    -0.19357232343337927, 
                    0.0788913653253433, 
                    -0.0137267643592974, 
                    0.12305729340553934, 
                    0.30527435842125333, 
                    0.08728220156835503, 
                    -0.17074115806338208, 
                    3.409955995647973e-4, 
                    0.2572630827146835, 
                    -0.10034570475139959, 
                    -0.07875847539897979, 
                    0.22721792773069976, 
                    -0.24583480682530157, 
                    -0.034575148098467484, 
                    -0.24295759258140914, 
                    0.013368953950338769, 
                    -0.11766970005775354, 
                    0.17326490948177553, 
                    -0.1382017614519947, 
                    0.20016681451646773, 
                    0.22231353578754176, 
                    -0.23630806070477636, 
                    -0.1895738719606152, 
                    0.11845546506228893, 
                    0.12944360779598474, 
                    -0.10398855707311386, 
                    -0.15259503223458043, 
                    0.22162431508146485, 
                    0.031299941676503074, 
                    0.358450772128363, 
                    0.22455245853913158, 
                    0.1953260500462916, 
                    0.3096238028494798, 
                    -0.13611856261055522, 
                    -0.17908918913996508, 
                    0.026576395661527752, 
                    0.13739528295709502, 
                    -0.14605212009527466, 
                    0.31639094279611485, 
                    0.19370621250925718, 
                    0.15539255353412634, 
                    0.07034494921621903, 
                    0.02693513720592433, 
                    -0.10708158303371934, 
                    0.11653129074877067, 
                    0.15750423382847062, 
                    0.24567999336944296, 
                    0.0507634785457714, 
                    -0.005032406369138043, 
                    -0.052634415030809845, 
                    -0.09851768439099465, 
                    0.3344131343755517, 
                    0.28536956014736764, 
                    -0.23931494952643256, 
                    0.17238339671386527, 
                    -0.17372975272876467, 
                    0.11092651634955497, 
                    0.09369863256482852, 
                    -0.23931494952643256, 
                    0.3561745260714036, 
                    0.06635778140822479, 
                    -0.1882432473690057, 
                    0.1255978395564316, 
                    -0.2069775043431943, 
                    0.2393853970755213, 
                    -0.2038368408446812, 
                    0.15272872018126304, 
                    -0.17785851932543822, 
                    -0.05555104318963522, 
                    0.25596817310084335, 
                    -0.1411268346322228, 
                    0.28464263625965897, 
                    0.24971135560812047, 
                    -0.18514890864517702, 
                    0.1712718810155155, 
                    -0.1913788936022498, 
                    -0.06124285466295595, 
                    -0.16133219500083257, 
                    -0.21327059152618194, 
                    -0.18285285645553723, 
                    0.2104283053921121, 
                    0.3022680664097302, 
                    -0.16427679486395316, 
                    -0.23735213442421646, 
                    -0.20537635140557742, 
                    -0.17900094401393418, 
                    0.2563566975762041, 
                    -0.11992914872550495, 
                    0.2013922962065805, 
                    -0.12847869268571246, 
                    -0.2564824492508272, 
                    -0.1579465577444864, 
                    0.1729305739829578, 
                    -0.07166657254278974, 
                    -0.21241340055161892, 
                    -0.14635037431005274, 
                    0.02764332403538433, 
                    0.36666114867660987, 
                    0.09934692134069195, 
                    -0.09243449720486452, 
                    -0.18169817804476263, 
                    -0.020750862523775643, 
                    0.07740120055960947, 
                    -0.15504267146093859, 
                    0.04997961286486735, 
                    -0.18751901686844977, 
                    -0.1770498184380016, 
                    0.06585673575374607, 
                    0.2284056979077429, 
                    -0.18832216918786848, 
                    -0.21997038071972497, 
                    0.25605201698536867, 
                    -0.2279020567398345, 
                    0.28180053706478964, 
                    -0.04746732149827823, 
                    -0.07711813014618507, 
                    -0.13884811011458875, 
                    -0.10993302713741313, 
                    -0.151613618017634, 
                    0.014417187534577158, 
                    0.3346195190494194, 
                    -0.1930285382824553, 
                    -0.11336889120037358, 
                    0.20182838652775403, 
                    -0.17620038877100846, 
                    -0.09989565691668459, 
                    -0.17292494881395615, 
                    -0.03138966882012298, 
                    0.17282823320594526, 
                    -0.10606921583360185, 
                    -0.15973418087760086, 
                    -0.15513485475988176, 
                    0.16753834959028807, 
                    0.017820104120790492, 
                    -0.03807525960517982, 
                    0.3306366806139494, 
                    -0.1979296002162622, 
                    -0.012789002501379404, 
                    0.10123973166772732, 
                    -0.05962450241129058, 
                    0.12192746070077187, 
                    0.09803097553030649, 
                    0.31183533643867883, 
                    -0.15179034628924826, 
                    0.12916729072273497, 
                    0.24550892845119937, 
                    -0.07681317745221322, 
                    0.03041519618221633, 
                    -0.10706799709251053, 
                    -0.04436067044962444, 
                    -0.203063065997883, 
                    0.09802506809896594, 
                    -0.0603111662344773, 
                    -0.2001469804176992, 
                    0.17245496329794813, 
                    0.12684734729894148, 
                    -0.21735068511869055, 
                    0.06644211741145678, 
                    -0.24583480682530157, 
                    -0.11305857763399282, 
                    -0.19211895619500957, 
                    0.058501584157854336, 
                    -0.10608241530834431, 
                    0.16223840997005262, 
                    0.3215700039110752, 
                    -0.1976342467604263, 
                    -0.06246315535075636, 
                    -0.2564824492508272, 
                    -0.05449035413904957, 
                    -0.17694950827814665, 
                    -0.06758373377436033, 
                    -0.21523887201648179, 
                    0.005430287633148179, 
                    -0.18193930870997144, 
                    0.09962034680707021, 
                    -0.012825590588830288, 
                    -0.16245819091811714, 
                    0.21763993355794414, 
                    -0.09890879579048845, 
                    -0.15214351865572256, 
                    -0.1576672277647292, 
                    0.030269112316842206, 
                    -0.19902144215852083, 
                    -0.1606343786487246, 
                    -0.04889354477386437, 
                    0.1127184012529992, 
                    0.14744791776179345, 
                    0.1708190306496235, 
                    0.18324999571243816, 
                    0.14777959552881553, 
                    0.0236310379130219, 
                    -0.19779118268247947, 
                    -0.204106076274836, 
                    -0.18221587356062868, 
                    0.29435331311397445, 
                    -0.0039223157047590385, 
                    0.21966971164906351, 
                    -0.1991952859022922, 
                    -0.23172626488857367, 
                    0.1944751193398268, 
                    -0.17349694707230068, 
                    0.12037766769441205, 
                    0.3326037686383732, 
                    0.06650610684955915, 
                    0.04637666573600535, 
                    0.21370674376742516, 
                    -0.19692816754315062, 
                    0.29097229154952314, 
                    -0.13978781933340045, 
                    -0.1363005231425463, 
                    0.2705971627301374, 
                    -0.2076333786446225, 
                    -0.044906203256090405, 
                    -0.22641296298022787, 
                    0.17571379548027183, 
                    0.1775056287887954, 
                    -0.005761673010594159, 
                    -0.14067424208672208, 
                    0.32390229374672236, 
                    0.19316655529253607, 
                    0.16804194266004435, 
                    -0.2300846252381322, 
                    0.06550883689653458, 
                    0.29941447184812736, 
                    -0.0819609370930198, 
                    -0.23422270586449284, 
                    -0.2196182159113632, 
                    0.2632576460575447, 
                    0.13406206026668338, 
                    -0.06347435538158924, 
                    0.11689806817414844, 
                    -0.10854155555753595, 
                    -0.20149986300861555, 
                    -0.059992176977223644, 
                    -0.13202793472756957, 
                    -0.21713766792967149, 
                    0.25854073091959223, 
                    0.20860795473082583, 
                    -0.19775386518336618, 
                    -0.10137857586254215, 
                    -0.1644285933712001, 
                    0.2686919568549319, 
                    -0.015005549060628565, 
                    -0.06514715549553676, 
                    -0.20209657279149273, 
                    0.07469636924289236, 
                    -0.14784952820489586, 
                    -0.16063105767804514, 
                    -0.017982159547288684, 
                    -0.010473837166275007, 
                    0.3420009214962448, 
                    0.18322400845403553, 
                    -0.039783834280136654, 
                    0.31190637948979355, 
                    0.20880699273276337, 
                    -0.01937990810320342, 
                    -0.12804051457144988, 
                    -0.18899911265362737, 
                    0.0962663508412358, 
                    -0.2019124036969405, 
                    -0.0025929062079596554, 
                    0.027367464052927448, 
                    -0.24574058100625407 
)
)

