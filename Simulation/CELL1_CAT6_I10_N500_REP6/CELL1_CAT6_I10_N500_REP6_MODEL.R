model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.025559, 1);
tau[1,3] ~ dlnorm(-0.155606, 1);
tau[1,4] ~ dlnorm(-0.305131, 1);
tau[1,5] ~ dlnorm(-0.481011, 1);
tau[1,6] ~ dlnorm(-0.69457, 1);
tau[2,2] ~ dlnorm(0.229613, 1);
tau[2,3] ~ dlnorm(0.108954, 1);
tau[2,4] ~ dlnorm(-0.028287, 1);
tau[2,5] ~ dlnorm(-0.187405, 1);
tau[2,6] ~ dlnorm(-0.376722, 1);
tau[3,2] ~ dlnorm(0.117579, 1);
tau[3,3] ~ dlnorm(-0.006899, 1);
tau[3,4] ~ dlnorm(-0.149103, 1);
tau[3,5] ~ dlnorm(-0.314936, 1);
tau[3,6] ~ dlnorm(-0.513846, 1);
tau[4,2] ~ dlnorm(0.153921, 1);
tau[4,3] ~ dlnorm(0.030732, 1);
tau[4,4] ~ dlnorm(-0.109794, 1);
tau[4,5] ~ dlnorm(-0.273348, 1);
tau[4,6] ~ dlnorm(-0.468984, 1);
tau[5,2] ~ dlnorm(-0.163168, 1);
tau[5,3] ~ dlnorm(-0.299414, 1);
tau[5,4] ~ dlnorm(-0.457195, 1);
tau[5,5] ~ dlnorm(-0.644622, 1);
tau[5,6] ~ dlnorm(-0.875474, 1);
tau[6,2] ~ dlnorm(-0.280273, 1);
tau[6,3] ~ dlnorm(-0.422546, 1);
tau[6,4] ~ dlnorm(-0.588472, 1);
tau[6,5] ~ dlnorm(-0.787515, 1);
tau[6,6] ~ dlnorm(-1.036278, 1);
tau[7,2] ~ dlnorm(-0.002479, 1);
tau[7,3] ~ dlnorm(-0.131571, 1);
tau[7,4] ~ dlnorm(-0.279834, 1);
tau[7,5] ~ dlnorm(-0.45397, 1);
tau[7,6] ~ dlnorm(-0.664959, 1);
tau[8,2] ~ dlnorm(-0.006357, 1);
tau[8,3] ~ dlnorm(-0.135608, 1);
tau[8,4] ~ dlnorm(-0.284081, 1);
tau[8,5] ~ dlnorm(-0.458506, 1);
tau[8,6] ~ dlnorm(-0.669922, 1);
tau[9,2] ~ dlnorm(-0.006968, 1);
tau[9,3] ~ dlnorm(-0.136244, 1);
tau[9,4] ~ dlnorm(-0.28475, 1);
tau[9,5] ~ dlnorm(-0.459221, 1);
tau[9,6] ~ dlnorm(-0.670703, 1);
tau[10,2] ~ dlnorm(0.185682, 1);
tau[10,3] ~ dlnorm(0.063579, 1);
tau[10,4] ~ dlnorm(-0.075535, 1);
tau[10,5] ~ dlnorm(-0.237178, 1);
tau[10,6] ~ dlnorm(-0.430083, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 0.844517080888641, 
                    1.5305095435450538, 
                    1.2076832774822885, 
                    1.3084684819165209, 
                    0.5411222074933361, 
                    0.3138561423036882, 
                    -0.8996176010541865, 
                    -0.8902694666964162, 
                    -0.8888009112227745, 
                    -1.3995970913406963 ),
tau=matrix(c( NA,1.6071161320851646,1.4111341413936234,1.2151521507020822,1.019170160010541,0.8231881693189997, 
                    NA,2.074276999154182,1.8385074456285688,1.6027378921029556,1.3669683385773423,1.131198785051729, 
                    NA,1.8544323119654382,1.6373866818714655,1.4203410517774928,1.20329542168352,0.9862497915895474, 
                    NA,1.9230670361851507,1.7001758642339926,1.4772846922828342,1.2543935203316758,1.0315023483805177, 
                    NA,1.4005042233029619,1.2221191352683483,1.0437340472337349,0.8653489591991214,0.6869638711645079, 
                    NA,1.2457360329088114,1.0805323766551975,0.9153287204015836,0.7501250641479698,0.5849214078943559, 
                    NA,1.6446395863179013,1.4454617654567583,1.2462839445956155,1.0471061237344728,0.8479283028733298, 
                    NA,1.6382735068202594,1.4396378777518672,1.241002248683475,1.042366619615083,0.8437309905466908, 
                    NA,1.6372734205427097,1.4387229676917888,1.2401725148408678,1.0416220619899468,0.8430716091390258, 
                    NA,1.9851256192030144,1.756948987905254,1.5287723566074936,1.300595725309733,1.0724190940119727 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.40426065745379436, 
                    -0.5304608813524778, 
                    0.30058893293505395, 
                    0.2787917123841528, 
                    -0.11011056838276256, 
                    -0.6241184562751637, 
                    -0.23714211024325338, 
                    0.2344567115221613, 
                    -0.35092922525854875, 
                    0.4941382016682804, 
                    0.10715747562209921, 
                    -0.5938612111597169, 
                    0.49149945711512444, 
                    -0.11701850133488478, 
                    -0.12233354241584382, 
                    -0.396200946948011, 
                    -0.28634830912528575, 
                    -0.18506412649117343, 
                    -0.4968303753283825, 
                    0.08307322472092515, 
                    -0.24985223595629447, 
                    0.05757599056432938, 
                    0.5334537483534497, 
                    0.2218022343013445, 
                    0.7003478093255903, 
                    -0.41034660263113476, 
                    0.05596103052099688, 
                    -0.49798866653896823, 
                    0.2703171332010784, 
                    -0.5019797533364388, 
                    -0.4039803254141238, 
                    -0.12332727089755624, 
                    -0.2602439695824037, 
                    0.026681568496672026, 
                    -0.28339694140792937, 
                    -0.3850969030734546, 
                    0.014010257856818309, 
                    -0.4193242951474122, 
                    -0.20109069490150427, 
                    0.15771679076923628, 
                    0.5562042636969925, 
                    -0.19194576708782024, 
                    -0.14684348556247695, 
                    -0.14093381786882875, 
                    -0.021215979476286284, 
                    0.4973237343889373, 
                    -0.29728144362316794, 
                    0.42286825957684904, 
                    -0.49493456943490055, 
                    -0.13414873809263922, 
                    0.337869429774755, 
                    -0.5973778136866971, 
                    -0.3750553717948929, 
                    -0.19077477829493705, 
                    -0.4118371013451228, 
                    0.01359306020454587, 
                    0.4402074199591476, 
                    0.1060456278415125, 
                    0.13658424537197178, 
                    -0.06118294733308649, 
                    -0.2586712654980954, 
                    -0.23548199162218414, 
                    -0.273484276245846, 
                    0.7241338897301534, 
                    -0.4779845799352586, 
                    0.5300910339221271, 
                    -0.43215747083017264, 
                    0.14805570717988437, 
                    -0.14325939403161453, 
                    -0.10391329013173967, 
                    -0.262636952401764, 
                    0.20456594397315442, 
                    -0.6241184562751637, 
                    -0.062081408543323446, 
                    -0.3563600440797579, 
                    -0.069425192092192, 
                    0.15339327037775785, 
                    -0.04007364394449864, 
                    0.31639722196878495, 
                    -0.27903273214097163, 
                    0.07809126186746496, 
                    -0.409019758179214, 
                    -0.32043494937960226, 
                    0.0591010644723966, 
                    0.014509270452356504, 
                    -0.3662241745124197, 
                    0.736348074527282, 
                    0.204807148527422, 
                    -0.31746511944911315, 
                    0.4106433011645677, 
                    -0.42883206429935683, 
                    -0.10051346582544607, 
                    -0.23991193384951875, 
                    -0.34203062167308496, 
                    0.16288184363060232, 
                    -0.01666258991437697, 
                    -0.5388480382225408, 
                    0.6446325308357334, 
                    -0.4041339020077114, 
                    -0.1829251777977498, 
                    0.00887464167795493, 
                    -0.14137787519470468, 
                    -0.5546143272487051, 
                    -0.21620061170804733, 
                    0.13988441724032608, 
                    0.04318779159313957, 
                    -0.5165523320408456, 
                    0.6084480787550762, 
                    0.13718668755064323, 
                    0.338472135676266, 
                    -0.4732625454631598, 
                    -0.2199548874904385, 
                    -0.41474120094954936, 
                    -0.35069171986308245, 
                    -0.08440450433588187, 
                    0.2616088706718488, 
                    0.8270484265023842, 
                    -0.5617769421399481, 
                    -0.1459145130981342, 
                    -0.5117091002555345, 
                    -0.509630847915323, 
                    0.11233347747201516, 
                    0.3775171426750762, 
                    0.6440073716016507, 
                    0.14525752230133526, 
                    -0.35908598334709574, 
                    0.2345263643666925, 
                    -0.5662922380223285, 
                    0.12917250598103203, 
                    0.4702196695495723, 
                    0.5147671329740845, 
                    -0.5108914707444131, 
                    -0.2639491064274405, 
                    0.8560992149883145, 
                    -0.11826320438715232, 
                    -0.262636952401764, 
                    -0.576743116366654, 
                    0.21594056047099952, 
                    -0.4032080618103083, 
                    -0.10336315802977347, 
                    -0.3607702435009926, 
                    0.47336991299058073, 
                    0.44673289363363555, 
                    0.6244836254416025, 
                    0.6692638609364022, 
                    -0.6146184857655422, 
                    -0.02818567205936129, 
                    -0.39804143552513016, 
                    -0.32795080846867236, 
                    -0.32115190569987195, 
                    -0.107461716324045, 
                    0.7072130127333546, 
                    -0.3188624046736334, 
                    0.1591964182805481, 
                    -0.4276782731924532, 
                    0.27545724947312766, 
                    0.20311575424882056, 
                    -0.14212467377743204, 
                    -0.531257362810232, 
                    0.6005039105000508, 
                    -0.5938612111597169, 
                    -0.17222635039501155, 
                    0.1811692274311245, 
                    0.21500506955923848, 
                    -0.2964580770427581, 
                    0.70065282240538, 
                    0.19370617413157798, 
                    0.3375053555036446, 
                    0.18910090345949604, 
                    -0.23829732663805447, 
                    -0.17874811548785413, 
                    -0.3231204144759933, 
                    -0.4602611834734016, 
                    0.10089367008670214, 
                    0.060309894368580474, 
                    -0.4361666714841439, 
                    0.6927599529275351, 
                    -0.23529872246104938, 
                    -0.023271417493225477, 
                    0.7003478093255903, 
                    0.5886140996855612, 
                    0.01634877554834724, 
                    -0.06348623020183575, 
                    -0.1639781947657346, 
                    -0.36169363565716134, 
                    0.641452608669108, 
                    -0.5973778136866971, 
                    0.39213878155333204, 
                    -0.295604697628022, 
                    0.7634741009212113, 
                    -0.39674201174193424, 
                    0.02343557136750518, 
                    0.004410395669018019, 
                    0.10161072430003826, 
                    0.47070750810752904, 
                    -0.42488891719321153, 
                    0.5755438093211872, 
                    -0.39408644837522266, 
                    -0.33931342094625366, 
                    0.08625137026446983, 
                    -0.054595052832060675, 
                    -0.11965805312759847, 
                    -0.04379418261440249, 
                    0.008107980968270478, 
                    0.38663349261890356, 
                    0.28726784510583914, 
                    -0.5065042571836776, 
                    -0.4956817329569786, 
                    0.04608820484243448, 
                    -0.4796010984544043, 
                    0.3899622438537199, 
                    0.09638004565874347, 
                    -0.15235331525512774, 
                    0.53530169779791, 
                    -0.4114329403579833, 
                    0.6736330532647538, 
                    -0.3778247311830726, 
                    -0.4819868711695081, 
                    -0.5869173975077785, 
                    0.3330451153869598, 
                    0.11140157368541714, 
                    -0.417390049960747, 
                    0.6269932486535424, 
                    0.47148632292535553, 
                    0.05662158055533595, 
                    0.264337657723, 
                    0.6109932502064476, 
                    0.5352885130383559, 
                    -0.29211664988515873, 
                    0.16454394583889187, 
                    0.1698242228134943, 
                    -0.2931216012278731, 
                    -0.03526703323071745, 
                    0.2625464415079577, 
                    0.5668881066787118, 
                    0.4704840725468097, 
                    0.2452326561523689, 
                    -0.5199945663684441, 
                    -0.17045051241713333, 
                    -0.05447927161584287, 
                    0.2270931840049012, 
                    -0.0031544464993449317, 
                    0.45127575087455785, 
                    -0.3064548583778982, 
                    0.279799635892673, 
                    0.7630964943317821, 
                    0.24176946627775475, 
                    0.7188747119153039, 
                    -0.020404629083169756, 
                    -0.5375629458896543, 
                    0.08712146608904159, 
                    -0.014248257880069448, 
                    0.05721476141205761, 
                    -0.5865300477665025, 
                    -0.20793263569468468, 
                    0.18336184404773648, 
                    0.4695121376222048, 
                    0.4082232482683764, 
                    -0.01643353217678445, 
                    0.026357012465491048, 
                    0.06631923184785848, 
                    0.057003538792396835, 
                    -0.3925874349642073, 
                    0.7022038696714076, 
                    0.15983725334997856, 
                    0.46503013624184, 
                    -0.47315151204000505, 
                    -0.004726608311409142, 
                    -0.3494204759732554, 
                    -0.3577118366943688, 
                    0.6446500495855482, 
                    -0.18591084390646362, 
                    0.1503617987673722, 
                    -0.5489118895332057, 
                    0.02348515004423879, 
                    0.44128886821851354, 
                    -0.2155984410683502, 
                    0.4197060513388874, 
                    -0.3922884186368027, 
                    -0.5973778136866971, 
                    -0.5489118895332057, 
                    -0.5938612111597169, 
                    -0.34373208464753846, 
                    -0.16864195978516155, 
                    0.2713756349630646, 
                    -0.21670341042492586, 
                    -0.294002008089611, 
                    -0.36551593963924833, 
                    -0.23042032757698294, 
                    -0.11955791380276537, 
                    0.4265940072858473, 
                    -0.5338496038332565, 
                    -0.4276782731924532, 
                    -0.5066058173297541, 
                    0.6255423512816974, 
                    0.1494156463184232, 
                    0.038622446321686765, 
                    -0.37727293233676623, 
                    0.003742254433461656, 
                    0.21362061768348828, 
                    -0.38176178748769074, 
                    0.2958842420868991, 
                    0.03527225213941665, 
                    0.3632728656936489, 
                    -0.40181502456676477, 
                    -0.5489118895332057, 
                    0.3660815474363929, 
                    -0.22679922775071437, 
                    -0.576743116366654, 
                    -0.38061709084461676, 
                    0.5076095136046846, 
                    0.5679109257072735, 
                    -0.1564550371960559, 
                    -0.4515319716803605, 
                    -0.19731639686379565, 
                    -0.12759669697827603, 
                    0.7238449006336346, 
                    0.4603115592626884, 
                    -0.13966091620524484, 
                    -0.3467815171298165, 
                    0.5361983155100744, 
                    -0.2800519408780716, 
                    -0.40825079926548774, 
                    -0.30028767854891586, 
                    -0.4070150144574578, 
                    -0.509630847915323, 
                    -0.3126877503486136, 
                    -0.39970703905222993, 
                    0.06762513032223316, 
                    -0.2642131546754328, 
                    -0.1266373911313387, 
                    -0.34992973117591797, 
                    -0.14763541289881893, 
                    -0.4143133795374774, 
                    -0.5018214198951929, 
                    0.8431289936813989, 
                    0.28214848021447514, 
                    0.05794650318283545, 
                    0.03782979548493204, 
                    0.5700258156177761, 
                    -0.5135803259418956, 
                    -0.3921815381325973, 
                    -0.3559608922351191, 
                    -0.04718111961931104, 
                    0.377410444600493, 
                    0.4410595266151741, 
                    -0.6051601182262757, 
                    -0.5938612111597169, 
                    -0.6241184562751637, 
                    0.729850336053189, 
                    -0.08364196226077147, 
                    0.697798365689635, 
                    -0.06527612283117878, 
                    -0.42600453727163234, 
                    0.5461974879699499, 
                    -0.27216689488913226, 
                    0.48721875845415374, 
                    0.11336076598076938, 
                    -0.1917054125475035, 
                    -0.4294751206399046, 
                    -0.2311931418469187, 
                    0.33626956488431237, 
                    -0.2988946020616459, 
                    0.1678607584277232, 
                    -0.37598768292628715, 
                    0.4609809877667056, 
                    0.7280501547070107, 
                    0.018032653869774595, 
                    -0.38393320663253167, 
                    -0.47114660732494207, 
                    0.7444753588122496, 
                    -0.3341439350489158, 
                    0.015369584024699567, 
                    -0.5338496038332565, 
                    0.6803961583051467, 
                    -0.1458351961951404, 
                    0.54303474030039, 
                    0.3317180485302611, 
                    0.6557556253275251, 
                    0.2469391452116967, 
                    0.03756467037135813, 
                    0.3417676866324286, 
                    -0.42897286190105577, 
                    -0.23480593919975107, 
                    0.2135072466259973, 
                    0.6494894571115221, 
                    -0.006902043215522458, 
                    -0.2639464425766353, 
                    -0.3167441493316797, 
                    -0.23899885805888194, 
                    0.08576309919353542, 
                    0.22969624302273173, 
                    0.7541731157025083, 
                    0.835198955766094, 
                    0.07178557406002928, 
                    -0.14760884760004056, 
                    0.7572140567869766, 
                    0.29752696507981957, 
                    0.7573622277671065, 
                    -0.5119496303125984, 
                    -0.07245221249014522, 
                    0.69037348976264, 
                    -0.3892585372819163, 
                    -0.44076290286224623, 
                    0.5504821186676757, 
                    -0.35035613862815573, 
                    -0.3331615178097233, 
                    0.38030978210901345, 
                    -0.10200900118615852, 
                    -0.2278826070708686, 
                    -0.28136813833494445, 
                    0.6193216222701848, 
                    0.2918570778092566, 
                    -0.13616449012565773, 
                    0.3027022199662609, 
                    0.330996208227745, 
                    0.06657182774503445, 
                    0.20357186640116243, 
                    0.4441427145998601, 
                    -0.11401299874521575, 
                    0.39540016695428315, 
                    -0.25243045885736487, 
                    0.26303492607585854, 
                    0.6958116909641273, 
                    0.2986884277922439, 
                    -0.134773253864713, 
                    -0.24444889636270822, 
                    -0.3379054121846106, 
                    0.5041285779066377, 
                    -0.35436736415686915, 
                    0.029402154347363596, 
                    -0.4292441140639273, 
                    -0.05398499420536529, 
                    0.435697614426391, 
                    0.6939293188874388, 
                    0.1812789838503378, 
                    0.013387131298424948, 
                    -0.28980917744021273, 
                    0.12362130741075805, 
                    0.1804634729076645, 
                    -0.06896686784129757, 
                    -0.5244035749052464, 
                    -0.4116320369638916, 
                    -0.5650280777668588, 
                    0.19073244922345822, 
                    -0.008491480979458066, 
                    0.6260242390972349, 
                    -0.4662063732845346, 
                    0.36430150929325644, 
                    0.10666474812444404, 
                    0.7260183517634661, 
                    -0.5938612111597169, 
                    0.2728568820890599, 
                    -0.28013678858534624, 
                    -0.18681025471546803, 
                    0.6659397380562248, 
                    -0.33430677429404726, 
                    -0.4836287689013379, 
                    0.04143415942460915, 
                    0.24946292273160375, 
                    0.011090830709026278, 
                    -0.2907085610397652, 
                    -0.19013580501124966, 
                    0.06497418157121648, 
                    -0.4126056274460961, 
                    0.20165473046150773, 
                    -0.14155673056058327, 
                    -0.5066867692173922, 
                    0.8032765580811437, 
                    0.4337904857000562, 
                    -0.6241184562751637, 
                    -0.3161040909332992, 
                    -0.15626777596777902, 
                    0.7697284933231127, 
                    0.616575715561973, 
                    -0.5214704314103834, 
                    0.7167689777362974, 
                    -0.4993416422924346, 
                    -0.12822736005965363, 
                    -0.3374645126966678, 
                    -0.24085257248854025, 
                    -0.18850863289269226, 
                    0.36960372410921316, 
                    0.6661148415410366, 
                    -0.5670033484870176, 
                    0.5246562233327937, 
                    0.021624567283826, 
                    0.32058380591868274, 
                    0.3617249852262219, 
                    0.4923345855935729, 
                    -0.6241184562751637, 
                    0.5664769539847702, 
                    0.1663840382646451, 
                    0.19948989039522658, 
                    0.4793748611694374, 
                    -0.2668841733433499, 
                    0.39999148329509115, 
                    -0.4255000325095613, 
                    -0.014754103053253531, 
                    -0.1397631384633291 
)
)

