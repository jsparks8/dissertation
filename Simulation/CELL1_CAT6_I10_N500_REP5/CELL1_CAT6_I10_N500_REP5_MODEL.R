model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(0.245803, 1);
tau[1,3] ~ dlnorm(0.12566, 1);
tau[1,4] ~ dlnorm(-0.010913, 1);
tau[1,5] ~ dlnorm(-0.169134, 1);
tau[1,6] ~ dlnorm(-0.357181, 1);
tau[2,2] ~ dlnorm(0.235121, 1);
tau[2,3] ~ dlnorm(0.11464, 1);
tau[2,4] ~ dlnorm(-0.022373, 1);
tau[2,5] ~ dlnorm(-0.181183, 1);
tau[2,6] ~ dlnorm(-0.370066, 1);
tau[3,2] ~ dlnorm(0.072873, 1);
tau[3,3] ~ dlnorm(-0.053256, 1);
tau[3,4] ~ dlnorm(-0.197621, 1);
tau[3,5] ~ dlnorm(-0.366402, 1);
tau[3,6] ~ dlnorm(-0.569572, 1);
tau[4,2] ~ dlnorm(-0.117448, 1);
tau[4,3] ~ dlnorm(-0.251535, 1);
tau[4,4] ~ dlnorm(-0.406427, 1);
tau[4,5] ~ dlnorm(-0.589787, 1);
tau[4,6] ~ dlnorm(-0.81449, 1);
tau[5,2] ~ dlnorm(-0.446972, 1);
tau[5,3] ~ dlnorm(-0.599216, 1);
tau[5,4] ~ dlnorm(-0.778876, 1);
tau[5,5] ~ dlnorm(-0.998039, 1);
tau[5,6] ~ dlnorm(-1.279123, 1);
tau[6,2] ~ dlnorm(-0.355668, 1);
tau[6,3] ~ dlnorm(-0.502233, 1);
tau[6,4] ~ dlnorm(-0.674031, 1);
tau[6,5] ~ dlnorm(-0.881594, 1);
tau[6,6] ~ dlnorm(-1.143836, 1);
tau[7,2] ~ dlnorm(0.079463, 1);
tau[7,3] ~ dlnorm(-0.046418, 1);
tau[7,4] ~ dlnorm(-0.190457, 1);
tau[7,5] ~ dlnorm(-0.358793, 1);
tau[7,6] ~ dlnorm(-0.561318, 1);
tau[8,2] ~ dlnorm(-0.160347, 1);
tau[8,3] ~ dlnorm(-0.296457, 1);
tau[8,4] ~ dlnorm(-0.454056, 1);
tau[8,5] ~ dlnorm(-0.641225, 1);
tau[8,6] ~ dlnorm(-0.871684, 1);
tau[9,2] ~ dlnorm(0.066676, 1);
tau[9,3] ~ dlnorm(-0.059688, 1);
tau[9,4] ~ dlnorm(-0.204361, 1);
tau[9,5] ~ dlnorm(-0.373564, 1);
tau[9,6] ~ dlnorm(-0.577346, 1);
tau[10,2] ~ dlnorm(0.153921, 1);
tau[10,3] ~ dlnorm(0.030732, 1);
tau[10,4] ~ dlnorm(-0.109794, 1);
tau[10,5] ~ dlnorm(-0.273348, 1);
tau[10,6] ~ dlnorm(-0.468984, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 6 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( 1.5802242863762805, 
                    1.5473353785038493, 
                    1.0886259451139177, 
                    0.6373292282662901, 
                    0.032980190585992, 
                    0.1810098685419439, 
                    -1.105843550960297, 
                    -0.5469305127785664, 
                    -1.0725386912632615, 
                    -1.3084683172679026 ),
tau=matrix(c( NA,2.1081327390222464,1.8694797304124224,1.6308267218025982,1.392173713192774,1.1535207045829499, 
                    NA,2.085735392761121,1.848989940807898,1.6122444888546748,1.3754990369014515,1.1387535849482282, 
                    NA,1.773354268622578,1.5632139638059708,1.3530736589893635,1.1429333541727562,0.9327930493561489, 
                    NA,1.4660212044493435,1.2820561092098988,1.0980910139704538,0.914125918731009,0.7301608234915642, 
                    NA,1.0544595097890606,0.905546658735073,0.7566338076810855,0.6077209566270979,0.45880810557311036, 
                    NA,1.1552677204770638,0.9977691481016311,0.8402705757261983,0.6827720033507656,0.5252734309753329, 
                    NA,1.7850794582039624,1.5739405322482651,1.3628016062925679,1.1516626803368706,0.9405237543811733, 
                    NA,1.4044596792022037,1.2257377094610469,1.04701573971989,0.8682937699787332,0.6895718002375764, 
                    NA,1.762398848750281,1.553191604657012,1.3439843605637427,1.1347771164704734,0.9255698723772043, 
                    NA,1.9230669240594418,1.7001757616579034,1.477284599256365,1.2543934368548266,1.0315022744532882 ), ncol= 6 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.5983640598395679, 
                    0.6459913557752206, 
                    -0.5433560113720547, 
                    -0.44403970939246545, 
                    -0.25244164709559386, 
                    0.38662987169868, 
                    -0.12271730188302477, 
                    0.6563107334851008, 
                    0.2285049153820814, 
                    -0.07744071169344302, 
                    -0.018132536472827088, 
                    -0.32929951035419236, 
                    0.4360345954710667, 
                    0.23498144641229013, 
                    -0.05015719577071831, 
                    -0.3691713322383942, 
                    0.013020987111850513, 
                    -0.34625371778028186, 
                    -0.37462702928536545, 
                    0.08746063043922847, 
                    0.05725782143781477, 
                    -0.00471293952310603, 
                    -0.20504799627777398, 
                    0.035039548004926035, 
                    0.524502025035517, 
                    -0.16357308560073763, 
                    -0.0773967322108794, 
                    -0.11028422410650718, 
                    -0.4715617667144193, 
                    -0.4167780722232929, 
                    -0.511558854622495, 
                    0.5569349145726508, 
                    0.5450679156781872, 
                    -0.3888789652472965, 
                    -0.026060618858014806, 
                    -0.5203859804866781, 
                    -0.6114248925061273, 
                    -0.4420987556754013, 
                    0.3837735928127448, 
                    -0.2254245026484361, 
                    0.005291060287353377, 
                    0.6690907764996523, 
                    0.1298845770372229, 
                    -0.39991807200139384, 
                    -0.263597015184183, 
                    -0.5534323806487648, 
                    -0.3184561051491669, 
                    0.7943267316340141, 
                    -0.46192629970510957, 
                    0.17372114732656074, 
                    0.5490377026233042, 
                    0.7825112631298599, 
                    -0.32897745485220475, 
                    0.36508618519021563, 
                    -0.09489452219634487, 
                    0.720399878682308, 
                    -0.48746623371784015, 
                    -0.18661500109514373, 
                    -0.16635235549480498, 
                    -0.4392559500388067, 
                    0.7636865617676682, 
                    -0.20196007063863342, 
                    -0.05556156101395271, 
                    0.7472349951928638, 
                    -0.25624733905716013, 
                    0.2528945926785745, 
                    0.7230170055487979, 
                    0.3098861915721488, 
                    0.020560668172190932, 
                    0.804095869674982, 
                    -0.04278647873778507, 
                    -0.3498852158933891, 
                    0.5945844014603672, 
                    0.1719101906742888, 
                    -0.35819384198323656, 
                    -0.26606210707249817, 
                    0.5303956732423039, 
                    -0.47430081449973494, 
                    -0.2961773416777047, 
                    0.49349722422652365, 
                    0.14758730880169335, 
                    -0.5826007242032141, 
                    -0.2072318195285986, 
                    -0.10302571872864907, 
                    0.5045641832622991, 
                    -0.09323950601189346, 
                    -0.265502198111155, 
                    0.0987757062278275, 
                    -0.26753604376308265, 
                    -0.3034510881458472, 
                    0.680875500327355, 
                    -0.4359321817281563, 
                    -0.4422522353450957, 
                    -0.3584242015841681, 
                    0.1742729545233359, 
                    0.18205195062830737, 
                    -0.34500901535296913, 
                    0.09924534377512095, 
                    -0.3938866991428316, 
                    0.5113352539788878, 
                    -0.3821117904474214, 
                    0.005234466523632575, 
                    -0.511118496080692, 
                    0.13759815979714107, 
                    -0.025410320551036425, 
                    -0.4455925419299663, 
                    -0.35763877989817533, 
                    0.4463878834565629, 
                    0.7979193274005862, 
                    -0.08134992540943342, 
                    -0.5434142120478986, 
                    -0.4232798184824784, 
                    0.21534114571698948, 
                    -0.4867632389606923, 
                    0.25951030844410294, 
                    0.2670385155511259, 
                    0.5565025705354809, 
                    -0.21530813837102852, 
                    0.1958760026585632, 
                    0.5404050686842379, 
                    -0.5293870688137254, 
                    0.08689331950491652, 
                    -0.540019136760461, 
                    -0.040539223057748486, 
                    0.7372718919432704, 
                    -0.08643597462161767, 
                    0.2790946430214447, 
                    0.553578816759779, 
                    0.7866048475241483, 
                    0.31294805974405104, 
                    0.1296323980369255, 
                    -0.3691995400701933, 
                    -0.2844058385052593, 
                    -0.10448653905920824, 
                    -0.3187180577695235, 
                    0.7251891699364399, 
                    -0.5386058856828504, 
                    -0.4675893490733295, 
                    0.31985446765093684, 
                    -0.14714363549340653, 
                    0.049064918148133296, 
                    -0.309532879733977, 
                    0.19707593459379247, 
                    -0.08037921811834003, 
                    0.16731774398776078, 
                    -0.031939934171983264, 
                    0.7678232595093735, 
                    -0.11356961100928986, 
                    0.4730219421601045, 
                    -0.002542629263967533, 
                    -0.40458038451349587, 
                    -0.11814632946726822, 
                    0.5536930584749362, 
                    0.07649421056322481, 
                    0.15849345194575326, 
                    0.09080399202110456, 
                    -0.21579121282252484, 
                    -0.12769903867363286, 
                    -0.6162000434079322, 
                    -0.30152126218751735, 
                    0.6876076275101919, 
                    0.4392440457104385, 
                    -0.17465802234154965, 
                    -0.06747472028534895, 
                    -0.31298292963540786, 
                    0.36608772362711006, 
                    0.6228998222313591, 
                    0.19747862985993092, 
                    -0.5646904013385892, 
                    0.2619797150097116, 
                    0.08367563903391695, 
                    0.10033138406765207, 
                    -0.4739578873601099, 
                    0.22326973768130598, 
                    -0.007654555568756938, 
                    -0.2120217043890924, 
                    0.7417999786060017, 
                    0.6208959661958406, 
                    -0.4565049025535446, 
                    -0.5225012629074833, 
                    0.1928978759127249, 
                    -0.3388374530169256, 
                    -0.09028860144827144, 
                    -0.09221812352343939, 
                    -0.46774588945131734, 
                    -0.5729275108965164, 
                    -0.44061505562803727, 
                    0.046316763740891664, 
                    0.5736096877959369, 
                    -0.4617469310193385, 
                    -0.3579227824799994, 
                    0.21059912517556179, 
                    -0.16955552775056798, 
                    0.5744558439247529, 
                    -0.21457409360477575, 
                    0.782691001815411, 
                    -0.5947173281241183, 
                    -0.5662889435437293, 
                    -0.39807695523226744, 
                    -0.2813175811933309, 
                    0.09986649796926428, 
                    0.7566136055367243, 
                    -0.2937209035894035, 
                    -0.2268632255182848, 
                    0.6121261306815111, 
                    0.2720411899531878, 
                    -0.08211938343147973, 
                    0.13814859798102763, 
                    0.5796158369929878, 
                    0.43836416720753824, 
                    -0.0710149754815087, 
                    0.3656910338402648, 
                    0.06410435176670992, 
                    -0.43667224886610534, 
                    -0.28590878242475476, 
                    -0.3602441735545322, 
                    0.3430396516830757, 
                    0.5689549890217713, 
                    -0.3220132226516173, 
                    -0.20949590356166403, 
                    -0.4370262153067218, 
                    0.3341240725207404, 
                    0.3278822201901036, 
                    0.5704229969674388, 
                    -0.28905315709012325, 
                    0.012840558276414171, 
                    0.7048815448537369, 
                    0.4847192758488823, 
                    -0.637278559224115, 
                    0.26310426670837084, 
                    0.7643638225318736, 
                    0.38761159667496004, 
                    -0.28834778668466365, 
                    -0.1588072890121971, 
                    -0.07518790868297442, 
                    0.4499177248987132, 
                    -0.1446054171321594, 
                    0.3207979556223971, 
                    0.6202143188010429, 
                    0.2197406804712686, 
                    0.8472218812179577, 
                    0.5264489005522659, 
                    -0.17051997976584832, 
                    -0.5486572297469599, 
                    0.29589372566480376, 
                    -0.31174686196279533, 
                    0.6091655321816649, 
                    0.24051679003066428, 
                    -0.5272343363850944, 
                    -0.1094998398842012, 
                    0.41141275503112573, 
                    0.5980678884658199, 
                    -0.19448554752315195, 
                    -0.40390592049930274, 
                    0.0023740476156146606, 
                    0.7882046388007071, 
                    0.229757212919097, 
                    -0.304855161226172, 
                    -0.02037706498099512, 
                    0.3047172272670444, 
                    0.5258452406432264, 
                    0.5243151974375908, 
                    -0.3423779719148975, 
                    0.06135214816188217, 
                    -0.22668489904261074, 
                    -0.24006283590015598, 
                    -0.17683865843958613, 
                    -0.3098534157488254, 
                    -0.3033997353597073, 
                    0.3623327701755088, 
                    -0.4544296220502214, 
                    0.19007069775389263, 
                    -0.2531753538117081, 
                    0.12085783919653093, 
                    0.4759839781870694, 
                    0.45617038293688417, 
                    -0.44177027704327987, 
                    -0.25270260648957144, 
                    -0.4269393975417455, 
                    0.021265833746131113, 
                    -0.14275227723770295, 
                    0.6798209547580827, 
                    -0.10328563022671966, 
                    0.15624928824478246, 
                    -0.043504818962274094, 
                    -0.2268860889796313, 
                    0.7227297781880984, 
                    0.6231986284996069, 
                    -0.14258689767969812, 
                    0.2027459567989356, 
                    -0.49582013241899825, 
                    -0.20436237292960935, 
                    -0.06168653433989024, 
                    -0.49315464753635363, 
                    0.04263959677644069, 
                    0.3619780713557599, 
                    0.14381764680603304, 
                    -0.2553471862482157, 
                    0.36142320510352666, 
                    0.26442868717761425, 
                    -0.5881901116807349, 
                    -0.12849467807824, 
                    -0.28403660634947925, 
                    -0.31133886506695735, 
                    0.6870027638009266, 
                    -0.0017903932117498966, 
                    0.12621106774725033, 
                    0.5563222174658302, 
                    -0.407399124677436, 
                    -0.6349968317541745, 
                    -0.5821905005862035, 
                    0.6402483267730297, 
                    -0.2948471070058645, 
                    0.6942593817059743, 
                    -0.010931309507166587, 
                    -0.580812162959602, 
                    -0.48686192974870635, 
                    0.17439800985260134, 
                    -0.5931244342792666, 
                    -0.15485561010755755, 
                    -0.35481442176304767, 
                    -0.5959131610956221, 
                    -0.1521313633803652, 
                    0.3522862395241896, 
                    -0.35030118240933494, 
                    -0.40488411717980116, 
                    -0.013469519220964732, 
                    0.06807546014038968, 
                    0.09890996659133822, 
                    0.09281744320807872, 
                    -0.2515136055915525, 
                    -0.5898275699930197, 
                    0.4409891966455819, 
                    -0.2928262802679641, 
                    -0.35768847460742753, 
                    0.05088187052201687, 
                    0.6668754227738412, 
                    -0.42668578368056587, 
                    -0.620977252416854, 
                    -0.3569480756600696, 
                    0.4514007860090594, 
                    0.4136413889564843, 
                    -0.46178633750109366, 
                    -0.04507959167635445, 
                    0.22100107215596765, 
                    -0.2905951117179799, 
                    0.3944699431861516, 
                    0.35536888553211043, 
                    0.08241580231288737, 
                    -0.637278559224115, 
                    -0.44599969641344994, 
                    -0.41818708183540004, 
                    -0.28708895642898846, 
                    0.2868778328972543, 
                    0.3192249918979868, 
                    0.05637775198937445, 
                    -0.262001764941158, 
                    -0.2667163043125034, 
                    -0.48676886196072433, 
                    -0.07175178727618703, 
                    0.40830147362986136, 
                    -0.21382273697131704, 
                    0.6836636289550082, 
                    -0.5364833801658517, 
                    -0.33527221202872803, 
                    -0.4706965280406779, 
                    0.09147332867914637, 
                    0.0665943576302449, 
                    -0.4729317571602652, 
                    -0.3785409203065357, 
                    -0.25098349958280597, 
                    0.38880868978267724, 
                    -0.3233799549278082, 
                    -0.49220462054584213, 
                    0.5452651784567799, 
                    -0.39779777233506985, 
                    -0.15374261132287614, 
                    -0.1244519202740959, 
                    -0.01661069612253585, 
                    0.08915277346822703, 
                    0.6786088565123558, 
                    -0.19303510596063195, 
                    -0.19939884825470472, 
                    -0.3936080775094928, 
                    0.6795738642066729, 
                    -0.0504169782835151, 
                    -0.24613373765485475, 
                    -0.4353754592624626, 
                    0.6533889084884121, 
                    0.602156361072534, 
                    -0.6409741732225284, 
                    0.05170940471129959, 
                    0.5231018232350753, 
                    -0.28155576032238727, 
                    -0.40945941371261974, 
                    -0.39703684961142505, 
                    -0.39947851483499985, 
                    -0.5424981837131576, 
                    -0.33196382988855117, 
                    0.22919203726963944, 
                    0.2631385632146487, 
                    -0.34954963839905706, 
                    0.7674460595821291, 
                    -0.24819519134136103, 
                    0.4400370185603679, 
                    0.08465653242213034, 
                    0.1450390996905453, 
                    0.7051710625606447, 
                    -0.2843698724950411, 
                    0.05370876656501633, 
                    0.02718375149417962, 
                    -0.22916123623730233, 
                    -0.19460821493838626, 
                    0.47347870599793396, 
                    0.8349197265967596, 
                    -0.03594444090657278, 
                    0.0142000849491426, 
                    0.38186423415290616, 
                    -0.1769594934846902, 
                    -0.2180137675663289, 
                    0.6323235359424453, 
                    0.30123217143032444, 
                    0.09511783189640488, 
                    0.647039376172545, 
                    -0.18923630306033695, 
                    0.387488379478484, 
                    -0.13201841061522368, 
                    0.1334242846593574, 
                    -0.548515124820249, 
                    -0.24098388976575763, 
                    0.17846884971504928, 
                    -0.19409302319441657, 
                    -0.3833103416733561, 
                    0.850481682350126, 
                    -0.249275547552553, 
                    0.840361064217674, 
                    0.7863810032296796, 
                    0.3189535647206442, 
                    -0.07939692739539306, 
                    -0.12133824042413655, 
                    0.44426088072970504, 
                    0.77015277012680206, 
                    -0.14448366167166454, 
                    -0.36598239059647397, 
                    0.09532704017171312, 
                    -0.2438900790575278, 
                    -0.41277526249407004, 
                    -0.11065256544729407, 
                    -0.2938513739674896, 
                    -0.06962814162922892, 
                    0.5991105535365342, 
                    -0.5437658421209655, 
                    -0.4711695876418457, 
                    -0.14356144788916275, 
                    0.5797357845748548, 
                    -0.01642207516172567, 
                    -0.15787740177863568, 
                    -0.3208096483924202, 
                    -0.5177484762649031, 
                    -0.006798738154057293, 
                    0.6480438787194711, 
                    0.47484533212748214, 
                    -0.4098422639455247, 
                    -0.45633556260949004, 
                    -0.38799007584533884, 
                    -0.4417274869278249, 
                    -0.3410888421669771, 
                    0.08579814502474381, 
                    -0.2755361412503201, 
                    0.388587599258547, 
                    0.5173912613116376, 
                    0.10071699962532032, 
                    0.38216785837846823, 
                    -0.14286675685971878, 
                    0.2568821508827912, 
                    -0.42574910948721356, 
                    -0.24274443661791756, 
                    -0.1708814528105872, 
                    0.060061348344467635, 
                    -0.40970565033403195, 
                    -0.268434801347885, 
                    -0.4018873742942882, 
                    0.6166259107355316, 
                    -0.2346690662641277, 
                    -0.4501093684960711, 
                    -0.18061497143171568, 
                    0.5759078117915577, 
                    0.6580476670328896, 
                    0.2631855740259549, 
                    -0.2698870206877245, 
                    -0.3038698362136636, 
                    0.4249688210717013, 
                    0.1633344737722343, 
                    -0.3357509483221368, 
                    -0.2501147790013005, 
                    -0.5581413462406034, 
                    -0.3772502222415067, 
                    0.19376770915235753, 
                    -0.457925497598192, 
                    0.0011672778178849486 
)
)

