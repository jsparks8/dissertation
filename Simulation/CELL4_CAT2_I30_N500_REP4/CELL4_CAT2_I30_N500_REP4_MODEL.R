model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.280447, 1);
tau[2,2] ~ dlnorm(-0.377914, 1);
tau[3,2] ~ dlnorm(-0.180935, 1);
tau[4,2] ~ dlnorm(-0.285421, 1);
tau[5,2] ~ dlnorm(-0.284573, 1);
tau[6,2] ~ dlnorm(-0.148393, 1);
tau[7,2] ~ dlnorm(-0.15683, 1);
tau[8,2] ~ dlnorm(-0.19277, 1);
tau[9,2] ~ dlnorm(-0.172895, 1);
tau[10,2] ~ dlnorm(-0.191704, 1);
tau[11,2] ~ dlnorm(-0.199241, 1);
tau[12,2] ~ dlnorm(-0.170604, 1);
tau[13,2] ~ dlnorm(-0.624532, 1);
tau[14,2] ~ dlnorm(-0.564553, 1);
tau[15,2] ~ dlnorm(-0.609443, 1);
tau[16,2] ~ dlnorm(-0.558509, 1);
tau[17,2] ~ dlnorm(-0.602385, 1);
tau[18,2] ~ dlnorm(-0.59135, 1);
tau[19,2] ~ dlnorm(-0.405874, 1);
tau[20,2] ~ dlnorm(-0.37708, 1);
tau[21,2] ~ dlnorm(-0.223321, 1);
tau[22,2] ~ dlnorm(-0.25874, 1);
tau[23,2] ~ dlnorm(-0.241959, 1);
tau[24,2] ~ dlnorm(-0.308967, 1);
tau[25,2] ~ dlnorm(-0.0856, 1);
tau[26,2] ~ dlnorm(-0.233115, 1);
tau[27,2] ~ dlnorm(-0.220088, 1);
tau[28,2] ~ dlnorm(-0.244983, 1);
tau[29,2] ~ dlnorm(-0.086683, 1);
tau[30,2] ~ dlnorm(-0.264681, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -0.9566149039453105, 
                    -0.699001035832852, 
                    -1.246861473766001, 
                    -0.9428497438530732, 
                    -0.9451919581761818, 
                    -1.3482180615989132, 
                    -1.3216227792262527, 
                    -1.2108099572366637, 
                    -1.2715980946374088, 
                    -1.2140385752957221, 
                    -1.1912771741511181, 
                    -1.2786813425582935, 
                    -0.14901925598137875, 
                    -0.2705715614609102, 
                    0.17891532202236454, 
                    -0.2832289276105742, 
                    -0.1930559121675984, 
                    -0.21536409940044157, 
                    0.6296179078414397, 
                    0.7011013669452537, 
                    1.1196957481969962, 
                    1.0174868830312342, 
                    1.0654610623916312, 
                    0.8786168654764592, 
                    1.5533699025318615, 
                    1.0910700913614455, 
                    1.1292060847189267, 
                    1.0567561399778544, 
                    1.549719321383787, 
                    1.0006952888802123 ),
tau=matrix(c( NA,1.2455200918714444, 
                    NA,1.1298514650889506, 
                    NA,1.3758408017209347, 
                    NA,1.2393395349900298, 
                    NA,1.2403911892211057, 
                    NA,1.421349909657912, 
                    NA,1.4094086278725877, 
                    NA,1.3596536707992621, 
                    NA,1.3869475444921966, 
                    NA,1.3611033203077794, 
                    NA,1.3508834511938521, 
                    NA,1.3901279228086738, 
                    NA,0.8829096459356391, 
                    NA,0.9374866310959487, 
                    NA,0.8963329795880417, 
                    NA,0.9431697884971479, 
                    NA,0.9026821045632518, 
                    NA,0.9126984806307983, 
                    NA,1.0986984406208065, 
                    NA,1.130794513758419, 
                    NA,1.3187433909404513, 
                    NA,1.2728516104810241, 
                    NA,1.2943920170138425, 
                    NA,1.2104989725989301, 
                    NA,1.513463086236806, 
                    NA,1.305890471021289, 
                    NA,1.3230135320387981, 
                    NA,1.2904835068500566, 
                    NA,1.5118239753013203, 
                    NA,1.2653121847072155 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 -0.12455300892805041, 
                    0.26253580453804454, 
                    -0.16745582377312396, 
                    0.15074501989425887, 
                    -0.30049673708696995, 
                    -0.0983899929025307, 
                    -0.2489669593897772, 
                    -0.07266229644910543, 
                    -0.17732329770135438, 
                    -0.3337291346091058, 
                    -0.03133559199679703, 
                    -0.06617402454079813, 
                    -0.04058755238177192, 
                    -0.32374890995115346, 
                    -0.14032392194952634, 
                    0.02694957885697069, 
                    -0.05903096372485778, 
                    -0.23488979095077372, 
                    0.11986809160811168, 
                    0.260591142153959, 
                    -0.25975287221303556, 
                    -0.031077478433382322, 
                    -0.12438298496159986, 
                    0.051645071747094484, 
                    0.07768381207778191, 
                    -0.19372258294171787, 
                    0.00909456714631518, 
                    -0.20601480372130804, 
                    -0.2794248649686123, 
                    0.04135731389205177, 
                    0.16771270221382845, 
                    0.03974918307718278, 
                    0.19566634399623967, 
                    -0.12090980071733165, 
                    0.03204853210649833, 
                    -0.27521324834303995, 
                    -0.14332623548565857, 
                    0.18232409627493001, 
                    0.19927822216095675, 
                    0.06033569474200989, 
                    0.21392687689134277, 
                    0.21244607323688597, 
                    0.21167328688835169, 
                    -0.07034171659786376, 
                    -0.2165991997785701, 
                    0.17858821827626098, 
                    0.0667568410722294, 
                    -0.24546875339562507, 
                    -0.021408790106094144, 
                    -0.0564119802597548, 
                    0.1350079447663612, 
                    0.16131825256234317, 
                    -0.0026956159001002566, 
                    0.2067989881071522, 
                    -0.04287653986755624, 
                    0.15258606025403826, 
                    0.1152348691449363, 
                    0.15507261662963318, 
                    0.20616351932087923, 
                    0.1519044097933963, 
                    0.1006637416377455, 
                    0.06348737241965818, 
                    0.260591142153959, 
                    -0.28532274241195077, 
                    -0.16417916827169035, 
                    -0.24296226568484908, 
                    0.08724047500671056, 
                    -0.040364343157797855, 
                    0.26253580453804454, 
                    -0.26297540116970025, 
                    -0.1519183002381143, 
                    -0.27744507371593613, 
                    -0.21599797579428173, 
                    0.19264822950094723, 
                    0.1997653962797163, 
                    0.07491412698941052, 
                    -0.1320244990511738, 
                    0.021368906306018676, 
                    -0.11376254883427087, 
                    -0.28359271059312513, 
                    -0.03478679478457075, 
                    -0.2697724680840524, 
                    -0.13370580777707616, 
                    0.15163482229952235, 
                    0.05210651000387584, 
                    0.26253580453804454, 
                    -0.12134429550161935, 
                    -0.0696479807303454, 
                    -0.053534306517435404, 
                    0.15911165217469864, 
                    0.12086539118952244, 
                    0.13589725225609717, 
                    -0.020935955888023716, 
                    0.12913325949274995, 
                    -0.12866436714731544, 
                    -0.08927740367628328, 
                    0.250280981828469, 
                    -0.12762015723847842, 
                    -0.10156035921549761, 
                    -0.30442603088053555, 
                    0.18366316157634482, 
                    -0.09041613813113397, 
                    0.07108267505945898, 
                    -0.15789302442386025, 
                    0.12436014016356062, 
                    -0.08792692025039539, 
                    -0.3081512330255997, 
                    0.1619835834859869, 
                    0.0726352779001736, 
                    0.023028684171837732, 
                    -0.05225449687006328, 
                    -0.3367907573133394, 
                    0.26253580453804454, 
                    0.22402729661412096, 
                    0.16027592047564893, 
                    0.15065503355270687, 
                    0.22104115612015446, 
                    0.0789988311409407, 
                    -0.23149959830673694, 
                    0.10326943285690715, 
                    0.24239461289527936, 
                    -0.2198143365391489, 
                    0.1159246924738323, 
                    0.17100746328621036, 
                    -0.004386796659854586, 
                    0.22309936172221895, 
                    0.040972306996438, 
                    0.014936392045652669, 
                    0.21050364787108083, 
                    -0.2107263302958278, 
                    0.19231328053805502, 
                    0.037412084991162275, 
                    -0.20401563713986565, 
                    -0.0809160198331898, 
                    -0.28927725310171093, 
                    -0.2684223815195067, 
                    -0.1221533114992171, 
                    -0.23776076910583105, 
                    0.10252290478587578, 
                    0.2329273683789756, 
                    0.2441223635991862, 
                    0.13561022981819731, 
                    0.0912014831471411, 
                    -0.07190797329545345, 
                    -0.2320647424235509, 
                    0.05430178120772827, 
                    -0.2844666135584805, 
                    0.22204439571791673, 
                    -0.05254515694345374, 
                    0.2235888961293751, 
                    0.23113777099640714, 
                    0.0023809456258768735, 
                    0.06121640180991417, 
                    -0.24485911056523857, 
                    0.09051365092885572, 
                    -0.09063444276697474, 
                    0.0880082481585222, 
                    -0.27551435542090513, 
                    -0.32003876304608914, 
                    -0.07637890880668696, 
                    0.027047033711386503, 
                    0.1469673682502382, 
                    -0.15601881157312808, 
                    0.055150547069143074, 
                    -0.12009070110444867, 
                    -0.058006782212228936, 
                    -0.045731594372499074, 
                    -0.06298848285429903, 
                    0.08396547562394885, 
                    0.07337479092664884, 
                    0.18544035801896624, 
                    -0.12263632928567711, 
                    0.1355643504590624, 
                    0.06154791078632044, 
                    0.14586238956858372, 
                    0.24295226166356682, 
                    -0.04391536970791193, 
                    0.07406447915697018, 
                    -0.12174522287628622, 
                    -0.13444281568497657, 
                    0.08490682394900922, 
                    0.21617363818896856, 
                    -0.1916444743053431, 
                    -0.03532682478530358, 
                    0.2083252288207929, 
                    -0.2772765809846123, 
                    -0.3002323302669714, 
                    0.053161230179265606, 
                    -0.21964687954441703, 
                    0.010744929562343408, 
                    -0.03274625277023774, 
                    0.12778188635440402, 
                    -0.1701316927382099, 
                    -0.059253765624713406, 
                    0.011863903170849288, 
                    0.18808478248660082, 
                    0.1727131439865051, 
                    -0.0020109011764163354, 
                    0.0022044297104155675, 
                    -0.01282413129478327, 
                    0.14188148006810541, 
                    0.26253580453804454, 
                    0.1546965014258554, 
                    0.21240379730344733, 
                    -0.17029888797962173, 
                    0.06770359850289592, 
                    0.2063514244545573, 
                    -0.12566658605212738, 
                    -0.1276312912214869, 
                    0.16506044493456623, 
                    0.176012016013596, 
                    -0.07058505800046466, 
                    -0.35210836752370017, 
                    0.08430863405869721, 
                    0.22856022116177438, 
                    -0.12332767049960205, 
                    0.06812451407107689, 
                    -0.2214415319517632, 
                    0.19062964259473275, 
                    0.20061179735841056, 
                    -0.08439795164833425, 
                    0.08443770397627548, 
                    -0.08408014839137384, 
                    -0.21548104596761813, 
                    0.07197432720378077, 
                    0.22327122820814943, 
                    -0.26971392340274236, 
                    0.260591142153959, 
                    -0.050056543031430034, 
                    -0.308838786911679, 
                    -0.11238977195594876, 
                    -0.3215156308988526, 
                    0.17453390597890311, 
                    0.128393089960391, 
                    0.22476835663835998, 
                    0.02631292226709936, 
                    0.06720048829029113, 
                    -0.10288185235380354, 
                    -0.22379084568058918, 
                    -0.32032833868631044, 
                    0.21825879604129167, 
                    -0.013845882677354648, 
                    -0.029806741326393493, 
                    0.250280981828469, 
                    0.045775937673356526, 
                    0.25194064833558777, 
                    0.1785684652275114, 
                    -0.1990588546125903, 
                    -0.20927699499419544, 
                    -0.045876061586939076, 
                    0.2167386655099574, 
                    0.19122744177438994, 
                    -0.23892270254971584, 
                    0.22268370238207075, 
                    0.17962860942791853, 
                    -0.12150682169483099, 
                    -0.2293848020480631, 
                    -0.03057497504043638, 
                    0.03837643368846366, 
                    0.2501379588171386, 
                    -0.025670627007211066, 
                    0.26253580453804454, 
                    0.0357374218500055, 
                    -0.12636218024978574, 
                    -0.2387424217142411, 
                    -0.1944073257894953, 
                    -0.00890834992676387, 
                    0.0846711586051408, 
                    -0.04845611935330807, 
                    -0.003774448175191125, 
                    0.22469654102930364, 
                    -0.058708260028349835, 
                    0.16485717728554777, 
                    0.04698903093475426, 
                    -0.1885281627904447, 
                    -0.1184824918850195, 
                    0.13232739960696543, 
                    0.09212858217932002, 
                    0.09409067939372978, 
                    -0.08874659267404922, 
                    0.2475094371980831, 
                    -0.0270140479498559, 
                    -0.2381054631793033, 
                    0.07062672327462394, 
                    -0.03585971176956826, 
                    0.21089219668944298, 
                    -0.307671435963791, 
                    -0.3067810707137316, 
                    -0.06603347212394595, 
                    0.260591142153959, 
                    -0.029922976803868462, 
                    0.10569810760220061, 
                    0.13068460393706965, 
                    -0.05516884456672949, 
                    -0.005110238288496938, 
                    -0.21958416803643233, 
                    -0.25041518524612594, 
                    0.03370517286889674, 
                    -0.31834309454054877, 
                    0.09540180391297043, 
                    -0.03212579128834836, 
                    -0.024567291556099324, 
                    0.19730248093329367, 
                    -0.06685326349033022, 
                    -0.15046176728487906, 
                    0.11691707874751439, 
                    -0.07077118524933707, 
                    -0.09176568197216894, 
                    -0.0015883489104175363, 
                    0.22953446284092333, 
                    0.22576865949960973, 
                    -0.20045893055651046, 
                    -0.12775845921894383, 
                    -0.25938038657604956, 
                    0.248231595113856, 
                    -0.00743261453908034, 
                    -0.21628303149268305, 
                    0.18663987723958148, 
                    -0.2000025252777747, 
                    -0.16783005391884226, 
                    0.08765472566413052, 
                    0.07046280204171107, 
                    0.26253580453804454, 
                    -0.20101852747761526, 
                    0.20137470814673003, 
                    0.2441223635991862, 
                    0.051419781124515784, 
                    0.008509875821175072, 
                    -0.1925451169958069, 
                    0.13672258526760767, 
                    0.06231020874207899, 
                    -0.32826286400924604, 
                    -0.05617666927919451, 
                    -0.009132329255570337, 
                    0.24295226166356682, 
                    0.15810854696091942, 
                    -0.060968719655934756, 
                    -0.1968369624489698, 
                    -0.31262384280431044, 
                    0.21439579275810733, 
                    0.20818071911731345, 
                    0.23027766050022497, 
                    0.22570477942311035, 
                    0.09530686399615523, 
                    0.1838185243348252, 
                    0.08552291265222023, 
                    0.2475094371980831, 
                    -0.12718863319160204, 
                    0.23448497499312987, 
                    0.2034765521864929, 
                    0.08134558603558967, 
                    0.06251410874262159, 
                    0.025906004080467837, 
                    0.10602828002938464, 
                    0.11837979587868724, 
                    0.05516962327296088, 
                    0.20161565058573788, 
                    -0.10549959075680163, 
                    0.2131780952045917, 
                    -0.12876943016423043, 
                    0.2382107433724197, 
                    -0.06036230919014823, 
                    -0.24886601303418246, 
                    -0.19686828203047868, 
                    -0.08754439784140794, 
                    0.18703521079010593, 
                    -0.31107836693770996, 
                    -0.059172251132204146, 
                    0.24587624397961366, 
                    -0.19540195164777707, 
                    -0.10667449911082272, 
                    -0.12870530660060434, 
                    -0.3195920325918013, 
                    -0.2612191272061914, 
                    -0.22463258313848503, 
                    -0.05330247914897668, 
                    -0.2097265488632136, 
                    0.11411079997138684, 
                    0.054277792346316744, 
                    -0.22641351313842262, 
                    0.04943201617258386, 
                    -0.19595292148599097, 
                    0.012661618846919742, 
                    -0.13808583025128177, 
                    -0.18195553396867706, 
                    -0.06969644755413257, 
                    0.1296700579061253, 
                    0.030975401960244175, 
                    -0.3227662480135736, 
                    -0.1921398951921018, 
                    -0.150630692303823, 
                    -0.21685208206678763, 
                    -0.18762709327738275, 
                    0.26253580453804454, 
                    -0.2691555626340476, 
                    -0.16290989220406327, 
                    -0.22382441922222815, 
                    0.20540267420238928, 
                    -0.14136606482115208, 
                    -0.26480633216756533, 
                    0.09177986823493728, 
                    0.1000072400620583, 
                    -0.26547877828166466, 
                    0.17061141970276889, 
                    -0.1747671180126921, 
                    0.1967583414892326, 
                    -0.3101042494409907, 
                    0.18231536701759027, 
                    -0.17163608835827554, 
                    -0.07596514616552902, 
                    0.19940473774659778, 
                    0.26253580453804454, 
                    0.22014107637421304, 
                    -0.23179401842245412, 
                    -0.12658013572621055, 
                    0.13696197835015889, 
                    0.13403319525964974, 
                    0.10188685935661979, 
                    -0.20706975814253034, 
                    0.18004935181786436, 
                    0.012787703641582826, 
                    0.22079592092787043, 
                    0.2164614467958939, 
                    -0.11805344118938607, 
                    0.1709962732524249, 
                    0.1656738019807839, 
                    -0.26788611666315354, 
                    0.2036130348009782, 
                    0.13376681035514915, 
                    0.09731766351048765, 
                    0.0826763975124844, 
                    0.056786316490300304, 
                    0.11180251802090174, 
                    0.014535515336774274, 
                    0.1502218351142745, 
                    0.17434985465787373, 
                    0.19957255153654024, 
                    -0.18433927345277767, 
                    0.17295577778518995, 
                    0.2254743097879814, 
                    0.22296533576165528, 
                    -0.04164696325776246, 
                    0.12083702784686401, 
                    -0.23669000642283966, 
                    0.1543206827724372, 
                    -0.19160330012885854, 
                    0.22273693452577775, 
                    0.1554509458362499, 
                    0.03879122002500296, 
                    -0.18647509619100136, 
                    -0.11306555040216587, 
                    -0.08636568526262589, 
                    -0.12515132541411045, 
                    0.1475666387227732, 
                    0.10436427218599986, 
                    0.18384698165941799, 
                    0.16930308518279596, 
                    -0.04575154102090995, 
                    0.1287698712600469, 
                    0.2441223635991862, 
                    -0.2370169532537625, 
                    -0.23518222854015428, 
                    0.2137263190842929, 
                    -0.1937671127224374, 
                    0.22171107170741072, 
                    0.22706064656824448, 
                    0.18182021882233795, 
                    -0.19069122871244448, 
                    -0.21787244747421766, 
                    0.04215458449307513, 
                    0.0019708766778603337, 
                    0.23243898412607916, 
                    -0.16748542298660735, 
                    0.11764461336834697, 
                    0.056976670610744795, 
                    0.02909608578644174, 
                    0.2237669657022125, 
                    -0.03597167505011922, 
                    0.03411174611839174, 
                    0.21392687689134277, 
                    -0.19180418761945559, 
                    -0.20043248584075032, 
                    0.2312798126246018, 
                    0.1577619070738156, 
                    -0.06710999435325249, 
                    0.26253580453804454, 
                    -0.13995888192735662, 
                    0.18967042920894445, 
                    0.23977770342772037, 
                    0.23114108461497768, 
                    0.20253952247058843, 
                    0.09849944386108084, 
                    0.25296475661898815, 
                    0.09060729487090119, 
                    0.11358627986385927, 
                    -0.26188790973441334, 
                    0.02132318308571962, 
                    -0.05954639455848104, 
                    -0.16274600263708755, 
                    0.16601475558898632 
)
)

