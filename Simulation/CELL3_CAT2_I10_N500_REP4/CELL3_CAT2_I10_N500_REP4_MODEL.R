model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.152615, 1);
tau[2,2] ~ dlnorm(-0.163132, 1);
tau[3,2] ~ dlnorm(-0.284903, 1);
tau[4,2] ~ dlnorm(-0.301186, 1);
tau[5,2] ~ dlnorm(-0.532247, 1);
tau[6,2] ~ dlnorm(-0.605778, 1);
tau[7,2] ~ dlnorm(-0.294362, 1);
tau[8,2] ~ dlnorm(-0.33354, 1);
tau[9,2] ~ dlnorm(-0.26863, 1);
tau[10,2] ~ dlnorm(-0.153346, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.3348824235697516, 
                    -1.3019035269290746, 
                    -0.9442809432927464, 
                    -0.8996770318560212, 
                    -0.33912538768068407, 
                    -0.186245918138577, 
                    0.9182826393792566, 
                    0.813175910752573, 
                    0.9895893403296304, 
                    1.3325764299652576 ),
tau=matrix(c( NA,1.4153622081828185, 
                    NA,1.4005546835911544, 
                    NA,1.2399821435384433, 
                    NA,1.2199549873033537, 
                    NA,0.9682672990686272, 
                    NA,0.8996244172442212, 
                    NA,1.2283089050812863, 
                    NA,1.1811159839279053, 
                    NA,1.2603256138080041, 
                    NA,1.4143268170544008 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 -0.250461144810287, 
                    -0.08268789099387663, 
                    -0.19899524566770785, 
                    -0.11935352632518553, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.19432583274986692, 
                    0.16098513147295745, 
                    0.09596948001615141, 
                    -0.334288346614283, 
                    0.19432583274986692, 
                    0.16098513147295745, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.021469290109127515, 
                    0.16098513147295745, 
                    0.04736265202075263, 
                    -0.035339547149806194, 
                    -0.18051010551508836, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.12316290924720352, 
                    0.17599673066415444, 
                    0.2215095292418986, 
                    0.10210225655290278, 
                    0.01868154564433222, 
                    0.2215095292418986, 
                    0.01868154564433222, 
                    0.16098513147295745, 
                    0.19432583274986692, 
                    0.10210225655290278, 
                    -0.043072046572239286, 
                    0.19432583274986692, 
                    -0.12988229001052837, 
                    -0.05831610481315952, 
                    0.19432583274986692, 
                    0.19432583274986692, 
                    -0.23484153290973123, 
                    -0.09320364952487209, 
                    0.11302221866305329, 
                    0.08287904490680414, 
                    0.07299292235279814, 
                    -0.06988714624377623, 
                    -0.22581515286700196, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    -0.19573356238347892, 
                    0.09859323951242926, 
                    -0.14859286639260685, 
                    0.19432583274986692, 
                    -0.2721193948553961, 
                    0.11302221866305329, 
                    0.2215095292418986, 
                    -0.37463205032175384, 
                    -0.1489493510766497, 
                    -0.19310980288720092, 
                    -0.0581262509386391, 
                    -0.10570421269309888, 
                    -0.043072046572239286, 
                    0.08287904490680414, 
                    0.0749328574493085, 
                    -0.33394284368096866, 
                    -0.22504078682211692, 
                    0.17599673066415444, 
                    0.10081149776993303, 
                    -0.031740962902694736, 
                    0.11302221866305329, 
                    0.006303277878059177, 
                    -0.14449268226725132, 
                    0.10081149776993303, 
                    0.19432583274986692, 
                    -0.12214127078998088, 
                    0.08287904490680414, 
                    0.14379016440625558, 
                    -0.15865634948799426, 
                    -0.18251295633542386, 
                    -0.056376169716649105, 
                    0.136042844570871, 
                    0.11302221866305329, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    0.16098513147295745, 
                    0.16098513147295745, 
                    -0.3026723665737893, 
                    -0.0581262509386391, 
                    -0.23088004952359933, 
                    0.11413957160456256, 
                    0.01868154564433222, 
                    -0.056376169716649105, 
                    -0.11278435578601781, 
                    -0.2625718305288545, 
                    -0.2271333986629756, 
                    0.16098513147295745, 
                    0.19432583274986692, 
                    -0.16593873340323745, 
                    0.19432583274986692, 
                    -0.043072046572239286, 
                    -0.03526044496293057, 
                    0.07043242655035237, 
                    -0.05899992921292707, 
                    -0.043072046572239286, 
                    0.08287904490680414, 
                    0.2215095292418986, 
                    -0.37463205032175384, 
                    0.15012225574967353, 
                    -0.34530414564576806, 
                    0.0629958538881904, 
                    0.11302221866305329, 
                    -0.03000523150055384, 
                    -0.22919457970301793, 
                    -0.0581262509386391, 
                    -0.23088004952359933, 
                    -0.12659793959937926, 
                    -0.1428263378340412, 
                    0.16098513147295745, 
                    0.008501870987437599, 
                    -0.1703978027392385, 
                    0.12595065371199887, 
                    0.08287904490680414, 
                    0.136042844570871, 
                    0.09596948001615141, 
                    0.2215095292418986, 
                    0.16098513147295745, 
                    0.08287904490680414, 
                    0.12316290924720352, 
                    -0.003669865832938324, 
                    -0.299106405128247, 
                    0.19432583274986692, 
                    0.19432583274986692, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    -0.19353879568398996, 
                    0.062062853397521545, 
                    0.0345532289931928, 
                    0.051144078095125, 
                    0.19432583274986692, 
                    -0.3880882026205522, 
                    -0.37463205032175384, 
                    0.09596948001615141, 
                    0.11775006572112201, 
                    -0.334288346614283, 
                    0.19432583274986692, 
                    0.01895570267453034, 
                    0.12595065371199887, 
                    -0.2938248822154407, 
                    -0.16593873340323745, 
                    -0.2721193948553961, 
                    -0.032005946741001934, 
                    -0.005731046872980594, 
                    0.18413386811372645, 
                    0.11302221866305329, 
                    -0.003390213718417079, 
                    0.09875031672989076, 
                    0.12595065371199887, 
                    -0.060939864309437486, 
                    0.062062853397521545, 
                    0.021469290109127515, 
                    -0.34530414564576806, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    -0.292295106010433, 
                    0.16098513147295745, 
                    -0.17618847571580568, 
                    -0.3487352157562854, 
                    -0.292295106010433, 
                    0.18413386811372645, 
                    -0.05899992921292707, 
                    -0.038704343593896906, 
                    0.04457490755595728, 
                    -0.05310823594511627, 
                    0.14676375850203727, 
                    0.01869383562357807, 
                    -0.08197648687628029, 
                    -0.12659793959937926, 
                    -0.12659793959937926, 
                    0.020787863599012357, 
                    0.11413957160456256, 
                    -0.37463205032175384, 
                    0.10081149776993303, 
                    -0.003669865832938324, 
                    -0.08664937438000853, 
                    0.09875031672989076, 
                    0.19432583274986692, 
                    0.0749328574493085, 
                    -0.13367787440867035, 
                    -0.05899992921292707, 
                    0.2215095292418986, 
                    0.018309868519194306, 
                    -0.12659793959937926, 
                    -0.03831826650888104, 
                    -0.11964127795147766, 
                    -0.060939864309437486, 
                    0.2215095292418986, 
                    0.10210225655290278, 
                    -0.18705093651346424, 
                    0.16098513147295745, 
                    0.08287904490680414, 
                    0.07299292235279814, 
                    -0.02590789896300799, 
                    -0.33394284368096866, 
                    -0.12988229001052837, 
                    0.2215095292418986, 
                    0.0749328574493085, 
                    -0.15496563525535062, 
                    -0.2964896178310432, 
                    -0.334288346614283, 
                    -0.21832992794808354, 
                    0.2215095292418986, 
                    -0.005731046872980594, 
                    -0.10102670560982369, 
                    -0.3880882026205522, 
                    -0.1827325423238446, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    -0.2904248292059647, 
                    0.09875031672989076, 
                    0.19432583274986692, 
                    -0.299106405128247, 
                    -0.15975598466049135, 
                    0.0749328574493085, 
                    0.18413386811372645, 
                    0.015705646229246084, 
                    0.2215095292418986, 
                    0.04065578491214178, 
                    0.19432583274986692, 
                    0.2215095292418986, 
                    0.12595065371199887, 
                    0.07716204248017894, 
                    -0.3487352157562854, 
                    -0.23484153290973123, 
                    0.0749328574493085, 
                    0.09875031672989076, 
                    -0.2560026599896868, 
                    0.05107910937719151, 
                    -0.10686596831130613, 
                    0.2215095292418986, 
                    -0.06180077572124337, 
                    0.136042844570871, 
                    -0.02590789896300799, 
                    -0.10438797323148802, 
                    0.16098513147295745, 
                    0.18413386811372645, 
                    0.2215095292418986, 
                    0.08287904490680414, 
                    0.19432583274986692, 
                    0.08287904490680414, 
                    0.2215095292418986, 
                    0.11302221866305329, 
                    -0.003669865832938324, 
                    0.2215095292418986, 
                    0.01869383562357807, 
                    -0.2457073647469287, 
                    -0.10686596831130613, 
                    0.09859323951242926, 
                    0.17599673066415444, 
                    -0.06032484404801752, 
                    -0.1703978027392385, 
                    -0.17207318032035812, 
                    0.136042844570871, 
                    -0.043072046572239286, 
                    -0.23484153290973123, 
                    -0.05291077843285541, 
                    0.09859323951242926, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.11994865883050043, 
                    -0.299106405128247, 
                    0.08287904490680414, 
                    0.14676375850203727, 
                    -0.3487352157562854, 
                    -0.05899992921292707, 
                    0.19432583274986692, 
                    0.10210225655290278, 
                    0.07299292235279814, 
                    0.2215095292418986, 
                    0.09596948001615141, 
                    -0.37463205032175384, 
                    0.11302221866305329, 
                    0.01868154564433222, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.020787863599012357, 
                    -0.1616959197570018, 
                    0.09859323951242926, 
                    0.19432583274986692, 
                    -0.056376169716649105, 
                    0.11994865883050043, 
                    0.19432583274986692, 
                    0.2215095292418986, 
                    0.16098513147295745, 
                    0.16098513147295745, 
                    -0.3026723665737893, 
                    -0.060939864309437486, 
                    0.10574485088251256, 
                    0.06837474127082344, 
                    -0.2606531094464275, 
                    0.09596948001615141, 
                    0.19432583274986692, 
                    0.08287904490680414, 
                    -0.3487352157562854, 
                    0.08287904490680414, 
                    -0.15717574855093935, 
                    -0.003669865832938324, 
                    -0.38482401495789437, 
                    0.2215095292418986, 
                    0.16098513147295745, 
                    -0.07179784418585111, 
                    0.020787863599012357, 
                    -0.18924952962284272, 
                    -0.17358481437262172, 
                    0.16098513147295745, 
                    0.19432583274986692, 
                    -0.23484153290973123, 
                    0.136042844570871, 
                    0.19432583274986692, 
                    -0.04226756020470945, 
                    -0.08197648687628029, 
                    -0.03831826650888104, 
                    0.16098513147295745, 
                    0.17599673066415444, 
                    0.1392022936395232, 
                    -0.1703978027392385, 
                    -0.17207318032035812, 
                    0.19432583274986692, 
                    0.09596948001615141, 
                    -0.1820528369166338, 
                    -0.2676602246882064, 
                    -0.3487352157562854, 
                    0.12595065371199887, 
                    -0.05831610481315952, 
                    -0.19573356238347892, 
                    -0.1889152910665907, 
                    0.11639568686561719, 
                    -0.17345077540797021, 
                    0.16098513147295745, 
                    -0.18535630182012258, 
                    0.11302221866305329, 
                    0.08287904490680414, 
                    -0.1379235117280836, 
                    0.2215095292418986, 
                    -0.06513336618041798, 
                    -0.08268789099387663, 
                    0.2215095292418986, 
                    0.026731485577812186, 
                    -0.11174023842591757, 
                    -0.005731046872980594, 
                    -0.33394284368096866, 
                    -0.05831610481315952, 
                    0.16098513147295745, 
                    0.11413957160456256, 
                    -0.2574682600520659, 
                    0.19432583274986692, 
                    0.09859323951242926, 
                    0.19432583274986692, 
                    0.2215095292418986, 
                    -0.299106405128247, 
                    0.16098513147295745, 
                    0.16098513147295745, 
                    0.18413386811372645, 
                    0.015705646229246084, 
                    0.19432583274986692, 
                    -0.050563204146712004, 
                    -0.005731046872980594, 
                    0.16098513147295745, 
                    0.2215095292418986, 
                    -0.2679315203038156, 
                    0.16098513147295745, 
                    -0.10753637361758095, 
                    0.2215095292418986, 
                    0.16098513147295745, 
                    -0.056376169716649105, 
                    0.19432583274986692, 
                    -0.005731046872980594, 
                    0.136042844570871, 
                    -0.08197648687628029, 
                    0.19432583274986692, 
                    -0.06393144086848163, 
                    0.0345532289931928, 
                    0.2215095292418986, 
                    -0.17295798948904212, 
                    0.01811402380517363, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    -0.22919457970301793, 
                    -0.299106405128247, 
                    -0.2904248292059647, 
                    0.09596948001615141, 
                    0.2215095292418986, 
                    -0.1489493510766497, 
                    -0.0673319592897964, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    -0.2660033347915157, 
                    -0.23362675447631068, 
                    0.01868154564433222, 
                    0.17599673066415444, 
                    0.08287904490680414, 
                    0.10081149776993303, 
                    0.01868154564433222, 
                    -0.16790914625958428, 
                    -0.3487352157562854, 
                    0.015705646229246084, 
                    0.04550893529511496, 
                    -0.372412883906687, 
                    -0.12988229001052837, 
                    0.07299292235279814, 
                    0.07299292235279814, 
                    0.19432583274986692, 
                    0.16098513147295745, 
                    -0.3372619407100647, 
                    -0.2336512485124163, 
                    -0.13151716857302248, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.14261463227633908, 
                    0.08287904490680414, 
                    -0.18924952962284272, 
                    -0.1823149044930052, 
                    0.09875031672989076, 
                    0.16098513147295745, 
                    -0.003390213718417079, 
                    -0.12174901409454159, 
                    -0.10570421269309888, 
                    -0.08197648687628029, 
                    -0.299106405128247, 
                    0.021469290109127515, 
                    -0.27748648715019736, 
                    0.2215095292418986, 
                    0.08287904490680414, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    -0.3026723665737893, 
                    -0.2560026599896868, 
                    -0.25879040445448215, 
                    0.2215095292418986, 
                    -0.005731046872980594, 
                    -0.25314060460729143, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.07299292235279814, 
                    0.1392022936395232, 
                    -0.3021847884015114, 
                    -0.12740429493071026, 
                    0.01868154564433222, 
                    0.08287904490680414, 
                    -0.12381019513458391, 
                    0.12595065371199887, 
                    -0.15234585065315287, 
                    0.08287904490680414, 
                    -0.26535957499364987, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    0.11302221866305329, 
                    -0.19405805175524313, 
                    0.08919534988350908, 
                    0.01868154564433222, 
                    -0.33394284368096866, 
                    0.16098513147295745, 
                    0.18413386811372645, 
                    -0.1703978027392385, 
                    0.16098513147295745, 
                    -0.26535957499364987, 
                    0.16098513147295745, 
                    0.19432583274986692, 
                    -0.23088004952359933, 
                    0.16098513147295745, 
                    0.2215095292418986, 
                    0.2215095292418986, 
                    0.01895570267453034, 
                    -0.12381019513458391, 
                    -0.02001803724208978, 
                    -0.12740429493071026, 
                    -0.22033517856117774, 
                    0.03531697065897449, 
                    -0.2904248292059647, 
                    0.2215095292418986, 
                    0.19432583274986692, 
                    -0.003669865832938324, 
                    -0.3003940527546084, 
                    0.16098513147295745, 
                    -0.33712883735502047, 
                    -0.035339547149806194, 
                    -0.02001803724208978, 
                    0.2215095292418986, 
                    0.08287904490680414, 
                    0.19432583274986692, 
                    -0.334288346614283, 
                    -0.09939760261727099, 
                    -0.08197648687628029, 
                    -0.1703978027392385, 
                    0.12595065371199887, 
                    0.17599673066415444, 
                    0.16098513147295745, 
                    -0.02886823862425153, 
                    -0.07350424070564593, 
                    0.19432583274986692, 
                    -0.1827325423238446, 
                    -0.37463205032175384, 
                    0.16098513147295745, 
                    -0.3372619407100647 
)
)

