model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.115249, 1);
tau[2,2] ~ dlnorm(-0.128781, 1);
tau[3,2] ~ dlnorm(-0.152434, 1);
tau[4,2] ~ dlnorm(-0.201475, 1);
tau[5,2] ~ dlnorm(-0.210377, 1);
tau[6,2] ~ dlnorm(-0.176586, 1);
tau[7,2] ~ dlnorm(-0.146106, 1);
tau[8,2] ~ dlnorm(-0.42019, 1);
tau[9,2] ~ dlnorm(-0.187132, 1);
tau[10,2] ~ dlnorm(-0.222641, 1);
tau[11,2] ~ dlnorm(-0.414816, 1);
tau[12,2] ~ dlnorm(-0.351808, 1);
tau[13,2] ~ dlnorm(-0.540365, 1);
tau[14,2] ~ dlnorm(-0.493041, 1);
tau[15,2] ~ dlnorm(-0.654678, 1);
tau[16,2] ~ dlnorm(-0.641152, 1);
tau[17,2] ~ dlnorm(-0.506653, 1);
tau[18,2] ~ dlnorm(-0.701241, 1);
tau[19,2] ~ dlnorm(-0.224844, 1);
tau[20,2] ~ dlnorm(-0.4113, 1);
tau[21,2] ~ dlnorm(-0.378179, 1);
tau[22,2] ~ dlnorm(-0.217645, 1);
tau[23,2] ~ dlnorm(-0.244539, 1);
tau[24,2] ~ dlnorm(-0.365031, 1);
tau[25,2] ~ dlnorm(-0.258616, 1);
tau[26,2] ~ dlnorm(-0.092128, 1);
tau[27,2] ~ dlnorm(-0.229693, 1);
tau[28,2] ~ dlnorm(-0.168691, 1);
tau[29,2] ~ dlnorm(-0.180324, 1);
tau[30,2] ~ dlnorm(-0.213523, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.4548949778740996, 
                    -1.4109155861246432, 
                    -1.3354528042090468, 
                    -1.184563763514163, 
                    -1.1579584726007794, 
                    -1.260217633541282, 
                    -1.3554653009298372, 
                    -0.5948352248662736, 
                    -1.2279318820533345, 
                    -1.1216925880984239, 
                    -0.6078334917790089, 
                    -0.7655572201578603, 
                    -0.321689448801239, 
                    -0.425353604310445, 
                    -0.09062572058175306, 
                    -0.11660864856017164, 
                    -0.3950319781401901, 
                    0.0038203842964067425, 
                    1.1152260672779064, 
                    0.6163757765077469, 
                    0.698334567374647, 
                    1.1364121070869373, 
                    1.0580316925122688, 
                    0.731627673646013, 
                    1.0178389197536737, 
                    1.5314373899550402, 
                    1.1010388328104816, 
                    1.2846107349442735, 
                    1.2487339176570114, 
                    1.1486126641100225 ),
tau=matrix(c( NA,1.4692478450654707, 
                    NA,1.4495010981699648, 
                    NA,1.415618309089862, 
                    NA,1.3478691298178593, 
                    NA,1.33592335419775, 
                    NA,1.3818377174600358, 
                    NA,1.424603920117497, 
                    NA,1.0830810159649569, 
                    NA,1.3673414150419472, 
                    NA,1.3196399720561924, 
                    NA,1.088917237808775, 
                    NA,1.1597351918508794, 
                    NA,0.9604385625117564, 
                    NA,1.00698376833539, 
                    NA,0.8566909485412071, 
                    NA,0.8683572832035171, 
                    NA,0.9933693581849454, 
                    NA,0.8177153525490868, 
                    NA,1.31673650420778, 
                    NA,1.0927527236519783, 
                    NA,1.1295522207512165, 
                    NA,1.326249036082035, 
                    NA,1.2910562299380088, 
                    NA,1.14450082546706, 
                    NA,1.2730096749693995, 
                    NA,1.503615388089813, 
                    NA,1.3103664359319063, 
                    NA,1.3927902199899789, 
                    NA,1.3766815290279981, 
                    NA,1.3317270861854 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 -0.31286398373342744, 
                    0.2316027325711542, 
                    0.2216390283825071, 
                    0.22617955755261993, 
                    -0.3331915309073163, 
                    -0.1398926143415819, 
                    0.026460742067707876, 
                    0.12637153697046533, 
                    0.1805975711559688, 
                    -0.03258437678540366, 
                    0.0205696829422351, 
                    0.13112423796397155, 
                    0.06553261336836275, 
                    0.06872147722964211, 
                    0.2455249560400537, 
                    0.1859534664944052, 
                    -0.2319213865485896, 
                    0.012006888716082298, 
                    0.17506904477875923, 
                    -0.19029959078133624, 
                    -0.13170773908869696, 
                    -0.06688980640445014, 
                    -0.17325773837193872, 
                    -0.15780902442973188, 
                    -0.21750435548357366, 
                    -0.08099938228156467, 
                    -0.053430907546270445, 
                    0.15161275306915617, 
                    0.048016910392483736, 
                    0.13360582249699487, 
                    0.029403963376625097, 
                    -0.029930199965096382, 
                    0.12286542216788138, 
                    -0.05279719761885132, 
                    0.06164335653797631, 
                    0.18282578910304365, 
                    0.02952208895152164, 
                    0.07479436295271208, 
                    0.05372995832766769, 
                    0.04204435909797588, 
                    0.027495807617866797, 
                    0.13294767765878657, 
                    0.18379112693905536, 
                    0.06439540914691799, 
                    0.06033736828963926, 
                    -0.283676798517804, 
                    0.17824527722957945, 
                    -0.31991986607240547, 
                    -0.08607427424049963, 
                    -0.03380205921213425, 
                    0.057996132769968234, 
                    -0.16181857564485175, 
                    0.21670406958706018, 
                    0.14469422456321385, 
                    -0.05471884629099222, 
                    -0.2763716685407846, 
                    -0.07723895703932038, 
                    -0.1679142323678601, 
                    -0.2970072274285377, 
                    0.0894718679368332, 
                    0.18031123926463827, 
                    0.20693447020160233, 
                    -0.17119460070339193, 
                    0.08160540281733664, 
                    0.09783401522917151, 
                    0.07175207806913564, 
                    0.21612872306708425, 
                    0.2078610431608518, 
                    0.05280708613355384, 
                    0.13666559666776623, 
                    0.1619696880011256, 
                    -0.10285773777946977, 
                    -0.030322066866190822, 
                    -0.060819504914577216, 
                    0.195372914340945, 
                    0.08544441451067397, 
                    -0.30109889976191917, 
                    -0.062169770245165235, 
                    0.18610566061121397, 
                    -0.276100731126724, 
                    -0.135978581627251, 
                    0.12890316304658267, 
                    -0.03602916854762833, 
                    -0.033979078136236573, 
                    0.14264362095487426, 
                    0.15096637320386047, 
                    -0.030259736816191762, 
                    -0.09694573471123974, 
                    0.21262411951863397, 
                    0.18016571747383586, 
                    0.01349813263896682, 
                    0.2108764373029542, 
                    0.0569031697470721, 
                    -0.08653390728078036, 
                    0.09213359555639827, 
                    0.21850480226933383, 
                    -0.24871283788267767, 
                    0.008279028594089577, 
                    -0.0025662763310820846, 
                    -0.12213980870695812, 
                    -0.005707784345839961, 
                    -0.2380416386975992, 
                    0.042311883575609666, 
                    -0.19277153967145388, 
                    0.11000515286137696, 
                    -0.16649325788872027, 
                    -0.1421243190714775, 
                    0.07214364305990906, 
                    -0.3444020297531633, 
                    0.01258791909356377, 
                    0.04260852360514089, 
                    -0.23535070093664387, 
                    0.08922827274450096, 
                    -0.08769096803916099, 
                    -0.11651517602360928, 
                    0.07602428228730101, 
                    0.14174750322424562, 
                    -0.34895703605011297, 
                    -0.09146170679543403, 
                    -0.1681023793849262, 
                    0.17312622982899722, 
                    -0.3173007898391385, 
                    -0.17971652601058302, 
                    -0.07466763543252941, 
                    0.21236001816968858, 
                    0.08673887103117406, 
                    0.17677236371314992, 
                    0.08535558983608799, 
                    -0.234324229306496, 
                    -0.20461586421929115, 
                    0.14166290409217824, 
                    -0.11294162763526874, 
                    -0.32635081586533277, 
                    0.18675543339643125, 
                    0.018011490658157103, 
                    -0.15730477005538623, 
                    0.23956402565316798, 
                    0.004577420335681537, 
                    -0.35239766362923, 
                    0.06918398111812912, 
                    0.21207616338508944, 
                    -0.2944671232224716, 
                    0.0778806048951785, 
                    0.04066377999237386, 
                    0.25127982679585475, 
                    0.12156481437900768, 
                    0.23956402565316798, 
                    -0.2631772905395682, 
                    0.17818425326620296, 
                    -0.017719555537718312, 
                    -0.21252425689477453, 
                    0.1026324340146667, 
                    -0.24181595823060886, 
                    -0.10413610767815223, 
                    -0.10503584253425052, 
                    0.18387905808364918, 
                    0.11647806917746956, 
                    0.02997666544988109, 
                    -0.12085814835994199, 
                    -0.24035047232852103, 
                    -0.10319198600148155, 
                    0.05143031955242522, 
                    -0.03400220334440629, 
                    0.09013097298037143, 
                    -0.35714744494960626, 
                    0.05333778075316142, 
                    0.15479176378246023, 
                    -0.21966430891240712, 
                    0.07012462063713387, 
                    -0.23588075575268666, 
                    0.15237828518381774, 
                    -0.07472682251753515, 
                    -0.32895977201694376, 
                    0.0991643915868497, 
                    0.118175301253295, 
                    0.22198363141014715, 
                    0.19379078583850579, 
                    -0.29150263321467484, 
                    -0.2925343422929898, 
                    -0.18500974166463408, 
                    0.07959148739499222, 
                    -0.12585655131872184, 
                    0.034204852201166036, 
                    -0.024515266937723046, 
                    -0.2840646049171106, 
                    0.013779691883387568, 
                    0.08909583675539073, 
                    -0.12861525483936068, 
                    -0.17243371328827298, 
                    0.2008874934811578, 
                    -0.29024574266352754, 
                    0.15089839394293586, 
                    0.16857605309596085, 
                    0.12287170009742165, 
                    0.01912191288157511, 
                    0.03614631625709536, 
                    -0.035276578399709435, 
                    0.11025454976140087, 
                    0.15079612069446285, 
                    -0.20073866368715948, 
                    -0.1489463290700644, 
                    0.2178881153932964, 
                    0.0023430341694198886, 
                    0.20428551533691125, 
                    0.15145674623702549, 
                    0.044992242755170886, 
                    -0.3014812272404853, 
                    -0.11160970641290244, 
                    0.1452485014572426, 
                    -0.09900552821653835, 
                    -0.3131455558570822, 
                    0.25127982679585475, 
                    0.17818425326620296, 
                    0.093008838069218, 
                    -0.015180127119244213, 
                    0.2061999701108979, 
                    -0.18086955221566736, 
                    -0.3315555523451779, 
                    0.179642998125143, 
                    0.015398789206260699, 
                    -0.22732665176197475, 
                    -0.15428902006725229, 
                    -0.17735094203873414, 
                    0.1763886221677377, 
                    0.23514814446099946, 
                    -0.009658509078064814, 
                    0.1283577980431766, 
                    0.24332853499637558, 
                    0.16795724439860887, 
                    -0.24976160619607718, 
                    -0.0010425219140232644, 
                    0.03741751050535236, 
                    -0.3014812272404853, 
                    -0.018642597403352612, 
                    -0.25717661690452576, 
                    0.16209605429011614, 
                    0.0781447054066366, 
                    0.06484672797303692, 
                    0.11374456751676365, 
                    0.09227194910138875, 
                    0.21667190673293607, 
                    0.20788124382287781, 
                    0.08140629677534905, 
                    0.21670406958706018, 
                    -0.21173212593689553, 
                    0.25127982679585475, 
                    -0.2711348584397148, 
                    -0.19486947589425963, 
                    -0.04971731727958428, 
                    -0.32230163937198786, 
                    0.023754973752364572, 
                    0.15996237814793396, 
                    -0.25305018028092996, 
                    0.18306764399950454, 
                    0.07270865085276529, 
                    0.07426417208433478, 
                    0.05291659040660501, 
                    -0.02119988309718218, 
                    0.14508678168623307, 
                    0.022348886241485844, 
                    0.11225647257631222, 
                    0.0916482590329788, 
                    0.16835657008728439, 
                    -0.27056961439355, 
                    0.045779157012330596, 
                    0.09278840163324964, 
                    -0.13548698728322892, 
                    0.028342027192120922, 
                    -0.11544187877883516, 
                    0.15360744856737735, 
                    0.08585665179304969, 
                    -0.21038578022531573, 
                    0.04872888971186462, 
                    0.03941852362791287, 
                    0.18824206179488528, 
                    0.026689212840872334, 
                    -0.0764836351966765, 
                    0.09739237175159904, 
                    0.22642586101945544, 
                    -0.2308385421548491, 
                    -0.03496043405322086, 
                    0.07135373360625497, 
                    -0.03447364966588151, 
                    0.14355388433974053, 
                    -0.08344109056650972, 
                    0.12496085927178169, 
                    -0.2989963037990331, 
                    0.19740373948126094, 
                    0.21880287191768594, 
                    -0.024940498194699956, 
                    -0.04907974556574718, 
                    -0.024696764869370946, 
                    -0.14830525238734454, 
                    -0.17915765970812392, 
                    -0.257573538270864, 
                    0.03589832199208448, 
                    -0.043761932322123664, 
                    -0.077494957909026, 
                    -0.2832192502716022, 
                    -0.06624325976152207, 
                    0.0709358579923759, 
                    0.18907910334636763, 
                    0.24037605263539658, 
                    -0.07591422239105217, 
                    0.07527025945068855, 
                    -0.28533673251157765, 
                    -0.013414294052646158, 
                    0.0020672236636355423, 
                    -0.02025341767989458, 
                    0.06212846121861948, 
                    -0.23400490918494501, 
                    0.01154219927971456, 
                    0.05796099621787115, 
                    0.18444823967729446, 
                    0.2019245273525188, 
                    0.04714498698118791, 
                    0.1431214992084035, 
                    0.09403112929987917, 
                    -0.060618627498328026, 
                    -0.3147287672960131, 
                    0.04212630315734506, 
                    -0.3055957784481823, 
                    0.19566176471678348, 
                    -0.022275631611418323, 
                    -0.25001878442120096, 
                    -0.0791729995754244, 
                    0.2057879619599749, 
                    -0.1537626802294098, 
                    -0.32858231832654444, 
                    0.005632091645317028, 
                    0.2316027325711542, 
                    -0.11625802532863605, 
                    0.0210636415554602, 
                    0.21179359236524725, 
                    -0.024226726089630612, 
                    -0.18452342510925868, 
                    0.03334558283583833, 
                    -0.07529377560887007, 
                    -0.127106720802904, 
                    0.14878410127524327, 
                    0.20993948608576146, 
                    -0.306712070237864, 
                    0.1806329865971515, 
                    -0.04722190215874844, 
                    -0.07709008804714684, 
                    -0.020189497573355475, 
                    0.22078481844709613, 
                    0.22607663391418614, 
                    0.22339342238833465, 
                    0.20990997731384137, 
                    0.15695742528608753, 
                    0.2198087921979061, 
                    -0.07317640732027325, 
                    -0.2641390642565101, 
                    0.17269368417911551, 
                    0.12460662129405453, 
                    0.0794472187075419, 
                    -0.05178162687410487, 
                    -0.288779789464498, 
                    -0.07029614032049702, 
                    0.22908306075890256, 
                    -0.13580672014512277, 
                    0.20622163092149098, 
                    -0.12517649246658435, 
                    -0.2825314625505286, 
                    0.01843505722029587, 
                    -0.12280013634168485, 
                    0.08860446270875527, 
                    -0.030292672623471906, 
                    -0.005202914550056448, 
                    -0.06745657681546618, 
                    -0.1683952502060138, 
                    0.2316029520222837, 
                    0.2147028039310152, 
                    0.17557645407868855, 
                    -0.03173768411286215, 
                    0.03453739577873827, 
                    0.10897973424334839, 
                    0.163001649502797, 
                    -0.17427751418181228, 
                    -0.21782704804689837, 
                    0.20199413984238407, 
                    -0.3309966703932425, 
                    -0.01620064596849441, 
                    0.16760677271195917, 
                    -0.15720875884724633, 
                    0.18230279452580572, 
                    0.17382939663537184, 
                    -0.3402964411545769, 
                    0.08611574547486223, 
                    -0.2830445417251149, 
                    -0.3031607263198088, 
                    0.10259188243592293, 
                    0.22617955755261993, 
                    -0.02219529725061814, 
                    0.07038998585922457, 
                    0.10694284101564522, 
                    0.1763886221677377, 
                    -0.10221257742325518, 
                    0.1479789125547582, 
                    0.020468714379976827, 
                    0.1899333132817787, 
                    0.15902468912900164, 
                    0.19637423791903902, 
                    -0.2992288128618821, 
                    -0.13448749130513968, 
                    -0.1275618479664617, 
                    0.032830520486861525, 
                    0.23729464684459406, 
                    0.00728643062014106, 
                    -0.10871109163611403, 
                    -0.19950423715129925, 
                    0.17953571961002662, 
                    -0.07724329208348585, 
                    0.179060714946168, 
                    0.027103423147645633, 
                    0.11357199810666885, 
                    -0.020748968771604093, 
                    -0.08675470909723498, 
                    0.01250669693373374, 
                    -0.15427580295024743, 
                    0.12050824278531808, 
                    0.1792462591257467, 
                    0.08823334168708102, 
                    0.11910854075162197, 
                    0.03811615253316064, 
                    -0.16565677003050636, 
                    0.22393084076980668, 
                    0.10128483835413343, 
                    0.2316027325711542, 
                    0.1193377411792847, 
                    0.23014373188180365, 
                    -0.07208778523122678, 
                    0.07322388199637142, 
                    -0.20610941991948725, 
                    0.22882034151599911, 
                    0.07185466939722795, 
                    0.12905630262816514, 
                    -0.0760312853283952, 
                    0.11295054865399168, 
                    -0.2255160954096476, 
                    0.0414512872630477, 
                    -0.13694276172095818, 
                    0.05796099621787115, 
                    0.17082243124126223, 
                    0.14219947146479683, 
                    0.057105909522084886, 
                    -0.2800196180382935, 
                    0.21232683644006917, 
                    0.13738169269575184, 
                    0.1677585472485102, 
                    -0.040673532845206806, 
                    -0.013029119162728475, 
                    -0.0889712200298573, 
                    -0.11659647731163922, 
                    0.22254581567191928, 
                    0.11983676090460016, 
                    -0.1253692942281753, 
                    -0.28286816190521613, 
                    -0.006078007375033723, 
                    0.021985515853784166, 
                    0.014952563671750796, 
                    -0.03276039546024323, 
                    -0.07286240152423457, 
                    -0.038006229521862, 
                    0.25127982679585475, 
                    -0.034404177918044176, 
                    0.1875924017171245, 
                    0.17137738173064326, 
                    0.01846707161101918, 
                    0.12407924810875054, 
                    0.10973456849732166, 
                    0.0983642735736725, 
                    0.029567129047128327, 
                    0.13499063455845184, 
                    -0.05728114644822785, 
                    0.1208377397211865, 
                    -0.32886752929128515, 
                    -0.24338925613639778, 
                    0.12655555024663628, 
                    -0.02698357902298959, 
                    -0.30233409927548516, 
                    0.03849243675628533, 
                    -0.33513127515929164, 
                    0.16013451556492792, 
                    0.05881210333144127, 
                    0.19931820414234575, 
                    0.06398208209663203, 
                    0.20893210247007604, 
                    0.16304839300216828, 
                    0.17030825878176364, 
                    0.105062562112198, 
                    -0.052024677775657946, 
                    0.06989971128224476, 
                    -0.05046521762335271, 
                    -0.2010540033987975, 
                    0.1783500242979547, 
                    -0.2282222036820316, 
                    -0.27267342825443197, 
                    -0.004400189345183214 
)
)

