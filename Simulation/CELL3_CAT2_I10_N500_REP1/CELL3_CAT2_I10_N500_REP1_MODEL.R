model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.189375, 1);
tau[2,2] ~ dlnorm(-0.208045, 1);
tau[3,2] ~ dlnorm(-0.188009, 1);
tau[4,2] ~ dlnorm(-0.451706, 1);
tau[5,2] ~ dlnorm(-0.57622, 1);
tau[6,2] ~ dlnorm(-0.518983, 1);
tau[7,2] ~ dlnorm(-0.285664, 1);
tau[8,2] ~ dlnorm(-0.375406, 1);
tau[9,2] ~ dlnorm(-0.148958, 1);
tau[10,2] ~ dlnorm(-0.172304, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 10 , byrow=TRUE)

N <- 500 

J <- 10 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -1.2211073030458652, 
                    -1.1649047897072853, 
                    -1.2252616606339033, 
                    -0.5199986009259178, 
                    -0.246353240628768, 
                    -0.36791918309665417, 
                    0.9421814003112892, 
                    0.7053186045894038, 
                    1.3464307131235052, 
                    1.2734225017254437 ),
tau=matrix(c( NA,1.3642771790675936, 
                    NA,1.3390422505785713, 
                    NA,1.3661424856246227, 
                    NA,1.0494793718157371, 
                    NA,0.9266126050423169, 
                    NA,0.9811957132103979, 
                    NA,1.239039448739769, 
                    NA,1.1326880534606423, 
                    NA,1.420547390192454, 
                    NA,1.3877667032747243 ), ncol= 2 , nrow= 10 , byrow=TRUE),
theta = c(
 0.21794420403566478, 
                    0.1057381270160177, 
                    0.1620989942219056, 
                    0.02891776079131736, 
                    0.1889256137441377, 
                    0.27065440439006355, 
                    0.04252246456025993, 
                    0.23618722805547482, 
                    -0.19867979619035853, 
                    -0.20582225444398994, 
                    -0.32648352102044664, 
                    -0.07438901491708139, 
                    0.27065440439006355, 
                    -0.15508118722635675, 
                    0.14255289705782342, 
                    -0.24203332984767797, 
                    -0.08133975402543131, 
                    -0.10413055489323919, 
                    -0.260276353867488, 
                    -0.188724538137047, 
                    0.27065440439006355, 
                    -0.21933665250668666, 
                    -0.14184303186583339, 
                    0.1057381270160177, 
                    0.028782614646946814, 
                    0.23618722805547482, 
                    0.01415150231875778, 
                    0.00918861614412958, 
                    0.15617003745938535, 
                    -0.06009480703639691, 
                    -0.19867979619035853, 
                    0.1620989942219056, 
                    0.013932851919387423, 
                    0.23618722805547482, 
                    0.11662582121205073, 
                    -0.21226413286980106, 
                    -0.11820830879957808, 
                    0.1889256137441377, 
                    0.21899848162689234, 
                    0.11662582121205073, 
                    0.08177874523037781, 
                    -0.12120072787900052, 
                    -0.19867979619035853, 
                    -0.06321716888854023, 
                    -0.09178951534777918, 
                    0.27065440439006355, 
                    -0.09904529048750507, 
                    0.11175860711884661, 
                    0.07942383200975817, 
                    -0.32648352102044664, 
                    0.13275581401697012, 
                    -0.25932539232832774, 
                    0.1889256137441377, 
                    0.03301750094593098, 
                    0.19843057735846664, 
                    -0.07438901491708139, 
                    0.19843057735846664, 
                    0.07942383200975817, 
                    0.028782614646946814, 
                    -0.23927360705159, 
                    0.23618722805547482, 
                    0.05164221705091082, 
                    0.27065440439006355, 
                    -0.056038795292060184, 
                    0.08277699150568135, 
                    0.12800348484306917, 
                    0.22808283189094897, 
                    -0.19903958392892016, 
                    -0.32924742232869453, 
                    -0.056038795292060184, 
                    -0.05580799764828026, 
                    -0.011061440285818125, 
                    -0.20959455887690354, 
                    -0.11806366052393832, 
                    0.15617003745938535, 
                    0.10928853118817167, 
                    0.23618722805547482, 
                    -0.0591611571442035, 
                    -0.259406159290068, 
                    0.037699803998628656, 
                    0.1889256137441377, 
                    0.07942383200975817, 
                    0.08177874523037781, 
                    -0.32924742232869453, 
                    0.17847180471334972, 
                    -0.259406159290068, 
                    -0.2668419355520854, 
                    -0.14184303186583339, 
                    -0.07061671048416779, 
                    0.1889256137441377, 
                    0.14861897694530224, 
                    -0.2603232501513708, 
                    0.15617003745938535, 
                    -0.2636365973945147, 
                    0.07942383200975817, 
                    -0.32648352102044664, 
                    -0.13040682338780044, 
                    -0.32372114354869946, 
                    -0.05507327572159432, 
                    -0.05482033703844319, 
                    -0.19566003702178816, 
                    -0.11820830879957808, 
                    0.21794420403566478, 
                    -0.31457425474429274, 
                    -0.32372114354869946, 
                    0.11175860711884661, 
                    0.21794420403566478, 
                    -0.056038795292060184, 
                    -0.06009480703639691, 
                    -0.32924742232869453, 
                    -0.2518561727068151, 
                    -0.26578927833751426, 
                    -0.021593318189337907, 
                    0.19843057735846664, 
                    0.005138389449422354, 
                    -0.32372114354869946, 
                    0.11662582121205073, 
                    -0.1510667219878868, 
                    0.1935183969027266, 
                    0.18790238064133719, 
                    0.14484667251238864, 
                    -0.0591611571442035, 
                    -0.20608190179324232, 
                    -0.1952927497063482, 
                    0.09858718922378906, 
                    -0.259406159290068, 
                    -0.032737596944166225, 
                    0.10598250099178463, 
                    0.08277699150568135, 
                    0.0650180269775168, 
                    0.15617003745938535, 
                    -0.041743116821791326, 
                    -0.21753554663188124, 
                    -0.32924742232869453, 
                    0.11468397512362144, 
                    -0.2603232501513708, 
                    0.23618722805547482, 
                    0.010974824901567426, 
                    -0.32372114354869946, 
                    -0.1277132724139071, 
                    0.23618722805547482, 
                    0.1712036238943349, 
                    -0.14184303186583339, 
                    -0.1421603759323061, 
                    0.010974824901567426, 
                    0.21794420403566478, 
                    -0.04075887373230597, 
                    0.1889256137441377, 
                    -0.14184303186583339, 
                    0.013932851919387423, 
                    -0.07412936756782901, 
                    0.01415150231875778, 
                    -0.14184303186583339, 
                    -0.0591611571442035, 
                    -0.0591611571442035, 
                    0.14255289705782342, 
                    0.1889256137441377, 
                    -0.1832487308807945, 
                    -0.1151719312899053, 
                    0.15688412197918689, 
                    0.23618722805547482, 
                    0.1889256137441377, 
                    -0.030276599794186898, 
                    -0.11735819043699727, 
                    -0.25932539232832774, 
                    -0.32372114354869946, 
                    -0.02874704201948025, 
                    0.10852142504752488, 
                    0.21899848162689234, 
                    0.026707419831322188, 
                    -0.1277132724139071, 
                    0.27065440439006355, 
                    0.27065440439006355, 
                    -0.0363476728863415, 
                    0.27065440439006355, 
                    -0.13853700166944635, 
                    -0.12403558330308398, 
                    0.005138389449422354, 
                    -0.06009480703639691, 
                    0.23618722805547482, 
                    -0.188724538137047, 
                    0.028454487733552136, 
                    0.08634175844275666, 
                    0.1182343792957754, 
                    0.08177874523037781, 
                    0.23618722805547482, 
                    0.11662582121205073, 
                    -0.1912779770606245, 
                    -0.06321716888854023, 
                    -0.04886378551706555, 
                    -0.2386836375868252, 
                    -0.14184303186583339, 
                    -0.32372114354869946, 
                    -0.07438901491708139, 
                    0.23618722805547482, 
                    0.03795945134788109, 
                    0.27065440439006355, 
                    0.1712036238943349, 
                    0.03275785359667854, 
                    0.21794420403566478, 
                    -0.19867979619035853, 
                    -0.20608190179324232, 
                    0.1182343792957754, 
                    0.21794420403566478, 
                    -0.1947906341442857, 
                    -0.05454337986590735, 
                    0.00918861614412958, 
                    -0.0363476728863415, 
                    0.14510631986164102, 
                    0.27065440439006355, 
                    0.00918861614412958, 
                    0.1889256137441377, 
                    -0.1952927497063482, 
                    -0.09893503327948236, 
                    0.23618722805547482, 
                    0.12800348484306917, 
                    0.08634175844275666, 
                    0.15688412197918689, 
                    0.1620989942219056, 
                    -0.20608190179324232, 
                    -0.2636365973945147, 
                    0.18790238064133719, 
                    -0.10323839914260882, 
                    -0.06321716888854023, 
                    0.15617003745938535, 
                    0.21794420403566478, 
                    0.07965462965353803, 
                    0.17092666672179907, 
                    0.10598250099178463, 
                    0.1889256137441377, 
                    -0.1912779770606245, 
                    0.07965462965353803, 
                    -0.07412936756782901, 
                    -0.20959455887690354, 
                    0.14510631986164102, 
                    0.0365301580295922, 
                    0.15617003745938535, 
                    -0.02816427530439003, 
                    -0.04099892032347108, 
                    0.27065440439006355, 
                    0.040473348558649924, 
                    0.1620989942219056, 
                    -0.19903958392892016, 
                    0.22808283189094897, 
                    -0.32648352102044664, 
                    0.0023358281307067075, 
                    -0.04099892032347108, 
                    0.27065440439006355, 
                    0.19843057735846664, 
                    0.27065440439006355, 
                    0.04994691120661715, 
                    0.07965462965353803, 
                    -0.08503585187734106, 
                    0.11175860711884661, 
                    0.07363207529329285, 
                    0.1620989942219056, 
                    0.013932851919387423, 
                    -0.14184303186583339, 
                    -0.2386836375868252, 
                    0.028782614646946814, 
                    -0.32372114354869946, 
                    0.013932851919387423, 
                    0.1889256137441377, 
                    -0.25932539232832774, 
                    0.0048940154736553665, 
                    0.09127329704500703, 
                    -0.30970132516461235, 
                    -0.07412936756782901, 
                    0.08634175844275666, 
                    -0.24391644327671444, 
                    -0.037692890127084044, 
                    -0.06321716888854023, 
                    -0.32372114354869946, 
                    0.23618722805547482, 
                    -0.0591611571442035, 
                    0.07942383200975817, 
                    -0.12120072787900052, 
                    -0.1762215010341243, 
                    0.11662582121205073, 
                    -0.19501579253381232, 
                    0.23618722805547482, 
                    0.1889256137441377, 
                    0.1889256137441377, 
                    0.15617003745938535, 
                    0.07965462965353803, 
                    0.11662582121205073, 
                    -0.32372114354869946, 
                    0.013932851919387423, 
                    0.1889256137441377, 
                    0.11492834909938837, 
                    -0.08869412175924338, 
                    -0.26578927833751426, 
                    0.11662582121205073, 
                    0.23618722805547482, 
                    0.005138389449422354, 
                    -0.17922493948568663, 
                    -0.06321716888854023, 
                    0.10365421095432081, 
                    0.22808283189094897, 
                    0.0650180269775168, 
                    0.27065440439006355, 
                    0.27065440439006355, 
                    0.11662582121205073, 
                    0.10598250099178463, 
                    0.14510631986164102, 
                    0.0048940154736553665, 
                    -0.18027751277846102, 
                    0.03514685386472305, 
                    -0.06321716888854023, 
                    0.18790238064133719, 
                    0.21899848162689234, 
                    -0.13829262769367942, 
                    0.27065440439006355, 
                    0.0023358281307067075, 
                    -0.19867979619035853, 
                    -0.24862483339527358, 
                    0.15617003745938535, 
                    0.27065440439006355, 
                    -0.017454797823142076, 
                    0.1889256137441377, 
                    0.03795945134788109, 
                    0.08634175844275666, 
                    0.11175860711884661, 
                    -0.11735819043699727, 
                    0.0048940154736553665, 
                    -0.19903958392892016, 
                    -0.05454337986590735, 
                    -0.2649660863764952, 
                    -0.22240276072508536, 
                    0.009432990119896567, 
                    -0.12120072787900052, 
                    -0.25932539232832774, 
                    0.1889256137441377, 
                    0.1712036238943349, 
                    0.1889256137441377, 
                    -0.32372114354869946, 
                    -0.0299798599664699, 
                    0.23618722805547482, 
                    0.009432990119896567, 
                    -0.12573800702142138, 
                    0.27065440439006355, 
                    -0.037636511880162704, 
                    0.1889256137441377, 
                    0.005138389449422354, 
                    -0.1421603759323061, 
                    0.009432990119896567, 
                    -0.32648352102044664, 
                    0.27065440439006355, 
                    0.21794420403566478, 
                    0.08177874523037781, 
                    0.005138389449422354, 
                    -0.19867979619035853, 
                    -0.12235826119441254, 
                    0.12676444906733492, 
                    0.18132774233989485, 
                    0.005138389449422354, 
                    -0.31358251569341516, 
                    -0.06321716888854023, 
                    0.10598250099178463, 
                    0.005138389449422354, 
                    -0.04781915582887519, 
                    0.1889256137441377, 
                    0.025419629541688027, 
                    -0.06321716888854023, 
                    -0.1611659907865175, 
                    0.07942383200975817, 
                    0.0023358281307067075, 
                    -0.20959455887690354, 
                    -0.21933665250668666, 
                    0.00918861614412958, 
                    -0.037692890127084044, 
                    -0.20959455887690354, 
                    0.03301750094593098, 
                    0.1889256137441377, 
                    -0.05580799764828026, 
                    0.11492834909938837, 
                    -0.1277132724139071, 
                    0.08177874523037781, 
                    -0.037692890127084044, 
                    -0.11735819043699727, 
                    -0.2386836375868252, 
                    0.14484667251238864, 
                    0.1057381270160177, 
                    0.15617003745938535, 
                    -0.20959455887690354, 
                    -0.2386836375868252, 
                    0.07942383200975817, 
                    0.27065440439006355, 
                    0.14861897694530224, 
                    0.03301750094593098, 
                    0.27065440439006355, 
                    -0.2636365973945147, 
                    -0.30970132516461235, 
                    -0.10701070357552242, 
                    0.00918861614412958, 
                    0.23618722805547482, 
                    -0.07438901491708139, 
                    -0.10480477065995958, 
                    0.23618722805547482, 
                    0.08634175844275666, 
                    0.028194840384299702, 
                    0.08725883180653704, 
                    -0.14184303186583339, 
                    -0.26578927833751426, 
                    -0.19867979619035853, 
                    -0.06321716888854023, 
                    0.005138389449422354, 
                    0.21794420403566478, 
                    0.23618722805547482, 
                    -0.2386836375868252, 
                    -0.1084251555637134, 
                    -0.13853700166944635, 
                    0.11175860711884661, 
                    0.27065440439006355, 
                    0.21899848162689234, 
                    0.00918861614412958, 
                    -0.14184303186583339, 
                    0.15617003745938535, 
                    0.08725883180653704, 
                    -0.14184303186583339, 
                    -0.09904529048750507, 
                    -0.32372114354869946, 
                    0.11662582121205073, 
                    -0.14184303186583339, 
                    0.028782614646946814, 
                    -0.07412936756782901, 
                    0.23618722805547482, 
                    -0.259406159290068, 
                    0.0709965543063979, 
                    0.21899848162689234, 
                    0.1889256137441377, 
                    0.08177874523037781, 
                    -0.32372114354869946, 
                    -0.05482033703844319, 
                    -0.06321716888854023, 
                    -0.14184303186583339, 
                    0.27065440439006355, 
                    0.21794420403566478, 
                    0.06988524107072086, 
                    -0.06321716888854023, 
                    -0.1947906341442857, 
                    0.1935183969027266, 
                    -0.11735819043699727, 
                    -0.101560917179773, 
                    0.08634175844275666, 
                    0.14510631986164102, 
                    0.028194840384299702, 
                    0.11175860711884661, 
                    0.00918861614412958, 
                    -0.14184303186583339, 
                    -0.1034980464918612, 
                    0.27065440439006355, 
                    0.14255289705782342, 
                    -0.2386836375868252, 
                    0.10598250099178463, 
                    -0.044681709183159, 
                    -0.07438901491708139, 
                    0.15617003745938535, 
                    0.19843057735846664, 
                    0.21794420403566478, 
                    -0.259406159290068, 
                    -0.044404752010623105, 
                    0.15688412197918689, 
                    -0.032053072215867284, 
                    0.23618722805547482, 
                    -0.20959455887690354, 
                    0.037699803998628656, 
                    0.21794420403566478, 
                    -0.12235826119441254, 
                    -0.14184303186583339, 
                    0.27065440439006355, 
                    0.09883156319955605, 
                    -0.10343813528923856, 
                    -0.32372114354869946, 
                    -0.07412936756782901, 
                    -0.2603232501513708, 
                    0.15617003745938535, 
                    -0.2386836375868252, 
                    -0.26578927833751426, 
                    -0.259406159290068, 
                    0.07942383200975817, 
                    0.1889256137441377, 
                    0.27065440439006355, 
                    -0.07438901491708139, 
                    -0.16936326880293823, 
                    -0.053686446078696715, 
                    -0.07412936756782901, 
                    0.21794420403566478, 
                    0.27065440439006355, 
                    -0.26578927833751426, 
                    0.09883156319955605, 
                    -0.1084251555637134, 
                    0.23618722805547482, 
                    0.11662582121205073, 
                    0.15617003745938535, 
                    0.07942383200975817, 
                    -0.011802572630300545, 
                    -0.27058876977465735, 
                    0.15617003745938535, 
                    -0.27058876977465735 
)
)

