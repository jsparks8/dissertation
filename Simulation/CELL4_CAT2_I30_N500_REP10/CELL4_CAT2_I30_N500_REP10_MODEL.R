model <- " model {

# specify prior distributions

for (j in 1:J) {

b[j] ~ dnorm(0,0.25);

a[j] ~ dnorm(0,4);

tau[j,1] <- 0;

}

tau[1,2] ~ dlnorm(-0.342696, 1);
tau[2,2] ~ dlnorm(-0.150482, 1);
tau[3,2] ~ dlnorm(-0.195147, 1);
tau[4,2] ~ dlnorm(-0.219493, 1);
tau[5,2] ~ dlnorm(-0.316, 1);
tau[6,2] ~ dlnorm(-0.197905, 1);
tau[7,2] ~ dlnorm(-0.149757, 1);
tau[8,2] ~ dlnorm(-0.213068, 1);
tau[9,2] ~ dlnorm(-0.135502, 1);
tau[10,2] ~ dlnorm(-0.241257, 1);
tau[11,2] ~ dlnorm(-0.186196, 1);
tau[12,2] ~ dlnorm(-0.402444, 1);
tau[13,2] ~ dlnorm(-0.507332, 1);
tau[14,2] ~ dlnorm(-0.523136, 1);
tau[15,2] ~ dlnorm(-0.531746, 1);
tau[16,2] ~ dlnorm(-0.461168, 1);
tau[17,2] ~ dlnorm(-0.646889, 1);
tau[18,2] ~ dlnorm(-0.510834, 1);
tau[19,2] ~ dlnorm(-0.334382, 1);
tau[20,2] ~ dlnorm(-0.26901, 1);
tau[21,2] ~ dlnorm(-0.316912, 1);
tau[22,2] ~ dlnorm(-0.259823, 1);
tau[23,2] ~ dlnorm(-0.404787, 1);
tau[24,2] ~ dlnorm(-0.256955, 1);
tau[25,2] ~ dlnorm(-0.267634, 1);
tau[26,2] ~ dlnorm(-0.17577, 1);
tau[27,2] ~ dlnorm(-0.102334, 1);
tau[28,2] ~ dlnorm(-0.225011, 1);
tau[29,2] ~ dlnorm(-0.112263, 1);
tau[30,2] ~ dlnorm(-0.187169, 1);

  #specify model
for (i in 1:N) {				
  theta[i] ~ dnorm(0,1);
  for (j in 1:J) {	
    for (z in 1:K){
      cp[i,j,z]<- exp(a[j]*((z-1)*(theta[i]-b[j] )+ sum(tau[j,1:z])))+ exp(a[j]*(((2*K)-z)*(theta[i]-b[j] )+ sum(tau[j,1:z])));
    }
    den[i,j] <- sum(cp[i,j,1:K]);
    for (z in 1:K){
      prob[i,j,z] <- cp[i,j,z]/den[i,j];	
    } 
    r[i,j] ~ dcat(prob[i,j,]);	
  }
}
}   "          
 
# specify parameters
# N is sample size
# J is number of items
# K is response categories
# D is number of dimensions
                                  
resp <- matrix(data, nrow= 500 , ncol= 30 , byrow=TRUE)

N <- 500 

J <- 30 

K <- 2 

data_list <- list("r" = resp, "N" = N, "J" = J, "K" = K)

# specify starting values for all estimated parameters

starts <-  list(a=
c( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 
),
b=c( -0.7892013969514063, 
                    -1.3416109467767137, 
                    -1.2036195642361829, 
                    -1.1309599944610185, 
                    -0.8597238630449116, 
                    -1.1953011961237632, 
                    -1.343902900498113, 
                    -1.1499639911009227, 
                    -1.3892886954520578, 
                    -1.0674864123203816, 
                    -1.2307812396179036, 
                    -0.6380240387817979, 
                    0.3935300830457398, 
                    -0.3588630823619782, 
                    -0.34020610123280437, 
                    -0.49798540315795814, 
                    -0.1055460849965544, 
                    -0.3857996012828648, 
                    0.8109618886208542, 
                    0.9885218176457268, 
                    0.8572841876481719, 
                    1.0144204421444676, 
                    0.6322781713832712, 
                    1.0225509837448041, 
                    0.9923866002356804, 
                    1.2627296361430949, 
                    1.4974311543591075, 
                    1.114734810501918, 
                    1.4646828399765979, 
                    1.2278192065561995 ),
tau=matrix(c( NA,1.1703514272311815, 
                    NA,1.4183833151027445, 
                    NA,1.3564251843420463, 
                    NA,1.3238010375129974, 
                    NA,1.2020160145071652, 
                    NA,1.3526902370595697, 
                    NA,1.4194124023236527, 
                    NA,1.3323338320043143, 
                    NA,1.439790624257974, 
                    NA,1.2953013991318514, 
                    NA,1.3686207765884388, 
                    NA,1.1024727934130274, 
                    NA,0.9926950072875371, 
                    NA,0.9771295239805282, 
                    NA,0.9687525394535292, 
                    NA,1.0395954460179233, 
                    NA,0.863390192163453, 
                    NA,0.9892240209760064, 
                    NA,1.1801218879907636, 
                    NA,1.2598462961229313, 
                    NA,1.2009206002540291, 
                    NA,1.271474778522866, 
                    NA,1.0998928989510888, 
                    NA,1.2751253917014171, 
                    NA,1.2615815835058206, 
                    NA,1.3829656066282496, 
                    NA,1.4883465883072393, 
                    NA,1.3165159299153613, 
                    NA,1.4736425951494925, 
                    NA,1.3672908237437338 ), ncol= 2 , nrow= 30 , byrow=TRUE),
theta = c(
 0.21597400013255053, 
                    0.24083266859573416, 
                    -0.02110845313300358, 
                    0.009314789226036124, 
                    -0.2013525951563684, 
                    -0.06771332715537715, 
                    0.1318108055345511, 
                    0.2503804449873682, 
                    -0.15833900032234335, 
                    -0.020319757834914687, 
                    -0.10886757138982867, 
                    -0.23598872554599498, 
                    0.07392417625537884, 
                    -0.06971996468819014, 
                    0.2681488170142776, 
                    -0.21096947480066897, 
                    -0.24656600318517286, 
                    -0.04685233278342249, 
                    0.1313347932649252, 
                    0.08258205527358353, 
                    -0.03550596945961049, 
                    0.08701489083414149, 
                    -0.02843067615266759, 
                    -0.10494167246398853, 
                    0.0249059819441807, 
                    -0.2886362179873746, 
                    0.22451497101957174, 
                    -0.13610798508822133, 
                    -0.04217918468057541, 
                    0.010366587404543659, 
                    -0.14732665162569447, 
                    -0.0027541097507923773, 
                    0.04085404966738804, 
                    0.19282995516649215, 
                    0.03485449998725676, 
                    -0.2761044691698805, 
                    0.18196851766458355, 
                    -0.24596329477108528, 
                    -0.24163528165907444, 
                    -0.21195766337376787, 
                    -0.16160873030198908, 
                    -0.09818454966142268, 
                    -0.039684267802253814, 
                    -0.09458195754387266, 
                    -0.16168053630128737, 
                    -0.32914113479100127, 
                    0.18286731979314108, 
                    -0.16063352498249123, 
                    -0.2239957953267789, 
                    0.05590789003794561, 
                    -0.14396101442037545, 
                    -0.009255939415247438, 
                    0.2681488170142776, 
                    0.12459865512240348, 
                    -0.12671437390403134, 
                    -0.15891082936101014, 
                    -0.28052534975633137, 
                    -0.3029340752365122, 
                    0.027573120086272163, 
                    0.22428240471131222, 
                    0.11944469575732947, 
                    0.24759630457591353, 
                    0.17663342657854564, 
                    -0.2976466889133876, 
                    0.1368540101801639, 
                    -0.06257077151382223, 
                    -0.03723269557957409, 
                    -0.22497610666370713, 
                    0.2107030639020162, 
                    0.028002602314551095, 
                    0.04371380623060156, 
                    -0.20812507246062023, 
                    -0.3009862922646825, 
                    0.1533861659751115, 
                    0.15550740766833393, 
                    0.16649906115487778, 
                    -0.08742042471995526, 
                    -0.05585749755318914, 
                    0.0547692208354329, 
                    0.2681488170142776, 
                    0.13828113331686726, 
                    -0.04606067055610402, 
                    -0.1422577248589878, 
                    0.10187062920231477, 
                    0.13888686444440873, 
                    0.16143312331035042, 
                    -0.018097339826317893, 
                    0.13269839992823063, 
                    -0.3097985930611324, 
                    -0.34104275909701437, 
                    0.061266728492624045, 
                    0.0639459989730542, 
                    -0.09846601235641447, 
                    0.24411813033323937, 
                    0.2562095335898762, 
                    0.19512368717979922, 
                    -0.29199951682682357, 
                    -0.2736622609971407, 
                    -0.04852073141372992, 
                    0.21037901565184092, 
                    0.2681488170142776, 
                    0.03957525640189241, 
                    0.07155388258201728, 
                    -0.03555518397509949, 
                    -0.08207167295182449, 
                    0.033189061782070095, 
                    -0.014612232998958252, 
                    0.2532863529620698, 
                    -0.22000422111480683, 
                    0.12625437978117277, 
                    0.2053308274143233, 
                    0.2681488170142776, 
                    -0.10317942891245169, 
                    0.11190008261389517, 
                    -0.0186477035467863, 
                    -0.04508562732641308, 
                    -0.019765414050399166, 
                    0.08206663780663337, 
                    0.07797473609292199, 
                    -0.2382891982858146, 
                    -0.24921829892269531, 
                    -0.07480715104329483, 
                    -0.19586028554712887, 
                    -0.31486615806481444, 
                    -0.273135825790072, 
                    -0.054482622650374124, 
                    0.23888018993463878, 
                    0.2066515567553766, 
                    0.2503804449873682, 
                    0.09627755335472804, 
                    0.09485054581582775, 
                    -0.09304767755964333, 
                    -0.24587451447172737, 
                    0.002712660527399824, 
                    0.24759630457591353, 
                    0.07069821602552812, 
                    -0.055449410657694764, 
                    -0.22404851599267772, 
                    0.10820440404988396, 
                    -0.19268066092649747, 
                    -0.19206150004059136, 
                    -0.10634004989123519, 
                    -0.05803236675513718, 
                    -0.07270653762482199, 
                    0.22394524317881492, 
                    0.1988291422282149, 
                    -0.07195882816381882, 
                    0.2538985465739081, 
                    0.1599215112624296, 
                    -0.22097789281323407, 
                    0.1591473106535064, 
                    -0.11057506253477273, 
                    0.09538118125058015, 
                    0.2594790704816825, 
                    0.12491189819059029, 
                    0.126092037733105, 
                    0.10523431263357369, 
                    -0.1412864946693602, 
                    -0.1690567024550553, 
                    9.97752562612364e-4, 
                    -0.3279338150011599, 
                    0.07495164797637743, 
                    -0.05629042201493056, 
                    0.20045892789339903, 
                    5.253640240395208e-4, 
                    0.07864639075563007, 
                    0.09380271621855346, 
                    -0.23085966203864278, 
                    0.20296204371206283, 
                    0.13387069962085346, 
                    -0.1743080565716463, 
                    0.18554915224670732, 
                    -0.14363752537508187, 
                    -0.2341120585044951, 
                    -0.02913575151465403, 
                    0.06394695864646882, 
                    0.1900694931740292, 
                    0.21573290452757976, 
                    0.006146137619651104, 
                    -0.0029110635354348546, 
                    -0.1337228411321025, 
                    -0.23965497779571232, 
                    0.10013226404064945, 
                    0.04363272697880388, 
                    0.26516354877543324, 
                    -0.2751667649501808, 
                    -0.020501826163309922, 
                    0.21406007032595564, 
                    -0.08686619465536027, 
                    -0.18626822981952387, 
                    0.1026270555884442, 
                    0.24054031842304657, 
                    -4.939424743128917e-4, 
                    0.024816148859719667, 
                    0.11798953315798938, 
                    -0.19430823657257207, 
                    0.14696634233422512, 
                    -0.1923439769389945, 
                    0.07560075430628765, 
                    0.029036392773900244, 
                    0.055388900742437186, 
                    -0.21395209206662064, 
                    -0.031812864884556535, 
                    -0.061407821993764766, 
                    0.20843110931112208, 
                    0.15827825284331276, 
                    -0.17749729039768858, 
                    -0.09152880550284015, 
                    -0.156067027654944, 
                    -0.321139903086754, 
                    -0.03229582844596668, 
                    0.12624840996242154, 
                    -0.30961258370116396, 
                    0.23965991170565093, 
                    0.22915365309079472, 
                    -0.16337623078510122, 
                    0.07110574455612145, 
                    -0.03425750680176226, 
                    0.1525241245657446, 
                    0.1725792851652781, 
                    0.20046247178048104, 
                    0.07477405168402129, 
                    -0.07802470591316879, 
                    -0.310355163197463, 
                    -0.050093580696131956, 
                    0.1210215333539621, 
                    0.20630219657417093, 
                    0.05770472657617215, 
                    0.17129862693491205, 
                    0.08202759476491067, 
                    -0.1978311136067435, 
                    -0.006600016094918504, 
                    0.024316841502517006, 
                    0.12459865512240348, 
                    0.005233947404167438, 
                    0.06555211441604225, 
                    -0.08409864737384815, 
                    0.1980757159287161, 
                    -0.275807657606977, 
                    0.2057102975991172, 
                    -0.25597681368882363, 
                    0.14161633675489482, 
                    -0.2418501549589336, 
                    -0.06795213061941163, 
                    0.005758779875918385, 
                    0.1712372050364267, 
                    -0.05801586733518149, 
                    -0.21408010349939469, 
                    -0.08574972729619035, 
                    -0.26249631850231253, 
                    -0.1365053574270265, 
                    0.20782020087134379, 
                    -0.29553848944437505, 
                    0.14438031604267432, 
                    0.11811921336965886, 
                    0.18932960584444625, 
                    0.08461788859174663, 
                    0.25108518482175335, 
                    -0.2282883034084161, 
                    0.2532863529620698, 
                    -0.28400379461137487, 
                    -0.2540896430072197, 
                    -0.004278215119536299, 
                    0.12317472247505268, 
                    0.22154379101966937, 
                    -0.054366888144267544, 
                    0.04487837596304517, 
                    0.07159039763112701, 
                    -0.2306622618064434, 
                    -0.2766069354317876, 
                    0.16846700489561472, 
                    -0.08564386133403779, 
                    -0.028351342389646983, 
                    -0.05412338647728604, 
                    -0.08569483497943264, 
                    0.12115669190762246, 
                    0.1853879701462151, 
                    0.10655552463663154, 
                    -0.010627140064716711, 
                    -0.2318562764112207, 
                    -0.029841150188332943, 
                    0.19362415005547462, 
                    -0.009682794830431107, 
                    0.14747547260354704, 
                    0.04865818366004887, 
                    -0.12113546959748328, 
                    -0.02940888935383673, 
                    0.14035214782298122, 
                    -0.09748249801982758, 
                    0.15754070667604703, 
                    0.12028268099814593, 
                    0.23557791467856815, 
                    0.04988162420750358, 
                    0.09605900325163125, 
                    -0.10022268379183019, 
                    0.07379835205714136, 
                    0.03812704965229402, 
                    0.1746541475803658, 
                    0.06420933343509111, 
                    0.15878834525031604, 
                    -0.3419831833521096, 
                    0.009834958455790743, 
                    -0.2828569980030091, 
                    0.04912217613958686, 
                    0.1997741110863488, 
                    -0.17274992745345427, 
                    0.06082197112026655, 
                    0.1402732787858701, 
                    0.15713096407860683, 
                    0.2106195936901505, 
                    -0.06884264201362211, 
                    0.051648153532356356, 
                    -0.23909400227243605, 
                    0.1385741206371694, 
                    0.19367635024902397, 
                    -0.16937384070008843, 
                    0.12226591992195684, 
                    -0.1138157154535854, 
                    0.1623279392773861, 
                    0.10380062092545023, 
                    0.12284267776474012, 
                    -0.07787710032418277, 
                    0.11338772436979605, 
                    -0.09546893277589172, 
                    -0.2682967656789166, 
                    -0.059446509197626174, 
                    0.10161897813617027, 
                    -0.17497554870797852, 
                    0.040523513475448025, 
                    -0.1911370097349358, 
                    0.12954226213553832, 
                    0.16221767660475128, 
                    -0.04819717905514842, 
                    -0.05534717310743009, 
                    -0.23152807372512635, 
                    -0.26229039875471294, 
                    -0.1466016921461035, 
                    0.19984583786384436, 
                    -0.22380988238609667, 
                    0.1921053830784304, 
                    0.20584011470451136, 
                    -0.12713242085844434, 
                    -0.2855249998008548, 
                    0.03092301375491696, 
                    -0.20563735802059477, 
                    -0.1462346364328775, 
                    -0.05325329083263597, 
                    -0.1823499677511833, 
                    0.2681488170142776, 
                    0.2278325682543193, 
                    0.0655626749822954, 
                    0.23445146986537857, 
                    0.20971416583705127, 
                    -0.13366701717749707, 
                    -0.24268472930813573, 
                    -0.012091724683455596, 
                    -0.10884230670151629, 
                    -0.18616766481213726, 
                    -0.27487537080510266, 
                    0.18189303726543937, 
                    0.07786479480394487, 
                    -0.02459012997794424, 
                    -0.06740602683057223, 
                    -0.2943966814089546, 
                    0.14368169129916236, 
                    -0.21757049425340624, 
                    -0.008462481218127926, 
                    -0.061767241107529625, 
                    0.04012965711027944, 
                    -0.05270229220363065, 
                    -0.20470853404879505, 
                    -0.02255552756878554, 
                    -0.12443953421033335, 
                    0.14956271444013192, 
                    0.19574879570712234, 
                    -0.19857703623499845, 
                    0.08634621712954188, 
                    0.16275211373492893, 
                    0.1423880314205196, 
                    -0.03452376713524152, 
                    -0.014871100639804347, 
                    0.196659645582268, 
                    -0.26977156923264456, 
                    -0.20385325706059867, 
                    -0.23663568883246655, 
                    -0.2476097070730723, 
                    0.21433437458997917, 
                    -0.1451569987064312, 
                    0.0074977624502309825, 
                    0.14352154369434295, 
                    -0.24910136031714405, 
                    0.2541217843801372, 
                    0.24755397938254853, 
                    0.13846914056297588, 
                    0.15101876295057848, 
                    -0.14160779551645014, 
                    -3.8237160558768357e-4, 
                    -0.08470961194187782, 
                    0.17273022272097505, 
                    0.06878316774745741, 
                    0.16825906306154814, 
                    0.09349782874299395, 
                    -0.21413003205405223, 
                    0.25522469626174005, 
                    0.24755397938254853, 
                    0.07035957009778082, 
                    -0.019658872534822958, 
                    -0.26325151820805553, 
                    -0.0735936348068158, 
                    -0.22243586392587789, 
                    -0.03145141723718453, 
                    0.21165436414172145, 
                    0.16337128723109373, 
                    -0.2249702378806571, 
                    0.21112267848810162, 
                    0.03510523436506707, 
                    0.20642770152901635, 
                    0.08656784035513349, 
                    0.18928418425951166, 
                    -0.15914675602998957, 
                    0.18484317797487904, 
                    -0.1077697923558279, 
                    -0.22110411502079608, 
                    0.05179728719042731, 
                    0.09193160492337649, 
                    0.03521062219648946, 
                    0.14432291853720458, 
                    -0.015362098622380305, 
                    0.24755397938254853, 
                    -0.17678265051164796, 
                    0.22889901576716976, 
                    -0.1651217264809936, 
                    0.04630902875461629, 
                    0.16427235434700305, 
                    -0.043611402942953625, 
                    0.10378387722587651, 
                    0.061234087453162556, 
                    0.1143144580227543, 
                    0.14177141681981548, 
                    -0.09294547825413696, 
                    0.19798022468586152, 
                    0.2562095335898762, 
                    -0.002070271898173437, 
                    0.05456955009988523, 
                    0.09446562218623772, 
                    -0.1917122535179876, 
                    0.25073667564672675, 
                    0.18644334445464572, 
                    -0.17380454018184427, 
                    0.1339293493555614, 
                    0.19503631785483733, 
                    -0.20458154432514117, 
                    0.2256260482390856, 
                    -0.33746147296109835, 
                    0.0764570745637062, 
                    0.08675745434459226, 
                    0.037941443370720085, 
                    0.2034101694668603, 
                    0.02584796165019887, 
                    0.037141908403914514, 
                    0.20971416583705127, 
                    -0.019011193264649895, 
                    -0.02314623791605408, 
                    0.20428577558509087, 
                    0.1633263083956391, 
                    0.16238302393494597, 
                    0.05442937251201252, 
                    0.16087880340460103, 
                    -0.2643467651279564, 
                    0.24251534701293231, 
                    0.12507814168348913, 
                    -0.27117409278007676, 
                    0.2005312638895358, 
                    0.16469672342477515, 
                    -0.16721502191940535, 
                    0.14727764638335328, 
                    -0.20084572974191842, 
                    0.04553986421279471, 
                    -0.23552841889856507, 
                    0.160295222353125, 
                    0.07794450308559314, 
                    0.0662899603486779, 
                    -0.2801604835249418, 
                    0.08682807328663139, 
                    -0.06827867087585088, 
                    -0.08046954700448988, 
                    0.07667438954972916, 
                    -0.0921362661680222, 
                    -0.2226033155091512, 
                    0.09820065809748019, 
                    -0.0272747442176709, 
                    0.10930541534018728, 
                    0.1182009098371194, 
                    -0.19291383896188716, 
                    -0.12559201028632921, 
                    -0.16074664672133632, 
                    0.1912840500564833, 
                    -0.10798081525325154, 
                    0.2248033087327368, 
                    -0.228744643278447 
)
)

